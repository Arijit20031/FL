nohup: ignoring input
Using device: cuda
Starting DAD federated client 0
Using device: cuda
Server: Using unweighted CrossEntropyLoss
INFO flwr 2025-11-07 11:37:52,814 | app.py:163 | Starting Flower server, config: ServerConfig(num_rounds=6, round_timeout=None)
INFO flwr 2025-11-07 11:37:52,826 | app.py:176 | Flower ECE: gRPC server running (6 rounds), SSL is disabled
INFO flwr 2025-11-07 11:37:52,826 | server.py:89 | Initializing global parameters
INFO flwr 2025-11-07 11:37:52,826 | server.py:276 | Requesting initial parameters from one random client
Client 0: Using unweighted CrossEntropyLoss
Client 0: total=256, train=217, val=39
INFO flwr 2025-11-07 11:37:53,179 | grpc.py:52 | Opened insecure gRPC connection (no certificates were passed)
DEBUG flwr 2025-11-07 11:37:53,180 | connection.py:55 | ChannelConnectivity.IDLE
DEBUG flwr 2025-11-07 11:37:53,180 | connection.py:55 | ChannelConnectivity.CONNECTING
DEBUG flwr 2025-11-07 11:37:53,181 | connection.py:55 | ChannelConnectivity.READY
INFO flwr 2025-11-07 11:37:53,246 | server.py:280 | Received initial parameters from one random client
INFO flwr 2025-11-07 11:37:53,246 | server.py:91 | Evaluating initial parameters
Using device: cuda
Starting DAD federated client 1
Client 1: Using unweighted CrossEntropyLoss
Client 1: total=256, train=217, val=39
INFO flwr 2025-11-07 11:37:55,334 | grpc.py:52 | Opened insecure gRPC connection (no certificates were passed)
DEBUG flwr 2025-11-07 11:37:55,335 | connection.py:55 | ChannelConnectivity.IDLE
DEBUG flwr 2025-11-07 11:37:55,336 | connection.py:55 | ChannelConnectivity.READY
Using device: cuda
Starting DAD federated client 2
Client 2: Using unweighted CrossEntropyLoss
Client 2: total=255, train=216, val=39
INFO flwr 2025-11-07 11:37:57,619 | grpc.py:52 | Opened insecure gRPC connection (no certificates were passed)
DEBUG flwr 2025-11-07 11:37:57,620 | connection.py:55 | ChannelConnectivity.IDLE
DEBUG flwr 2025-11-07 11:37:57,620 | connection.py:55 | ChannelConnectivity.CONNECTING
DEBUG flwr 2025-11-07 11:37:57,620 | connection.py:55 | ChannelConnectivity.READY
Using device: cuda
Starting DAD federated client 3
Client 3: Using unweighted CrossEntropyLoss
Client 3: total=255, train=216, val=39
INFO flwr 2025-11-07 11:37:59,625 | grpc.py:52 | Opened insecure gRPC connection (no certificates were passed)
DEBUG flwr 2025-11-07 11:37:59,626 | connection.py:55 | ChannelConnectivity.IDLE
DEBUG flwr 2025-11-07 11:37:59,626 | connection.py:55 | ChannelConnectivity.CONNECTING
DEBUG flwr 2025-11-07 11:37:59,626 | connection.py:55 | ChannelConnectivity.READY
Using device: cuda
Starting DAD federated client 4
Client 4: Using unweighted CrossEntropyLoss
Client 4: total=255, train=216, val=39
INFO flwr 2025-11-07 11:38:01,489 | grpc.py:52 | Opened insecure gRPC connection (no certificates were passed)
DEBUG flwr 2025-11-07 11:38:01,489 | connection.py:55 | ChannelConnectivity.IDLE
DEBUG flwr 2025-11-07 11:38:01,490 | connection.py:55 | ChannelConnectivity.CONNECTING
DEBUG flwr 2025-11-07 11:38:01,493 | connection.py:55 | ChannelConnectivity.READY
Starting federated server with 6 rounds, 5 clients
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.4240, 0.5780]
Batch 0: pred_labels unique=[0 1], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.4643, 0.6116]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.3574, 0.5749]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.3407, mean Time to accident= 4.4819
Recall@80%, Time to accident= 4.031

=== SERVER EVALUATION ROUND 0 ===
Confusion Matrix:
[[14935 15165]
 [ 8021  7879]]
Class-wise recall: [0.496 0.496]
==================================================
INFO flwr 2025-11-07 11:38:50,147 | server.py:94 | initial parameters (loss, other metrics): 0.0, {'ap': 0.34070511181183394, 'mtta': 4.481862786776933, 'tta_r80': 4.031007751937984, 'recall_neg': 0.4961794019933555, 'recall_pos': 0.49553459119496857, 'pr_auc_frame': 0.3408432836152453}
INFO flwr 2025-11-07 11:38:50,147 | server.py:104 | FL starting
DEBUG flwr 2025-11-07 11:38:50,147 | server.py:222 | fit_round 1: strategy sampled 5 clients (out of 5)
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 4: Starting epoch 1/7
Client 1: Reset optimizer and scheduler state after loading server parameters
Client 1: Starting epoch 1/7
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 2: Starting epoch 1/7
Client 3: Starting epoch 1/7
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 0: Starting epoch 1/7
Client 4: Processing batch 0
Client 1: Processing batch 0
Client 0: Processing batch 0
Client 2: Processing batch 0
Client 3: Processing batch 0
Client 1: Processing batch 10
Client 4: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 20
Client 4: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 30
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 4: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 80
Client 2: Processing batch 80
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Average Precision= 0.1032, mean Time to accident= 3.6181
Recall@80%, Time to accident= 2.833
Client 4: Epoch 1 validation AP = 0.1032
Client 4: New best AP = 0.1032, saving checkpoint
Client 4: Starting epoch 2/7
Client 4: Processing batch 0
Average Precision= 0.1334, mean Time to accident= 3.6065
Recall@80%, Time to accident= 3.546
Client 2: Epoch 1 validation AP = 0.1334
Client 2: New best AP = 0.1334, saving checkpoint
Client 2: Starting epoch 2/7
Client 2: Processing batch 0
Average Precision= 0.7841, mean Time to accident= 4.3069
Recall@80%, Time to accident= 3.656
Client 0: Epoch 1 validation AP = 0.7841
Client 0: New best AP = 0.7841, saving checkpoint
Client 0: Starting epoch 2/7
Average Precision= 0.6487, mean Time to accident= 4.2432
Recall@80%, Time to accident= 3.772
Client 1: Epoch 1 validation AP = 0.6487
Client 1: New best AP = 0.6487, saving checkpoint
Client 1: Starting epoch 2/7
Average Precision= 0.0739, mean Time to accident= 3.7685
Recall@80%, Time to accident= 3.694
Client 3: Epoch 1 validation AP = 0.0739
Client 3: New best AP = 0.0739, saving checkpoint
Client 3: Starting epoch 2/7
Client 0: Processing batch 0
Client 1: Processing batch 0
Client 3: Processing batch 0
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 10
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 80
Client 2: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.1656, mean Time to accident= 3.4618
Recall@80%, Time to accident= 3.833
Client 4: Epoch 2 validation AP = 0.1656
Client 4: New best AP = 0.1656, saving checkpoint
Client 4: Starting epoch 3/7
Client 4: Processing batch 0
Average Precision= 0.1858, mean Time to accident= 3.7057
Recall@80%, Time to accident= 3.88
Client 2: Epoch 2 validation AP = 0.1858
Client 2: New best AP = 0.1858, saving checkpoint
Client 2: Starting epoch 3/7
Average Precision= 0.2146, mean Time to accident= 3.7130
Recall@80%, Time to accident= 2.806
Client 3: Epoch 2 validation AP = 0.2146
Client 3: New best AP = 0.2146, saving checkpoint
Client 3: Starting epoch 3/7
Client 2: Processing batch 0
Average Precision= 0.6431, mean Time to accident= 4.4063
Recall@80%, Time to accident= 4.183
Client 1: Epoch 2 validation AP = 0.6431
Client 1: Starting epoch 3/7
Client 3: Processing batch 0
Client 1: Processing batch 0
Average Precision= 0.8968, mean Time to accident= 4.4989
Recall@80%, Time to accident= 4.177
Client 0: Epoch 2 validation AP = 0.8968
Client 0: New best AP = 0.8968, saving checkpoint
Client 0: Starting epoch 3/7
Client 0: Processing batch 0
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.5052, mean Time to accident= 3.0961
Recall@80%, Time to accident= 3.704
Client 4: Epoch 3 validation AP = 0.5052
Client 4: New best AP = 0.5052, saving checkpoint
Client 4: Starting epoch 4/7
Client 4: Processing batch 0
Average Precision= 0.1474, mean Time to accident= 3.7160
Recall@80%, Time to accident= 3.556
Client 3: Epoch 3 validation AP = 0.1474
Client 3: Starting epoch 4/7
Average Precision= 0.2124, mean Time to accident= 3.3847
Recall@80%, Time to accident= 3.148
Client 2: Epoch 3 validation AP = 0.2124
Client 2: New best AP = 0.2124, saving checkpoint
Client 2: Starting epoch 4/7
Client 2: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.7150, mean Time to accident= 4.5668
Recall@80%, Time to accident= 4.175
Client 1: Epoch 3 validation AP = 0.7150
Client 1: New best AP = 0.7150, saving checkpoint
Client 1: Starting epoch 4/7
Average Precision= 0.8657, mean Time to accident= 4.1362
Recall@80%, Time to accident= 3.891
Client 0: Epoch 3 validation AP = 0.8657
Client 0: Starting epoch 4/7
Client 1: Processing batch 0
Client 0: Processing batch 0
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.1283, mean Time to accident= 3.2002
Recall@80%, Time to accident= 3.648
Client 4: Epoch 4 validation AP = 0.1283
Client 4: Starting epoch 5/7
Average Precision= 0.2628, mean Time to accident= 4.6296
Recall@80%, Time to accident= 3.889
Client 3: Epoch 4 validation AP = 0.2628
Client 3: New best AP = 0.2628, saving checkpoint
Client 3: Starting epoch 5/7
Client 4: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.1718, mean Time to accident= 4.0291
Recall@80%, Time to accident= 3.593
Client 2: Epoch 4 validation AP = 0.1718
Client 2: Starting epoch 5/7
Client 2: Processing batch 0
Average Precision= 0.7919, mean Time to accident= 4.0414
Recall@80%, Time to accident= 3.774
Client 0: Epoch 4 validation AP = 0.7919
Client 0: Starting epoch 5/7
Average Precision= 0.6873, mean Time to accident= 4.7173
Recall@80%, Time to accident= 4.525
Client 1: Epoch 4 validation AP = 0.6873
Client 1: Starting epoch 5/7
Client 0: Processing batch 0
Client 1: Processing batch 0
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.1854, mean Time to accident= 4.7500
Recall@80%, Time to accident= 4.25
Client 3: Epoch 5 validation AP = 0.1854
Client 3: Starting epoch 6/7
Average Precision= 0.1656, mean Time to accident= 3.0023
Recall@80%, Time to accident= 3.426
Client 4: Epoch 5 validation AP = 0.1656
Client 4: Starting epoch 6/7
Client 3: Processing batch 0
Client 4: Processing batch 0
Average Precision= 0.1613, mean Time to accident= 4.4495
Recall@80%, Time to accident= 4.435
Client 2: Epoch 5 validation AP = 0.1613
Client 2: Starting epoch 6/7
Client 2: Processing batch 0
Average Precision= 0.7483, mean Time to accident= 4.5390
Recall@80%, Time to accident= 4.237
Client 0: Epoch 5 validation AP = 0.7483
Client 0: Starting epoch 6/7
Client 0: Processing batch 0
Average Precision= 0.6851, mean Time to accident= 4.5061
Recall@80%, Time to accident= 4.328
Client 1: Epoch 5 validation AP = 0.6851
Client 1: Starting epoch 6/7
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 40
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 50
Client 1: Processing batch 40
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 60
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 70
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 80
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 90
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 100
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 110
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 120
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 130
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 140
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 150
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 160
Client 0: Processing batch 150
Client 4: Processing batch 160
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 3: Processing batch 170
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 180
Client 0: Processing batch 170
Client 4: Processing batch 180
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 200
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 210
Client 1: Processing batch 200
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.3646, mean Time to accident= 3.0000
Recall@80%, Time to accident= 3.944
Client 3: Epoch 6 validation AP = 0.3646
Client 3: New best AP = 0.3646, saving checkpoint
Client 3: Starting epoch 7/7
Client 3: Processing batch 0
Average Precision= 0.5092, mean Time to accident= 3.4225
Recall@80%, Time to accident= 3.259
Client 4: Epoch 6 validation AP = 0.5092
Client 4: New best AP = 0.5092, saving checkpoint
Client 4: Starting epoch 7/7
Client 4: Processing batch 0
Average Precision= 0.1555, mean Time to accident= 3.8729
Recall@80%, Time to accident= 4.378
Client 2: Epoch 6 validation AP = 0.1555
Client 2: Starting epoch 7/7
Client 2: Processing batch 0
Average Precision= 0.7965, mean Time to accident= 4.1102
Recall@80%, Time to accident= 4.246
Client 0: Epoch 6 validation AP = 0.7965
Client 0: Starting epoch 7/7
Client 3: Processing batch 10
Client 0: Processing batch 0
Average Precision= 0.6770, mean Time to accident= 4.4166
Recall@80%, Time to accident= 4.153
Client 1: Epoch 6 validation AP = 0.6770
Client 1: Starting epoch 7/7
Client 4: Processing batch 10
Client 1: Processing batch 0
Client 2: Processing batch 10
Client 3: Processing batch 20
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 30
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 40
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 50
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 60
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 70
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 80
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 90
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 100
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 110
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 120
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 130
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 140
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 150
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 160
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 170
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 180
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 190
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 200
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 210
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.2906, mean Time to accident= 4.3241
Recall@80%, Time to accident= 3.417
Client 3: Epoch 7 validation AP = 0.2906
Client 3: Loaded best model checkpoint with AP = 0.3646
Average Precision= 0.3725, mean Time to accident= 3.8032
Recall@80%, Time to accident= 4.185
Client 4: Epoch 7 validation AP = 0.3725
Client 4: Loaded best model checkpoint with AP = 0.5092
Average Precision= 0.1625, mean Time to accident= 3.7785
Recall@80%, Time to accident= 3.741
Client 2: Epoch 7 validation AP = 0.1625
Client 2: Loaded best model checkpoint with AP = 0.2124
Average Precision= 0.7691, mean Time to accident= 4.5233
Recall@80%, Time to accident= 4.456
Client 1: Epoch 7 validation AP = 0.7691
Client 1: New best AP = 0.7691, saving checkpoint
Client 1: Loaded best model checkpoint with AP = 0.7691
Average Precision= 0.8151, mean Time to accident= 4.1915
Recall@80%, Time to accident= 4.004
Client 0: Epoch 7 validation AP = 0.8151
Client 0: Loaded best model checkpoint with AP = 0.8968
DEBUG flwr 2025-11-07 16:34:23,876 | server.py:236 | fit_round 1 received 5 results and 0 failures
WARNING flwr 2025-11-07 16:34:23,905 | fedavg.py:250 | No fit_metrics_aggregation_fn provided
Saved PR curve: results/federated/pr_curve_round_0.png
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0716, 0.3507]
Batch 0: pred_labels unique=[0], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0953, 0.4115]
Batch 1: pred_labels unique=[0], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.0408, 0.3081]
Batch 2: pred_labels unique=[0], y unique=[1]
Average Precision= 0.4095, mean Time to accident= 3.6806
Recall@80%, Time to accident= 3.802

=== SERVER EVALUATION ROUND 1 ===
Confusion Matrix:
[[30094     6]
 [15870    30]]
Class-wise recall: [1.    0.002]
==================================================
INFO flwr 2025-11-07 16:35:18,504 | server.py:125 | fit progress: (1, 0.0, {'ap': 0.4095341940503391, 'mtta': 3.6805823248428604, 'tta_r80': 3.802274715660542, 'recall_neg': 0.9998006644518272, 'recall_pos': 0.0018867924528301887, 'pr_auc_frame': 0.38438466846845326}, 17788.357450602)
DEBUG flwr 2025-11-07 16:35:18,505 | server.py:173 | evaluate_round 1: strategy sampled 5 clients (out of 5)
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 1: Reset optimizer and scheduler state after loading server parameters
DEBUG flwr 2025-11-07 16:41:45,860 | server.py:187 | evaluate_round 1 received 5 results and 0 failures
WARNING flwr 2025-11-07 16:41:45,860 | fedavg.py:281 | No evaluate_metrics_aggregation_fn provided
DEBUG flwr 2025-11-07 16:41:45,860 | server.py:222 | fit_round 2: strategy sampled 5 clients (out of 5)
Average Precision= 0.2872, mean Time to accident= 4.8403
Recall@80%, Time to accident= 4.667
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 4: Starting epoch 1/7
Average Precision= 0.8645, mean Time to accident= 3.8744
Recall@80%, Time to accident= 4.323
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 0: Starting epoch 1/7
Average Precision= 0.5543, mean Time to accident= 4.6090
Recall@80%, Time to accident= 4.204
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 2: Starting epoch 1/7
Average Precision= 0.1914, mean Time to accident= 3.4444
Recall@80%, Time to accident= 3.056
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 3: Starting epoch 1/7
Average Precision= 0.8783, mean Time to accident= 4.1950
Recall@80%, Time to accident= 3.958
Client 1: Reset optimizer and scheduler state after loading server parameters
Client 1: Starting epoch 1/7
Client 4: Processing batch 0
Client 3: Processing batch 0
Client 0: Processing batch 0
Client 2: Processing batch 0
Client 1: Processing batch 0
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 160
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 180
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Average Precision= 0.1773, mean Time to accident= 3.9178
Recall@80%, Time to accident= 4.185
Client 4: Epoch 1 validation AP = 0.1773
Client 4: New best AP = 0.1773, saving checkpoint
Client 4: Starting epoch 2/7
Average Precision= 0.4293, mean Time to accident= 3.6029
Recall@80%, Time to accident= 3.565
Client 2: Epoch 1 validation AP = 0.4293
Client 2: New best AP = 0.4293, saving checkpoint
Client 2: Starting epoch 2/7
Average Precision= 0.7452, mean Time to accident= 4.6343
Recall@80%, Time to accident= 4.258
Client 1: Epoch 1 validation AP = 0.7452
Client 1: New best AP = 0.7452, saving checkpoint
Client 1: Starting epoch 2/7
Client 4: Processing batch 0
Client 2: Processing batch 0
Client 1: Processing batch 0
Average Precision= 0.8313, mean Time to accident= 4.7463
Recall@80%, Time to accident= 4.641
Client 0: Epoch 1 validation AP = 0.8313
Client 0: New best AP = 0.8313, saving checkpoint
Client 0: Starting epoch 2/7
Average Precision= 0.1684, mean Time to accident= 3.4722
Recall@80%, Time to accident= 2.306
Client 3: Epoch 1 validation AP = 0.1684
Client 3: New best AP = 0.1684, saving checkpoint
Client 3: Starting epoch 2/7
Client 0: Processing batch 0
Client 3: Processing batch 0
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.2289, mean Time to accident= 3.9630
Recall@80%, Time to accident= 4.231
Client 2: Epoch 2 validation AP = 0.2289
Client 2: Starting epoch 3/7
Average Precision= 0.7880, mean Time to accident= 4.0689
Recall@80%, Time to accident= 3.983
Client 1: Epoch 2 validation AP = 0.7880
Client 1: New best AP = 0.7880, saving checkpoint
Client 1: Starting epoch 3/7
Average Precision= 0.4636, mean Time to accident= 4.1481
Recall@80%, Time to accident= 4.259
Client 4: Epoch 2 validation AP = 0.4636
Client 4: New best AP = 0.4636, saving checkpoint
Client 4: Starting epoch 3/7
Client 2: Processing batch 0
Client 1: Processing batch 0
Client 4: Processing batch 0
Average Precision= 0.1100, mean Time to accident= 3.9259
Recall@80%, Time to accident= 3.722
Client 3: Epoch 2 validation AP = 0.1100
Client 3: Starting epoch 3/7
Client 3: Processing batch 0
Average Precision= 0.8629, mean Time to accident= 4.5433
Recall@80%, Time to accident= 4.255
Client 0: Epoch 2 validation AP = 0.8629
Client 0: New best AP = 0.8629, saving checkpoint
Client 0: Starting epoch 3/7
Client 0: Processing batch 0
Client 2: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.2017, mean Time to accident= 4.1799
Recall@80%, Time to accident= 4.361
Client 2: Epoch 3 validation AP = 0.2017
Client 2: Starting epoch 4/7
Client 2: Processing batch 0
Average Precision= 0.1989, mean Time to accident= 3.9271
Recall@80%, Time to accident= 5.0
Client 4: Epoch 3 validation AP = 0.1989
Client 4: Starting epoch 4/7
Client 4: Processing batch 0
Average Precision= 0.7528, mean Time to accident= 4.5184
Recall@80%, Time to accident= 4.436
Client 1: Epoch 3 validation AP = 0.7528
Client 1: Starting epoch 4/7
Client 1: Processing batch 0
Average Precision= 0.2239, mean Time to accident= 3.4414
Recall@80%, Time to accident= 2.583
Client 3: Epoch 3 validation AP = 0.2239
Client 3: New best AP = 0.2239, saving checkpoint
Client 3: Starting epoch 4/7
Client 3: Processing batch 0
Average Precision= 0.8414, mean Time to accident= 4.3030
Recall@80%, Time to accident= 3.949
Client 0: Epoch 3 validation AP = 0.8414
Client 0: Starting epoch 4/7
Client 0: Processing batch 0
Client 2: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 30
Client 4: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 40
Client 4: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 120
Client 4: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 150
Client 4: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.2865, mean Time to accident= 4.4865
Recall@80%, Time to accident= 4.019
Client 2: Epoch 4 validation AP = 0.2865
Client 2: Starting epoch 5/7
Client 2: Processing batch 0
Average Precision= 0.1604, mean Time to accident= 3.5648
Recall@80%, Time to accident= 2.472
Client 3: Epoch 4 validation AP = 0.1604
Client 3: Starting epoch 5/7
Average Precision= 0.5459, mean Time to accident= 3.5706
Recall@80%, Time to accident= 4.907
Client 4: Epoch 4 validation AP = 0.5459
Client 4: New best AP = 0.5459, saving checkpoint
Client 4: Starting epoch 5/7
Client 3: Processing batch 0
Average Precision= 0.7622, mean Time to accident= 4.4722
Recall@80%, Time to accident= 4.392
Client 1: Epoch 4 validation AP = 0.7622
Client 1: Starting epoch 5/7
Client 4: Processing batch 0
Client 1: Processing batch 0
Average Precision= 0.7995, mean Time to accident= 4.3034
Recall@80%, Time to accident= 4.22
Client 0: Epoch 4 validation AP = 0.7995
Client 0: Starting epoch 5/7
Client 0: Processing batch 0
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 150
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.2035, mean Time to accident= 4.0422
Recall@80%, Time to accident= 4.287
Client 2: Epoch 5 validation AP = 0.2035
Client 2: Starting epoch 6/7
Client 2: Processing batch 0
Average Precision= 0.1059, mean Time to accident= 3.9846
Recall@80%, Time to accident= 4.028
Client 3: Epoch 5 validation AP = 0.1059
Client 3: Starting epoch 6/7
Client 3: Processing batch 0
Average Precision= 0.3840, mean Time to accident= 3.8519
Recall@80%, Time to accident= 4.963
Client 4: Epoch 5 validation AP = 0.3840
Client 4: Starting epoch 6/7
Average Precision= 0.8049, mean Time to accident= 4.1565
Recall@80%, Time to accident= 4.1
Client 1: Epoch 5 validation AP = 0.8049
Client 1: New best AP = 0.8049, saving checkpoint
Client 1: Starting epoch 6/7
Client 4: Processing batch 0
Client 1: Processing batch 0
Average Precision= 0.8232, mean Time to accident= 4.7081
Recall@80%, Time to accident= 4.514
Client 0: Epoch 5 validation AP = 0.8232
Client 0: Starting epoch 6/7
Client 0: Processing batch 0
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.5438, mean Time to accident= 4.8774
Recall@80%, Time to accident= 4.796
Client 2: Epoch 6 validation AP = 0.5438
Client 2: New best AP = 0.5438, saving checkpoint
Client 2: Starting epoch 7/7
Client 2: Processing batch 0
Average Precision= 0.2165, mean Time to accident= 3.0093
Recall@80%, Time to accident= 2.528
Client 3: Epoch 6 validation AP = 0.2165
Client 3: Starting epoch 7/7
Client 3: Processing batch 0
Average Precision= 0.4958, mean Time to accident= 3.6134
Recall@80%, Time to accident= 4.981
Client 4: Epoch 6 validation AP = 0.4958
Client 4: Starting epoch 7/7
Average Precision= 0.7141, mean Time to accident= 4.2199
Recall@80%, Time to accident= 4.403
Client 1: Epoch 6 validation AP = 0.7141
Client 1: Starting epoch 7/7
Client 4: Processing batch 0
Client 1: Processing batch 0
Average Precision= 0.8218, mean Time to accident= 4.6229
Recall@80%, Time to accident= 4.496
Client 0: Epoch 6 validation AP = 0.8218
Client 0: Starting epoch 7/7
Client 0: Processing batch 0
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.3103, mean Time to accident= 2.5334
Recall@80%, Time to accident= 2.639
Client 2: Epoch 7 validation AP = 0.3103
Client 2: Loaded best model checkpoint with AP = 0.5438
Average Precision= 0.2212, mean Time to accident= 2.6944
Recall@80%, Time to accident= 2.417
Client 3: Epoch 7 validation AP = 0.2212
Client 3: Loaded best model checkpoint with AP = 0.2239
Average Precision= 0.8007, mean Time to accident= 4.4237
Recall@80%, Time to accident= 4.536
Client 1: Epoch 7 validation AP = 0.8007
Client 1: Loaded best model checkpoint with AP = 0.8049
Average Precision= 0.2673, mean Time to accident= 3.6481
Recall@80%, Time to accident= 4.926
Client 4: Epoch 7 validation AP = 0.2673
Client 4: Loaded best model checkpoint with AP = 0.5459
Average Precision= 0.8455, mean Time to accident= 4.6108
Recall@80%, Time to accident= 4.474
Client 0: Epoch 7 validation AP = 0.8455
Client 0: Loaded best model checkpoint with AP = 0.8629
DEBUG flwr 2025-11-07 21:36:40,481 | server.py:236 | fit_round 2 received 5 results and 0 failures
Saved PR curve: results/federated/pr_curve_round_1.png
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0410, 0.3368]
Batch 0: pred_labels unique=[0], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0624, 0.7409]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.0207, 0.5253]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.3730, mean Time to accident= 3.8639
Recall@80%, Time to accident= 4.027

=== SERVER EVALUATION ROUND 2 ===
Confusion Matrix:
[[28891  1209]
 [15061   839]]
Class-wise recall: [0.96  0.053]
==================================================
INFO flwr 2025-11-07 21:37:34,857 | server.py:125 | fit progress: (2, 0.0, {'ap': 0.3729549742517724, 'mtta': 3.8639231844483524, 'tta_r80': 4.027121609798775, 'recall_neg': 0.9598338870431894, 'recall_pos': 0.052767295597484276, 'pr_auc_frame': 0.38849595583958546}, 35924.710263971)
DEBUG flwr 2025-11-07 21:37:34,857 | server.py:173 | evaluate_round 2: strategy sampled 5 clients (out of 5)
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 1: Reset optimizer and scheduler state after loading server parameters
DEBUG flwr 2025-11-07 21:43:58,018 | server.py:187 | evaluate_round 2 received 5 results and 0 failures
DEBUG flwr 2025-11-07 21:43:58,019 | server.py:222 | fit_round 3: strategy sampled 5 clients (out of 5)
Average Precision= 0.8696, mean Time to accident= 4.4400
Recall@80%, Time to accident= 4.242
Client 1: Reset optimizer and scheduler state after loading server parameters
Client 1: Starting epoch 1/7
Average Precision= 0.1621, mean Time to accident= 4.1678
Recall@80%, Time to accident= 4.574
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 4: Starting epoch 1/7
Average Precision= 0.3521, mean Time to accident= 3.7433
Recall@80%, Time to accident= 3.787
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 2: Starting epoch 1/7
Average Precision= 0.7882, mean Time to accident= 3.8725
Recall@80%, Time to accident= 3.829
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 0: Starting epoch 1/7
Average Precision= 0.2081, mean Time to accident= 4.4630
Recall@80%, Time to accident= 3.667
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 3: Starting epoch 1/7
Client 1: Processing batch 0
Client 3: Processing batch 0
Client 4: Processing batch 0
Client 0: Processing batch 0
Client 2: Processing batch 0
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 4: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Average Precision= 0.4969, mean Time to accident= 3.9433
Recall@80%, Time to accident= 4.259
Client 4: Epoch 1 validation AP = 0.4969
Client 4: New best AP = 0.4969, saving checkpoint
Client 4: Starting epoch 2/7
Average Precision= 0.2239, mean Time to accident= 3.5141
Recall@80%, Time to accident= 3.639
Client 2: Epoch 1 validation AP = 0.2239
Client 2: New best AP = 0.2239, saving checkpoint
Client 2: Starting epoch 2/7
Client 4: Processing batch 0
Average Precision= 0.8111, mean Time to accident= 4.2405
Recall@80%, Time to accident= 3.812
Client 0: Epoch 1 validation AP = 0.8111
Client 0: New best AP = 0.8111, saving checkpoint
Client 0: Starting epoch 2/7
Client 2: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.7382, mean Time to accident= 4.3869
Recall@80%, Time to accident= 4.206
Client 1: Epoch 1 validation AP = 0.7382
Client 1: New best AP = 0.7382, saving checkpoint
Client 1: Starting epoch 2/7
Average Precision= 0.3581, mean Time to accident= 3.2222
Recall@80%, Time to accident= 2.5
Client 3: Epoch 1 validation AP = 0.3581
Client 3: New best AP = 0.3581, saving checkpoint
Client 3: Starting epoch 2/7
Client 1: Processing batch 0
Client 3: Processing batch 0
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 20
Client 4: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 30
Client 4: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 40
Client 0: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 120
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 130
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 140
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 190
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 200
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 210
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.6066, mean Time to accident= 3.9306
Recall@80%, Time to accident= 5.0
Client 4: Epoch 2 validation AP = 0.6066
Client 4: New best AP = 0.6066, saving checkpoint
Client 4: Starting epoch 3/7
Client 4: Processing batch 0
Average Precision= 0.7845, mean Time to accident= 4.3493
Recall@80%, Time to accident= 3.961
Client 0: Epoch 2 validation AP = 0.7845
Client 0: Starting epoch 3/7
Client 0: Processing batch 0
Average Precision= 0.1720, mean Time to accident= 3.6387
Recall@80%, Time to accident= 4.148
Client 2: Epoch 2 validation AP = 0.1720
Client 2: Starting epoch 3/7
Average Precision= 0.1213, mean Time to accident= 3.3148
Recall@80%, Time to accident= 3.5
Client 3: Epoch 2 validation AP = 0.1213
Client 3: Starting epoch 3/7
Client 2: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.8589, mean Time to accident= 3.9640
Recall@80%, Time to accident= 3.853
Client 1: Epoch 2 validation AP = 0.8589
Client 1: New best AP = 0.8589, saving checkpoint
Client 1: Starting epoch 3/7
Client 1: Processing batch 0
Client 4: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 150
Client 1: Processing batch 140
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 4: Processing batch 160
Client 1: Processing batch 150
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 4: Processing batch 170
Client 1: Processing batch 160
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 4: Processing batch 180
Client 1: Processing batch 170
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 190
Client 1: Processing batch 180
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 200
Client 1: Processing batch 190
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 210
Client 1: Processing batch 200
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.3138, mean Time to accident= 3.8356
Recall@80%, Time to accident= 4.759
Client 4: Epoch 3 validation AP = 0.3138
Client 4: Starting epoch 4/7
Client 4: Processing batch 0
Average Precision= 0.1268, mean Time to accident= 2.0123
Recall@80%, Time to accident= 2.056
Client 3: Epoch 3 validation AP = 0.1268
Client 3: Starting epoch 4/7
Client 3: Processing batch 0
Average Precision= 0.8012, mean Time to accident= 4.6245
Recall@80%, Time to accident= 4.252
Client 0: Epoch 3 validation AP = 0.8012
Client 0: Starting epoch 4/7
Client 0: Processing batch 0
Average Precision= 0.1775, mean Time to accident= 4.6507
Recall@80%, Time to accident= 4.241
Client 2: Epoch 3 validation AP = 0.1775
Client 2: Starting epoch 4/7
Client 2: Processing batch 0
Client 4: Processing batch 10
Average Precision= 0.8184, mean Time to accident= 4.1444
Recall@80%, Time to accident= 4.083
Client 1: Epoch 3 validation AP = 0.8184
Client 1: Starting epoch 4/7
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 10
Client 4: Processing batch 20
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 20
Client 4: Processing batch 30
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 4: Processing batch 40
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 50
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 60
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 70
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 80
Client 1: Processing batch 70
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 90
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 100
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 110
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 120
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 4: Processing batch 130
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 140
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 150
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 160
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 170
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 180
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 190
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 200
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 210
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.3597, mean Time to accident= 3.9028
Recall@80%, Time to accident= 5.0
Client 4: Epoch 4 validation AP = 0.3597
Client 4: Starting epoch 5/7
Client 4: Processing batch 0
Average Precision= 0.2414, mean Time to accident= 3.9605
Recall@80%, Time to accident= 4.296
Client 2: Epoch 4 validation AP = 0.2414
Client 2: New best AP = 0.2414, saving checkpoint
Client 2: Starting epoch 5/7
Client 2: Processing batch 0
Average Precision= 0.1420, mean Time to accident= 3.1667
Recall@80%, Time to accident= 3.0
Client 3: Epoch 4 validation AP = 0.1420
Client 3: Starting epoch 5/7
Client 3: Processing batch 0
Average Precision= 0.8222, mean Time to accident= 4.5452
Recall@80%, Time to accident= 4.415
Client 0: Epoch 4 validation AP = 0.8222
Client 0: New best AP = 0.8222, saving checkpoint
Client 0: Starting epoch 5/7
Client 0: Processing batch 0
Client 4: Processing batch 10
Average Precision= 0.8169, mean Time to accident= 4.0961
Recall@80%, Time to accident= 4.131
Client 1: Epoch 4 validation AP = 0.8169
Client 1: Starting epoch 5/7
Client 1: Processing batch 0
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 20
Client 1: Processing batch 10
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 60
Client 1: Processing batch 50
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 70
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 80
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 90
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 100
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 110
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 120
Client 1: Processing batch 110
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 130
Client 1: Processing batch 120
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 140
Client 1: Processing batch 130
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 150
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 160
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 170
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 180
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 190
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 200
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 210
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.3908, mean Time to accident= 4.8102
Recall@80%, Time to accident= 4.907
Client 4: Epoch 5 validation AP = 0.3908
Client 4: Starting epoch 6/7
Client 4: Processing batch 0
Average Precision= 0.1717, mean Time to accident= 3.8513
Recall@80%, Time to accident= 3.769
Client 2: Epoch 5 validation AP = 0.1717
Client 2: Starting epoch 6/7
Client 2: Processing batch 0
Average Precision= 0.5962, mean Time to accident= 4.3889
Recall@80%, Time to accident= 4.389
Client 3: Epoch 5 validation AP = 0.5962
Client 3: New best AP = 0.5962, saving checkpoint
Client 3: Starting epoch 6/7
Client 3: Processing batch 0
Client 4: Processing batch 10
Average Precision= 0.7736, mean Time to accident= 4.3242
Recall@80%, Time to accident= 4.03
Client 0: Epoch 5 validation AP = 0.7736
Client 0: Starting epoch 6/7
Client 0: Processing batch 0
Average Precision= 0.8222, mean Time to accident= 3.8351
Recall@80%, Time to accident= 4.092
Client 1: Epoch 5 validation AP = 0.8222
Client 1: Starting epoch 6/7
Client 2: Processing batch 10
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 4: Processing batch 20
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 30
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 4: Processing batch 40
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 50
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 60
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 70
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 80
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 90
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 100
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 130
Client 0: Processing batch 120
Client 2: Processing batch 130
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 140
Client 0: Processing batch 130
Client 2: Processing batch 140
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 150
Client 0: Processing batch 140
Client 2: Processing batch 150
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 4: Processing batch 160
Client 0: Processing batch 150
Client 2: Processing batch 160
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 170
Client 0: Processing batch 160
Client 2: Processing batch 170
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 4: Processing batch 180
Client 0: Processing batch 170
Client 2: Processing batch 180
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 4: Processing batch 190
Client 0: Processing batch 180
Client 2: Processing batch 190
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 4: Processing batch 200
Client 0: Processing batch 190
Client 2: Processing batch 200
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 4: Processing batch 210
Client 0: Processing batch 200
Client 2: Processing batch 210
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.4768, mean Time to accident= 3.2778
Recall@80%, Time to accident= 5.0
Client 4: Epoch 6 validation AP = 0.4768
Client 4: Starting epoch 7/7
Client 4: Processing batch 0
Average Precision= 0.3771, mean Time to accident= 4.7022
Recall@80%, Time to accident= 4.389
Client 2: Epoch 6 validation AP = 0.3771
Client 2: New best AP = 0.3771, saving checkpoint
Client 2: Starting epoch 7/7
Client 2: Processing batch 0
Average Precision= 0.3020, mean Time to accident= 4.3333
Recall@80%, Time to accident= 4.222
Client 3: Epoch 6 validation AP = 0.3020
Client 3: Starting epoch 7/7
Client 3: Processing batch 0
Client 4: Processing batch 10
Average Precision= 0.7978, mean Time to accident= 4.4216
Recall@80%, Time to accident= 4.045
Client 0: Epoch 6 validation AP = 0.7978
Client 0: Starting epoch 7/7
Client 0: Processing batch 0
Client 2: Processing batch 10
Average Precision= 0.8024, mean Time to accident= 3.9821
Recall@80%, Time to accident= 3.881
Client 1: Epoch 6 validation AP = 0.8024
Client 1: Starting epoch 7/7
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 4: Processing batch 30
Client 0: Processing batch 20
Client 2: Processing batch 30
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 4: Processing batch 40
Client 0: Processing batch 30
Client 2: Processing batch 40
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 4: Processing batch 50
Client 0: Processing batch 40
Client 2: Processing batch 50
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 4: Processing batch 60
Client 0: Processing batch 50
Client 2: Processing batch 60
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 4: Processing batch 80
Client 0: Processing batch 70
Client 2: Processing batch 80
Client 1: Processing batch 70
Client 3: Processing batch 80
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 100
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.3584, mean Time to accident= 4.5961
Recall@80%, Time to accident= 4.593
Client 4: Epoch 7 validation AP = 0.3584
Client 4: Loaded best model checkpoint with AP = 0.6066
Average Precision= 0.1983, mean Time to accident= 4.4275
Recall@80%, Time to accident= 4.389
Client 2: Epoch 7 validation AP = 0.1983
Client 2: Loaded best model checkpoint with AP = 0.3771
Average Precision= 0.5698, mean Time to accident= 3.8210
Recall@80%, Time to accident= 4.333
Client 3: Epoch 7 validation AP = 0.5698
Client 3: Loaded best model checkpoint with AP = 0.5962
Average Precision= 0.7628, mean Time to accident= 4.1426
Recall@80%, Time to accident= 4.015
Client 0: Epoch 7 validation AP = 0.7628
Client 0: Loaded best model checkpoint with AP = 0.8222
Average Precision= 0.7462, mean Time to accident= 3.9476
Recall@80%, Time to accident= 3.95
Client 1: Epoch 7 validation AP = 0.7462
Client 1: Loaded best model checkpoint with AP = 0.8589
DEBUG flwr 2025-11-08 02:37:07,204 | server.py:236 | fit_round 3 received 5 results and 0 failures
Saved PR curve: results/federated/pr_curve_round_2.png
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0090, 0.1976]
Batch 0: pred_labels unique=[0], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0100, 0.7171]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.0066, 0.6509]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.4213, mean Time to accident= 3.7219
Recall@80%, Time to accident= 4.094

=== SERVER EVALUATION ROUND 3 ===
Confusion Matrix:
[[28891  1209]
 [14580  1320]]
Class-wise recall: [0.96  0.083]
==================================================
INFO flwr 2025-11-08 02:38:01,706 | server.py:125 | fit progress: (3, 0.0, {'ap': 0.4212768122195525, 'mtta': 3.7218817693293476, 'tta_r80': 4.093613298337708, 'recall_neg': 0.9598338870431894, 'recall_pos': 0.0830188679245283, 'pr_auc_frame': 0.42126088235379966}, 53951.559294198)
DEBUG flwr 2025-11-08 02:38:01,706 | server.py:173 | evaluate_round 3: strategy sampled 5 clients (out of 5)
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 1: Reset optimizer and scheduler state after loading server parameters
Client 2: Reset optimizer and scheduler state after loading server parameters
DEBUG flwr 2025-11-08 02:44:27,267 | server.py:187 | evaluate_round 3 received 5 results and 0 failures
DEBUG flwr 2025-11-08 02:44:27,267 | server.py:222 | fit_round 4: strategy sampled 5 clients (out of 5)
Average Precision= 0.3472, mean Time to accident= 3.5895
Recall@80%, Time to accident= 2.917
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 3: Starting epoch 1/7
Average Precision= 0.3164, mean Time to accident= 4.0937
Recall@80%, Time to accident= 4.389
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 4: Starting epoch 1/7
Average Precision= 0.7793, mean Time to accident= 3.7614
Recall@80%, Time to accident= 3.923
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 0: Starting epoch 1/7
Average Precision= 0.8593, mean Time to accident= 4.2973
Recall@80%, Time to accident= 3.922
Client 1: Reset optimizer and scheduler state after loading server parameters
Client 1: Starting epoch 1/7
Average Precision= 0.4001, mean Time to accident= 4.4786
Recall@80%, Time to accident= 4.204
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 2: Starting epoch 1/7
Client 3: Processing batch 0
Client 1: Processing batch 0
Client 4: Processing batch 0
Client 2: Processing batch 0
Client 0: Processing batch 0
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 4: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 210
Average Precision= 0.7847, mean Time to accident= 4.4512
Recall@80%, Time to accident= 4.256
Client 1: Epoch 1 validation AP = 0.7847
Client 1: New best AP = 0.7847, saving checkpoint
Client 1: Starting epoch 2/7
Average Precision= 0.6076, mean Time to accident= 3.8542
Recall@80%, Time to accident= 5.0
Client 4: Epoch 1 validation AP = 0.6076
Client 4: New best AP = 0.6076, saving checkpoint
Client 4: Starting epoch 2/7
Average Precision= 0.5795, mean Time to accident= 4.6111
Recall@80%, Time to accident= 4.667
Client 3: Epoch 1 validation AP = 0.5795
Client 3: New best AP = 0.5795, saving checkpoint
Client 3: Starting epoch 2/7
Client 1: Processing batch 0
Client 4: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.7964, mean Time to accident= 4.1018
Recall@80%, Time to accident= 4.053
Client 0: Epoch 1 validation AP = 0.7964
Client 0: New best AP = 0.7964, saving checkpoint
Client 0: Starting epoch 2/7
Client 0: Processing batch 0
Average Precision= 0.1899, mean Time to accident= 3.5906
Recall@80%, Time to accident= 3.954
Client 2: Epoch 1 validation AP = 0.1899
Client 2: New best AP = 0.1899, saving checkpoint
Client 2: Starting epoch 2/7
Client 2: Processing batch 0
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 30
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 40
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 50
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 80
Client 1: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 1: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 100
Client 1: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 1: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 1: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 2: Processing batch 210
Average Precision= 0.6795, mean Time to accident= 3.6265
Recall@80%, Time to accident= 3.75
Client 3: Epoch 2 validation AP = 0.6795
Client 3: New best AP = 0.6795, saving checkpoint
Client 3: Starting epoch 3/7
Client 3: Processing batch 0
Average Precision= 0.7780, mean Time to accident= 3.8617
Recall@80%, Time to accident= 3.961
Client 1: Epoch 2 validation AP = 0.7780
Client 1: Starting epoch 3/7
Average Precision= 0.5950, mean Time to accident= 4.7708
Recall@80%, Time to accident= 5.0
Client 4: Epoch 2 validation AP = 0.5950
Client 4: Starting epoch 3/7
Client 4: Processing batch 0
Client 1: Processing batch 0
Average Precision= 0.4297, mean Time to accident= 4.5739
Recall@80%, Time to accident= 4.602
Client 2: Epoch 2 validation AP = 0.4297
Client 2: New best AP = 0.4297, saving checkpoint
Client 2: Starting epoch 3/7
Average Precision= 0.7933, mean Time to accident= 4.5283
Recall@80%, Time to accident= 4.141
Client 0: Epoch 2 validation AP = 0.7933
Client 0: Starting epoch 3/7
Client 2: Processing batch 0
Client 0: Processing batch 0
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 150
Client 4: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 210
Client 4: Processing batch 210
Client 1: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.5628, mean Time to accident= 4.6505
Recall@80%, Time to accident= 4.741
Client 4: Epoch 3 validation AP = 0.5628
Client 4: Starting epoch 4/7
Average Precision= 0.3141, mean Time to accident= 4.2222
Recall@80%, Time to accident= 3.889
Client 3: Epoch 3 validation AP = 0.3141
Client 3: Starting epoch 4/7
Client 4: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.6950, mean Time to accident= 3.9444
Recall@80%, Time to accident= 4.15
Client 1: Epoch 3 validation AP = 0.6950
Client 1: Starting epoch 4/7
Client 1: Processing batch 0
Average Precision= 0.5775, mean Time to accident= 4.7542
Recall@80%, Time to accident= 4.593
Client 2: Epoch 3 validation AP = 0.5775
Client 2: New best AP = 0.5775, saving checkpoint
Client 2: Starting epoch 4/7
Client 2: Processing batch 0
Average Precision= 0.7544, mean Time to accident= 4.3518
Recall@80%, Time to accident= 4.139
Client 0: Epoch 3 validation AP = 0.7544
Client 0: Starting epoch 4/7
Client 0: Processing batch 0
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 30
Client 4: Processing batch 40
Client 0: Processing batch 30
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 50
Client 0: Processing batch 40
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 100
Client 0: Processing batch 90
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 110
Client 0: Processing batch 100
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 120
Client 0: Processing batch 110
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 140
Client 0: Processing batch 130
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 150
Client 0: Processing batch 140
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 4: Processing batch 160
Client 0: Processing batch 150
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 160
Client 4: Processing batch 170
Client 0: Processing batch 160
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 180
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 210
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Client 2: Processing batch 210
Average Precision= 0.7420, mean Time to accident= 4.6250
Recall@80%, Time to accident= 4.944
Client 4: Epoch 4 validation AP = 0.7420
Client 4: New best AP = 0.7420, saving checkpoint
Client 4: Starting epoch 5/7
Client 4: Processing batch 0
Average Precision= 0.4298, mean Time to accident= 4.0833
Recall@80%, Time to accident= 3.75
Client 3: Epoch 4 validation AP = 0.4298
Client 3: Starting epoch 5/7
Client 3: Processing batch 0
Average Precision= 0.7839, mean Time to accident= 4.2174
Recall@80%, Time to accident= 3.906
Client 1: Epoch 4 validation AP = 0.7839
Client 1: Starting epoch 5/7
Client 1: Processing batch 0
Average Precision= 0.4402, mean Time to accident= 4.5885
Recall@80%, Time to accident= 4.796
Client 2: Epoch 4 validation AP = 0.4402
Client 2: Starting epoch 5/7
Client 2: Processing batch 0
Client 4: Processing batch 10
Average Precision= 0.7657, mean Time to accident= 4.3694
Recall@80%, Time to accident= 4.269
Client 0: Epoch 4 validation AP = 0.7657
Client 0: Starting epoch 5/7
Client 0: Processing batch 0
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 20
Client 2: Processing batch 10
Client 3: Processing batch 20
Client 0: Processing batch 10
Client 1: Processing batch 20
Client 2: Processing batch 20
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 20
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 2: Processing batch 30
Client 3: Processing batch 40
Client 0: Processing batch 30
Client 1: Processing batch 40
Client 4: Processing batch 50
Client 2: Processing batch 40
Client 3: Processing batch 50
Client 0: Processing batch 40
Client 1: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 50
Client 1: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 60
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 70
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 80
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 2: Processing batch 90
Client 3: Processing batch 100
Client 0: Processing batch 90
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 2: Processing batch 100
Client 3: Processing batch 110
Client 0: Processing batch 100
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 2: Processing batch 110
Client 3: Processing batch 120
Client 0: Processing batch 110
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 2: Processing batch 120
Client 3: Processing batch 130
Client 0: Processing batch 120
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 2: Processing batch 130
Client 3: Processing batch 140
Client 0: Processing batch 130
Client 1: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 140
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 150
Client 1: Processing batch 160
Client 2: Processing batch 160
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 160
Client 1: Processing batch 170
Client 4: Processing batch 180
Client 2: Processing batch 170
Client 3: Processing batch 180
Client 0: Processing batch 170
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 200
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.7045, mean Time to accident= 4.8125
Recall@80%, Time to accident= 4.833
Client 4: Epoch 5 validation AP = 0.7045
Client 4: Starting epoch 6/7
Average Precision= 0.5965, mean Time to accident= 4.1821
Recall@80%, Time to accident= 3.806
Client 3: Epoch 5 validation AP = 0.5965
Client 3: Starting epoch 6/7
Client 4: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.7352, mean Time to accident= 3.7101
Recall@80%, Time to accident= 4.244
Client 1: Epoch 5 validation AP = 0.7352
Client 1: Starting epoch 6/7
Client 1: Processing batch 0
Average Precision= 0.4701, mean Time to accident= 4.6655
Recall@80%, Time to accident= 4.796
Client 2: Epoch 5 validation AP = 0.4701
Client 2: Starting epoch 6/7
Client 4: Processing batch 10
Client 2: Processing batch 0
Client 3: Processing batch 10
Average Precision= 0.7427, mean Time to accident= 4.4118
Recall@80%, Time to accident= 4.041
Client 0: Epoch 5 validation AP = 0.7427
Client 0: Starting epoch 6/7
Client 0: Processing batch 0
Client 1: Processing batch 10
Client 2: Processing batch 10
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 10
Client 1: Processing batch 20
Client 4: Processing batch 30
Client 2: Processing batch 20
Client 3: Processing batch 30
Client 0: Processing batch 20
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 40
Client 1: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 50
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 2: Processing batch 60
Client 3: Processing batch 70
Client 0: Processing batch 60
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 70
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 2: Processing batch 80
Client 3: Processing batch 90
Client 0: Processing batch 80
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 2: Processing batch 90
Client 3: Processing batch 100
Client 0: Processing batch 90
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 2: Processing batch 100
Client 3: Processing batch 110
Client 0: Processing batch 100
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 2: Processing batch 110
Client 3: Processing batch 120
Client 0: Processing batch 110
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 2: Processing batch 120
Client 3: Processing batch 130
Client 0: Processing batch 120
Client 4: Processing batch 140
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 140
Client 0: Processing batch 130
Client 4: Processing batch 150
Client 1: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 150
Client 0: Processing batch 140
Client 4: Processing batch 160
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 160
Client 0: Processing batch 150
Client 4: Processing batch 170
Client 1: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 170
Client 0: Processing batch 160
Client 4: Processing batch 180
Client 1: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 180
Client 0: Processing batch 170
Client 4: Processing batch 190
Client 1: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 190
Client 0: Processing batch 180
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 2: Processing batch 190
Client 3: Processing batch 200
Client 0: Processing batch 190
Client 4: Processing batch 210
Client 1: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 210
Client 0: Processing batch 200
Client 1: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.7083, mean Time to accident= 4.2396
Recall@80%, Time to accident= 4.222
Client 4: Epoch 6 validation AP = 0.7083
Client 4: Starting epoch 7/7
Client 4: Processing batch 0
Average Precision= 0.6091, mean Time to accident= 3.6142
Recall@80%, Time to accident= 3.806
Client 3: Epoch 6 validation AP = 0.6091
Client 3: Starting epoch 7/7
Client 3: Processing batch 0
Client 4: Processing batch 10
Average Precision= 0.7586, mean Time to accident= 4.0133
Recall@80%, Time to accident= 4.003
Client 1: Epoch 6 validation AP = 0.7586
Client 1: Starting epoch 7/7
Average Precision= 0.5488, mean Time to accident= 4.6904
Recall@80%, Time to accident= 4.778
Client 2: Epoch 6 validation AP = 0.5488
Client 2: Starting epoch 7/7
Client 1: Processing batch 0
Client 2: Processing batch 0
Client 3: Processing batch 10
Average Precision= 0.8041, mean Time to accident= 4.3543
Recall@80%, Time to accident= 4.051
Client 0: Epoch 6 validation AP = 0.8041
Client 0: New best AP = 0.8041, saving checkpoint
Client 0: Starting epoch 7/7
Client 0: Processing batch 0
Client 4: Processing batch 20
Client 1: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 20
Client 0: Processing batch 10
Client 4: Processing batch 30
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 0: Processing batch 20
Client 4: Processing batch 40
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 0: Processing batch 30
Client 4: Processing batch 50
Client 2: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 0: Processing batch 40
Client 4: Processing batch 60
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 0: Processing batch 50
Client 4: Processing batch 70
Client 2: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 0: Processing batch 60
Client 4: Processing batch 80
Client 2: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 80
Client 0: Processing batch 70
Client 4: Processing batch 90
Client 2: Processing batch 80
Client 3: Processing batch 90
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 100
Client 2: Processing batch 90
Client 3: Processing batch 100
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 110
Client 2: Processing batch 100
Client 3: Processing batch 110
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 120
Client 2: Processing batch 110
Client 3: Processing batch 120
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 130
Client 2: Processing batch 120
Client 3: Processing batch 130
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 140
Client 2: Processing batch 130
Client 3: Processing batch 140
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 150
Client 2: Processing batch 140
Client 3: Processing batch 150
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 160
Client 2: Processing batch 150
Client 3: Processing batch 160
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 170
Client 2: Processing batch 160
Client 3: Processing batch 170
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 180
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 0: Processing batch 170
Client 4: Processing batch 190
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 200
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 0: Processing batch 190
Client 4: Processing batch 210
Client 2: Processing batch 200
Client 3: Processing batch 210
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.5866, mean Time to accident= 4.2824
Recall@80%, Time to accident= 4.407
Client 4: Epoch 7 validation AP = 0.5866
Client 4: Loaded best model checkpoint with AP = 0.7420
Average Precision= 0.5806, mean Time to accident= 3.3333
Recall@80%, Time to accident= 3.444
Client 3: Epoch 7 validation AP = 0.5806
Client 3: Loaded best model checkpoint with AP = 0.6795
Average Precision= 0.7262, mean Time to accident= 3.8365
Recall@80%, Time to accident= 3.933
Client 1: Epoch 7 validation AP = 0.7262
Client 1: Loaded best model checkpoint with AP = 0.7847
Average Precision= 0.5125, mean Time to accident= 4.1968
Recall@80%, Time to accident= 4.389
Client 2: Epoch 7 validation AP = 0.5125
Client 2: Loaded best model checkpoint with AP = 0.5775
Average Precision= 0.7414, mean Time to accident= 4.2487
Recall@80%, Time to accident= 4.081
Client 0: Epoch 7 validation AP = 0.7414
Client 0: Loaded best model checkpoint with AP = 0.8041
DEBUG flwr 2025-11-08 07:36:59,478 | server.py:236 | fit_round 4 received 5 results and 0 failures
Saved PR curve: results/federated/pr_curve_round_3.png
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0035, 0.0862]
Batch 0: pred_labels unique=[0], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0059, 0.6145]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.0045, 0.7911]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.4196, mean Time to accident= 3.7846
Recall@80%, Time to accident= 3.72

=== SERVER EVALUATION ROUND 4 ===
Confusion Matrix:
[[28473  1627]
 [14301  1599]]
Class-wise recall: [0.946 0.101]
==================================================
INFO flwr 2025-11-08 07:37:54,017 | server.py:125 | fit progress: (4, 0.0, {'ap': 0.41958309977261166, 'mtta': 3.7846329981497235, 'tta_r80': 3.720472440944882, 'recall_neg': 0.9459468438538206, 'recall_pos': 0.10056603773584906, 'pr_auc_frame': 0.41781458496067037}, 71943.86967038)
DEBUG flwr 2025-11-08 07:37:54,017 | server.py:173 | evaluate_round 4: strategy sampled 5 clients (out of 5)
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 1: Reset optimizer and scheduler state after loading server parameters
Client 4: Reset optimizer and scheduler state after loading server parameters
DEBUG flwr 2025-11-08 07:44:16,083 | server.py:187 | evaluate_round 4 received 5 results and 0 failures
DEBUG flwr 2025-11-08 07:44:16,084 | server.py:222 | fit_round 5: strategy sampled 5 clients (out of 5)
Average Precision= 0.6258, mean Time to accident= 3.8611
Recall@80%, Time to accident= 3.694
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 3: Starting epoch 1/7
Average Precision= 0.3164, mean Time to accident= 4.0671
Recall@80%, Time to accident= 4.574
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 4: Starting epoch 1/7
Average Precision= 0.7815, mean Time to accident= 3.4748
Recall@80%, Time to accident= 3.891
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 0: Starting epoch 1/7
Average Precision= 0.8357, mean Time to accident= 4.2508
Recall@80%, Time to accident= 4.219
Client 1: Reset optimizer and scheduler state after loading server parameters
Client 1: Starting epoch 1/7
Average Precision= 0.4810, mean Time to accident= 4.3210
Recall@80%, Time to accident= 4.148
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 2: Starting epoch 1/7
Client 3: Processing batch 0
Client 4: Processing batch 0
Client 0: Processing batch 0
Client 1: Processing batch 0
Client 2: Processing batch 0
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 90
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 1: Processing batch 100
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 160
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 180
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 2: Processing batch 210
Average Precision= 0.6200, mean Time to accident= 4.6597
Recall@80%, Time to accident= 4.667
Client 4: Epoch 1 validation AP = 0.6200
Client 4: New best AP = 0.6200, saving checkpoint
Client 4: Starting epoch 2/7
Client 4: Processing batch 0
Average Precision= 0.5520, mean Time to accident= 4.1574
Recall@80%, Time to accident= 3.694
Client 3: Epoch 1 validation AP = 0.5520
Client 3: New best AP = 0.5520, saving checkpoint
Client 3: Starting epoch 2/7
Average Precision= 0.8167, mean Time to accident= 4.4256
Recall@80%, Time to accident= 3.983
Client 0: Epoch 1 validation AP = 0.8167
Client 0: New best AP = 0.8167, saving checkpoint
Client 0: Starting epoch 2/7
Client 3: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.4819, mean Time to accident= 4.6151
Recall@80%, Time to accident= 4.852
Client 2: Epoch 1 validation AP = 0.4819
Client 2: New best AP = 0.4819, saving checkpoint
Client 2: Starting epoch 2/7
Average Precision= 0.6548, mean Time to accident= 4.2289
Recall@80%, Time to accident= 3.939
Client 1: Epoch 1 validation AP = 0.6548
Client 1: New best AP = 0.6548, saving checkpoint
Client 1: Starting epoch 2/7
Client 2: Processing batch 0
Client 1: Processing batch 0
Client 4: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.7878, mean Time to accident= 4.7477
Recall@80%, Time to accident= 4.907
Client 4: Epoch 2 validation AP = 0.7878
Client 4: New best AP = 0.7878, saving checkpoint
Client 4: Starting epoch 3/7
Average Precision= 0.5494, mean Time to accident= 3.8457
Recall@80%, Time to accident= 3.222
Client 3: Epoch 2 validation AP = 0.5494
Client 3: Starting epoch 3/7
Client 4: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.8121, mean Time to accident= 4.7199
Recall@80%, Time to accident= 4.778
Client 0: Epoch 2 validation AP = 0.8121
Client 0: Starting epoch 3/7
Average Precision= 0.2384, mean Time to accident= 4.4291
Recall@80%, Time to accident= 4.509
Client 2: Epoch 2 validation AP = 0.2384
Client 2: Starting epoch 3/7
Client 0: Processing batch 0
Client 2: Processing batch 0
Average Precision= 0.8442, mean Time to accident= 4.3419
Recall@80%, Time to accident= 4.219
Client 1: Epoch 2 validation AP = 0.8442
Client 1: New best AP = 0.8442, saving checkpoint
Client 1: Starting epoch 3/7
Client 1: Processing batch 0
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.7420, mean Time to accident= 4.6250
Recall@80%, Time to accident= 4.5
Client 4: Epoch 3 validation AP = 0.7420
Client 4: Starting epoch 4/7
Client 4: Processing batch 0
Average Precision= 0.5468, mean Time to accident= 4.1852
Recall@80%, Time to accident= 4.111
Client 3: Epoch 3 validation AP = 0.5468
Client 3: Starting epoch 4/7
Client 3: Processing batch 0
Average Precision= 0.3209, mean Time to accident= 4.8824
Recall@80%, Time to accident= 4.593
Client 2: Epoch 3 validation AP = 0.3209
Client 2: Starting epoch 4/7
Client 2: Processing batch 0
Average Precision= 0.8094, mean Time to accident= 4.4619
Recall@80%, Time to accident= 4.509
Client 0: Epoch 3 validation AP = 0.8094
Client 0: Starting epoch 4/7
Client 0: Processing batch 0
Average Precision= 0.8107, mean Time to accident= 4.4245
Recall@80%, Time to accident= 4.269
Client 1: Epoch 3 validation AP = 0.8107
Client 1: Starting epoch 4/7
Client 1: Processing batch 0
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.7628, mean Time to accident= 4.6400
Recall@80%, Time to accident= 4.574
Client 4: Epoch 4 validation AP = 0.7628
Client 4: Starting epoch 5/7
Average Precision= 0.5641, mean Time to accident= 4.2685
Recall@80%, Time to accident= 3.972
Client 3: Epoch 4 validation AP = 0.5641
Client 3: New best AP = 0.5641, saving checkpoint
Client 3: Starting epoch 5/7
Client 4: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.3174, mean Time to accident= 4.3201
Recall@80%, Time to accident= 4.315
Client 2: Epoch 4 validation AP = 0.3174
Client 2: Starting epoch 5/7
Average Precision= 0.7319, mean Time to accident= 4.1742
Recall@80%, Time to accident= 4.344
Client 0: Epoch 4 validation AP = 0.7319
Client 0: Starting epoch 5/7
Client 2: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.7192, mean Time to accident= 4.2329
Recall@80%, Time to accident= 3.921
Client 1: Epoch 4 validation AP = 0.7192
Client 1: Starting epoch 5/7
Client 1: Processing batch 0
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.6802, mean Time to accident= 4.4248
Recall@80%, Time to accident= 4.63
Client 4: Epoch 5 validation AP = 0.6802
Client 4: Starting epoch 6/7
Client 4: Processing batch 0
Average Precision= 0.3136, mean Time to accident= 4.3005
Recall@80%, Time to accident= 4.537
Client 2: Epoch 5 validation AP = 0.3136
Client 2: Starting epoch 6/7
Average Precision= 0.5655, mean Time to accident= 3.8611
Recall@80%, Time to accident= 3.972
Client 3: Epoch 5 validation AP = 0.5655
Client 3: New best AP = 0.5655, saving checkpoint
Client 3: Starting epoch 6/7
Client 2: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.7664, mean Time to accident= 4.2716
Recall@80%, Time to accident= 4.169
Client 0: Epoch 5 validation AP = 0.7664
Client 0: Starting epoch 6/7
Client 0: Processing batch 0
Client 4: Processing batch 10
Average Precision= 0.7122, mean Time to accident= 4.1152
Recall@80%, Time to accident= 4.014
Client 1: Epoch 5 validation AP = 0.7122
Client 1: Starting epoch 6/7
Client 2: Processing batch 10
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 20
Client 1: Processing batch 10
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 1: Processing batch 20
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 40
Client 1: Processing batch 30
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 50
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 60
Client 0: Processing batch 50
Client 2: Processing batch 60
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 4: Processing batch 80
Client 0: Processing batch 70
Client 2: Processing batch 80
Client 1: Processing batch 70
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 1: Processing batch 90
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 150
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 160
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 170
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 180
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 190
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 200
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 210
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.7045, mean Time to accident= 4.3669
Recall@80%, Time to accident= 4.815
Client 4: Epoch 6 validation AP = 0.7045
Client 4: Starting epoch 7/7
Client 4: Processing batch 0
Average Precision= 0.3230, mean Time to accident= 4.0278
Recall@80%, Time to accident= 4.324
Client 2: Epoch 6 validation AP = 0.3230
Client 2: Starting epoch 7/7
Average Precision= 0.5795, mean Time to accident= 4.0340
Recall@80%, Time to accident= 3.861
Client 3: Epoch 6 validation AP = 0.5795
Client 3: New best AP = 0.5795, saving checkpoint
Client 3: Starting epoch 7/7
Client 2: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.7953, mean Time to accident= 4.0983
Recall@80%, Time to accident= 4.085
Client 0: Epoch 6 validation AP = 0.7953
Client 0: Starting epoch 7/7
Client 0: Processing batch 0
Average Precision= 0.7733, mean Time to accident= 4.1835
Recall@80%, Time to accident= 3.972
Client 1: Epoch 6 validation AP = 0.7733
Client 1: Starting epoch 7/7
Client 4: Processing batch 10
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 20
Client 1: Processing batch 10
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 30
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 40
Client 1: Processing batch 30
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 50
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 60
Client 1: Processing batch 50
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 70
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 90
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 100
Client 1: Processing batch 90
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 110
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 120
Client 1: Processing batch 110
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 130
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 140
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 150
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 160
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 170
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 180
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 190
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 200
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 210
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.7052, mean Time to accident= 4.3785
Recall@80%, Time to accident= 4.5
Client 4: Epoch 7 validation AP = 0.7052
Client 4: Loaded best model checkpoint with AP = 0.7878
Average Precision= 0.3297, mean Time to accident= 4.1366
Recall@80%, Time to accident= 4.333
Client 2: Epoch 7 validation AP = 0.3297
Client 2: Loaded best model checkpoint with AP = 0.4819
Average Precision= 0.5669, mean Time to accident= 3.6821
Recall@80%, Time to accident= 3.806
Client 3: Epoch 7 validation AP = 0.5669
Client 3: Loaded best model checkpoint with AP = 0.5795
Average Precision= 0.8214, mean Time to accident= 4.3566
Recall@80%, Time to accident= 4.171
Client 0: Epoch 7 validation AP = 0.8214
Client 0: New best AP = 0.8214, saving checkpoint
Client 0: Loaded best model checkpoint with AP = 0.8214
Average Precision= 0.6806, mean Time to accident= 4.1264
Recall@80%, Time to accident= 4.264
Client 1: Epoch 7 validation AP = 0.6806
Client 1: Loaded best model checkpoint with AP = 0.8442
DEBUG flwr 2025-11-08 12:38:05,668 | server.py:236 | fit_round 5 received 5 results and 0 failures
Saved PR curve: results/federated/pr_curve_round_4.png
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0008, 0.1053]
Batch 0: pred_labels unique=[0], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0037, 0.7909]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.0118, 0.9202]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.4327, mean Time to accident= 3.6895
Recall@80%, Time to accident= 3.8

=== SERVER EVALUATION ROUND 5 ===
Confusion Matrix:
[[27802  2298]
 [13456  2444]]
Class-wise recall: [0.924 0.154]
==================================================
INFO flwr 2025-11-08 12:39:00,491 | server.py:125 | fit progress: (5, 0.0, {'ap': 0.43266652758038526, 'mtta': 3.689518921964633, 'tta_r80': 3.7996500437445313, 'recall_neg': 0.9236544850498339, 'recall_pos': 0.15371069182389938, 'pr_auc_frame': 0.43097291824052897}, 90010.343545973)
DEBUG flwr 2025-11-08 12:39:00,491 | server.py:173 | evaluate_round 5: strategy sampled 5 clients (out of 5)
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 1: Reset optimizer and scheduler state after loading server parameters
DEBUG flwr 2025-11-08 12:45:20,027 | server.py:187 | evaluate_round 5 received 5 results and 0 failures
DEBUG flwr 2025-11-08 12:45:20,027 | server.py:222 | fit_round 6: strategy sampled 5 clients (out of 5)
Average Precision= 0.7589, mean Time to accident= 3.5091
Recall@80%, Time to accident= 4.169
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 0: Starting epoch 1/7
Average Precision= 0.3980, mean Time to accident= 3.8796
Recall@80%, Time to accident= 3.25
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 3: Starting epoch 1/7
Average Precision= 0.5166, mean Time to accident= 4.3131
Recall@80%, Time to accident= 3.926
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 2: Starting epoch 1/7
Average Precision= 0.2228, mean Time to accident= 3.9086
Recall@80%, Time to accident= 4.37
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 4: Starting epoch 1/7
Average Precision= 0.8640, mean Time to accident= 4.0132
Recall@80%, Time to accident= 3.953
Client 1: Reset optimizer and scheduler state after loading server parameters
Client 1: Starting epoch 1/7
Client 3: Processing batch 0
Client 0: Processing batch 0
Client 1: Processing batch 0
Client 2: Processing batch 0
Client 4: Processing batch 0
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 4: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 50
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 70
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 120
Client 4: Processing batch 120
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 130
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 2: Processing batch 210
Average Precision= 0.8878, mean Time to accident= 4.7130
Recall@80%, Time to accident= 4.963
Client 4: Epoch 1 validation AP = 0.8878
Client 4: New best AP = 0.8878, saving checkpoint
Client 4: Starting epoch 2/7
Average Precision= 0.2211, mean Time to accident= 3.4877
Recall@80%, Time to accident= 3.0
Client 3: Epoch 1 validation AP = 0.2211
Client 3: New best AP = 0.2211, saving checkpoint
Client 3: Starting epoch 2/7
Client 4: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.5426, mean Time to accident= 4.5655
Recall@80%, Time to accident= 4.509
Client 2: Epoch 1 validation AP = 0.5426
Client 2: New best AP = 0.5426, saving checkpoint
Client 2: Starting epoch 2/7
Average Precision= 0.8041, mean Time to accident= 4.2436
Recall@80%, Time to accident= 4.044
Client 1: Epoch 1 validation AP = 0.8041
Client 1: New best AP = 0.8041, saving checkpoint
Client 1: Starting epoch 2/7
Client 2: Processing batch 0
Average Precision= 0.8355, mean Time to accident= 4.3553
Recall@80%, Time to accident= 4.187
Client 0: Epoch 1 validation AP = 0.8355
Client 0: New best AP = 0.8355, saving checkpoint
Client 0: Starting epoch 2/7
Client 1: Processing batch 0
Client 0: Processing batch 0
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 150
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 210
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.7431, mean Time to accident= 4.1019
Recall@80%, Time to accident= 4.583
Client 3: Epoch 2 validation AP = 0.7431
Client 3: New best AP = 0.7431, saving checkpoint
Client 3: Starting epoch 3/7
Client 3: Processing batch 0
Average Precision= 0.7431, mean Time to accident= 4.5139
Recall@80%, Time to accident= 5.0
Client 4: Epoch 2 validation AP = 0.7431
Client 4: Starting epoch 3/7
Average Precision= 0.5312, mean Time to accident= 4.6430
Recall@80%, Time to accident= 4.417
Client 2: Epoch 2 validation AP = 0.5312
Client 2: Starting epoch 3/7
Client 4: Processing batch 0
Average Precision= 0.7793, mean Time to accident= 4.4682
Recall@80%, Time to accident= 4.333
Client 1: Epoch 2 validation AP = 0.7793
Client 1: Starting epoch 3/7
Client 2: Processing batch 0
Client 1: Processing batch 0
Average Precision= 0.8122, mean Time to accident= 4.2401
Recall@80%, Time to accident= 4.028
Client 0: Epoch 2 validation AP = 0.8122
Client 0: Starting epoch 3/7
Client 0: Processing batch 0
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.5685, mean Time to accident= 3.4105
Recall@80%, Time to accident= 3.028
Client 3: Epoch 3 validation AP = 0.5685
Client 3: Starting epoch 4/7
Client 3: Processing batch 0
Average Precision= 0.8882, mean Time to accident= 4.5382
Recall@80%, Time to accident= 5.0
Client 4: Epoch 3 validation AP = 0.8882
Client 4: New best AP = 0.8882, saving checkpoint
Client 4: Starting epoch 4/7
Average Precision= 0.5590, mean Time to accident= 4.5710
Recall@80%, Time to accident= 4.778
Client 2: Epoch 3 validation AP = 0.5590
Client 2: New best AP = 0.5590, saving checkpoint
Client 2: Starting epoch 4/7
Client 4: Processing batch 0
Client 2: Processing batch 0
Average Precision= 0.7904, mean Time to accident= 4.3622
Recall@80%, Time to accident= 4.475
Client 0: Epoch 3 validation AP = 0.7904
Client 0: Starting epoch 4/7
Client 0: Processing batch 0
Average Precision= 0.7109, mean Time to accident= 4.2544
Recall@80%, Time to accident= 4.331
Client 1: Epoch 3 validation AP = 0.7109
Client 1: Starting epoch 4/7
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.5728, mean Time to accident= 3.4660
Recall@80%, Time to accident= 3.083
Client 3: Epoch 4 validation AP = 0.5728
Client 3: Starting epoch 5/7
Client 3: Processing batch 0
Average Precision= 0.8902, mean Time to accident= 3.9838
Recall@80%, Time to accident= 4.407
Client 4: Epoch 4 validation AP = 0.8902
Client 4: New best AP = 0.8902, saving checkpoint
Client 4: Starting epoch 5/7
Client 4: Processing batch 0
Average Precision= 0.3187, mean Time to accident= 4.2638
Recall@80%, Time to accident= 4.546
Client 2: Epoch 4 validation AP = 0.3187
Client 2: Starting epoch 5/7
Client 2: Processing batch 0
Average Precision= 0.8251, mean Time to accident= 4.3079
Recall@80%, Time to accident= 4.165
Client 0: Epoch 4 validation AP = 0.8251
Client 0: Starting epoch 5/7
Client 0: Processing batch 0
Average Precision= 0.7013, mean Time to accident= 4.2248
Recall@80%, Time to accident= 4.125
Client 1: Epoch 4 validation AP = 0.7013
Client 1: Starting epoch 5/7
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 70
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 90
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 150
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 160
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 170
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.8885, mean Time to accident= 4.4757
Recall@80%, Time to accident= 5.0
Client 4: Epoch 5 validation AP = 0.8885
Client 4: Starting epoch 6/7
Average Precision= 0.6114, mean Time to accident= 3.4321
Recall@80%, Time to accident= 3.111
Client 3: Epoch 5 validation AP = 0.6114
Client 3: Starting epoch 6/7
Client 4: Processing batch 0
Average Precision= 0.4809, mean Time to accident= 4.2481
Recall@80%, Time to accident= 4.361
Client 2: Epoch 5 validation AP = 0.4809
Client 2: Starting epoch 6/7
Client 3: Processing batch 0
Client 2: Processing batch 0
Average Precision= 0.7810, mean Time to accident= 4.2342
Recall@80%, Time to accident= 3.964
Client 0: Epoch 5 validation AP = 0.7810
Client 0: Starting epoch 6/7
Client 0: Processing batch 0
Average Precision= 0.7053, mean Time to accident= 4.0423
Recall@80%, Time to accident= 3.849
Client 1: Epoch 5 validation AP = 0.7053
Client 1: Starting epoch 6/7
Client 1: Processing batch 0
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.8878, mean Time to accident= 4.8125
Recall@80%, Time to accident= 5.0
Client 4: Epoch 6 validation AP = 0.8878
Client 4: Starting epoch 7/7
Average Precision= 0.6026, mean Time to accident= 3.4691
Recall@80%, Time to accident= 3.111
Client 3: Epoch 6 validation AP = 0.6026
Client 3: Starting epoch 7/7
Client 4: Processing batch 0
Average Precision= 0.4677, mean Time to accident= 4.2361
Recall@80%, Time to accident= 4.546
Client 2: Epoch 6 validation AP = 0.4677
Client 2: Starting epoch 7/7
Client 3: Processing batch 0
Client 2: Processing batch 0
Average Precision= 0.8044, mean Time to accident= 4.2802
Recall@80%, Time to accident= 3.859
Client 0: Epoch 6 validation AP = 0.8044
Client 0: Starting epoch 7/7
Client 0: Processing batch 0
Average Precision= 0.7546, mean Time to accident= 4.0767
Recall@80%, Time to accident= 3.892
Client 1: Epoch 6 validation AP = 0.7546
Client 1: Starting epoch 7/7
Client 1: Processing batch 0
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 40
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 50
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 60
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 110
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.8264, mean Time to accident= 4.5382
Recall@80%, Time to accident= 5.0
Client 4: Epoch 7 validation AP = 0.8264
Client 4: Loaded best model checkpoint with AP = 0.8902
Average Precision= 0.5894, mean Time to accident= 3.3086
Recall@80%, Time to accident= 3.056
Client 3: Epoch 7 validation AP = 0.5894
Client 3: Loaded best model checkpoint with AP = 0.7431
Average Precision= 0.4456, mean Time to accident= 4.2768
Recall@80%, Time to accident= 4.565
Client 2: Epoch 7 validation AP = 0.4456
Client 2: Loaded best model checkpoint with AP = 0.5590
Average Precision= 0.7903, mean Time to accident= 4.2855
Recall@80%, Time to accident= 3.905
Client 0: Epoch 7 validation AP = 0.7903
Client 0: Loaded best model checkpoint with AP = 0.8355
Average Precision= 0.7290, mean Time to accident= 4.0083
Recall@80%, Time to accident= 4.032
Client 1: Epoch 7 validation AP = 0.7290
Client 1: Loaded best model checkpoint with AP = 0.8041
DEBUG flwr 2025-11-08 17:39:33,578 | server.py:236 | fit_round 6 received 5 results and 0 failures
Saved PR curve: results/federated/pr_curve_round_5.png
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0006, 0.0627]
Batch 0: pred_labels unique=[0], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0033, 0.9139]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.0016, 0.8427]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.4391, mean Time to accident= 4.0447
Recall@80%, Time to accident= 4.17

=== SERVER EVALUATION ROUND 6 ===
Confusion Matrix:
[[28551  1549]
 [14116  1784]]
Class-wise recall: [0.949 0.112]
==================================================
INFO flwr 2025-11-08 17:40:28,701 | server.py:125 | fit progress: (6, 0.0, {'ap': 0.43905990490982555, 'mtta': 4.044668642155997, 'tta_r80': 4.169728783902013, 'recall_neg': 0.9485382059800664, 'recall_pos': 0.11220125786163522, 'pr_auc_frame': 0.43721456336256637}, 108098.554403132)
DEBUG flwr 2025-11-08 17:40:28,702 | server.py:173 | evaluate_round 6: strategy sampled 5 clients (out of 5)
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 1: Reset optimizer and scheduler state after loading server parameters
DEBUG flwr 2025-11-08 17:46:49,784 | server.py:187 | evaluate_round 6 received 5 results and 0 failures
INFO flwr 2025-11-08 17:46:49,785 | server.py:153 | FL finished in 108479.63754703199
INFO flwr 2025-11-08 17:46:49,785 | app.py:226 | app_fit: losses_distributed [(1, 0.699999988079071), (2, 0.699999988079071), (3, 0.699999988079071), (4, 0.699999988079071), (5, 0.699999988079071), (6, 0.699999988079071)]
INFO flwr 2025-11-08 17:46:49,785 | app.py:227 | app_fit: metrics_distributed_fit {}
INFO flwr 2025-11-08 17:46:49,785 | app.py:228 | app_fit: metrics_distributed {}
INFO flwr 2025-11-08 17:46:49,785 | app.py:229 | app_fit: losses_centralized [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0), (5, 0.0), (6, 0.0)]
INFO flwr 2025-11-08 17:46:49,785 | app.py:230 | app_fit: metrics_centralized {'ap': [(0, 0.34070511181183394), (1, 0.4095341940503391), (2, 0.3729549742517724), (3, 0.4212768122195525), (4, 0.41958309977261166), (5, 0.43266652758038526), (6, 0.43905990490982555)], 'mtta': [(0, 4.481862786776933), (1, 3.6805823248428604), (2, 3.8639231844483524), (3, 3.7218817693293476), (4, 3.7846329981497235), (5, 3.689518921964633), (6, 4.044668642155997)], 'tta_r80': [(0, 4.031007751937984), (1, 3.802274715660542), (2, 4.027121609798775), (3, 4.093613298337708), (4, 3.720472440944882), (5, 3.7996500437445313), (6, 4.169728783902013)], 'recall_neg': [(0, 0.4961794019933555), (1, 0.9998006644518272), (2, 0.9598338870431894), (3, 0.9598338870431894), (4, 0.9459468438538206), (5, 0.9236544850498339), (6, 0.9485382059800664)], 'recall_pos': [(0, 0.49553459119496857), (1, 0.0018867924528301887), (2, 0.052767295597484276), (3, 0.0830188679245283), (4, 0.10056603773584906), (5, 0.15371069182389938), (6, 0.11220125786163522)], 'pr_auc_frame': [(0, 0.3408432836152453), (1, 0.38438466846845326), (2, 0.38849595583958546), (3, 0.42126088235379966), (4, 0.41781458496067037), (5, 0.43097291824052897), (6, 0.43721456336256637)]}
DEBUG flwr 2025-11-08 17:46:49,789 | connection.py:220 | gRPC channel closed
DEBUG flwr 2025-11-08 17:46:49,789 | connection.py:220 | gRPC channel closed
DEBUG flwr 2025-11-08 17:46:49,789 | connection.py:220 | gRPC channel closed
DEBUG flwr 2025-11-08 17:46:49,789 | connection.py:220 | gRPC channel closed
INFO flwr 2025-11-08 17:46:49,790 | app.py:398 | Disconnect and shut down
DEBUG flwr 2025-11-08 17:46:49,790 | connection.py:220 | gRPC channel closed
INFO flwr 2025-11-08 17:46:49,790 | app.py:398 | Disconnect and shut down
INFO flwr 2025-11-08 17:46:49,790 | app.py:398 | Disconnect and shut down
INFO flwr 2025-11-08 17:46:49,790 | app.py:398 | Disconnect and shut down
INFO flwr 2025-11-08 17:46:49,790 | app.py:398 | Disconnect and shut down
Saved PR curve: results/federated/pr_curve_round_6.png
Average Precision= 0.8545, mean Time to accident= 4.1219
Recall@80%, Time to accident= 3.928
Average Precision= 0.7900, mean Time to accident= 3.8121
Recall@80%, Time to accident= 4.047
Average Precision= 0.3550, mean Time to accident= 4.2824
Recall@80%, Time to accident= 4.963
Average Precision= 0.5594, mean Time to accident= 4.4810
Recall@80%, Time to accident= 3.907
Average Precision= 0.4359, mean Time to accident= 3.5586
Recall@80%, Time to accident= 3.194
Starting federated DAD training: 5 clients, 6 rounds
Starting server: python federated/server.py --rounds 6 --min-fit-clients 5 --min-available-clients 5 --server-address 127.0.0.1:8080 --local-epochs 7 --input-dim 4096 --embedding-dim 256 --img-feat-dim 2048 --num-classes 2
Starting client 0: python federated/client.py --cid 0 --num-clients 5 --server 127.0.0.1:8080
Starting client 1: python federated/client.py --cid 1 --num-clients 5 --server 127.0.0.1:8080
Starting client 2: python federated/client.py --cid 2 --num-clients 5 --server 127.0.0.1:8080
Starting client 3: python federated/client.py --cid 3 --num-clients 5 --server 127.0.0.1:8080
Starting client 4: python federated/client.py --cid 4 --num-clients 5 --server 127.0.0.1:8080
Federated training completed!
