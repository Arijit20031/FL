nohup: ignoring input
======================================================================
Starting FedProx Training
======================================================================
Clients: 5
Rounds: 6
Local epochs: 7
Proximal coefficient (mu): 0.01
======================================================================
Starting server: python -u federated/server.py --rounds 6 --min-fit-clients 5 --min-available-clients 5 --server-address 127.0.0.1:8080 --local-epochs 7 --input-dim 4096 --embedding-dim 256 --img-feat-dim 2048 --num-classes 2
Starting FedProx client 0 (mu=0.01): python -u federated/client_fedprox.py --cid 0 --server 127.0.0.1:8080 --mu 0.01
Using device: cuda
Server: Using unweighted CrossEntropyLoss
Starting federated server with 6 rounds, 5 clients
INFO flwr 2025-11-10 22:07:53,182 | app.py:163 | Starting Flower server, config: ServerConfig(num_rounds=6, round_timeout=None)
INFO flwr 2025-11-10 22:07:53,186 | app.py:176 | Flower ECE: gRPC server running (6 rounds), SSL is disabled
INFO flwr 2025-11-10 22:07:53,186 | server.py:89 | Initializing global parameters
INFO flwr 2025-11-10 22:07:53,186 | server.py:276 | Requesting initial parameters from one random client
Starting FedProx client 1 (mu=0.01): python -u federated/client_fedprox.py --cid 1 --server 127.0.0.1:8080 --mu 0.01
Using device: cuda
Starting DAD FedProx client 0 with mu=0.01
Client 0: Using FedProx with mu=0.01
Client 0: total=256, train=217, val=39
INFO flwr 2025-11-10 22:07:55,125 | grpc.py:52 | Opened insecure gRPC connection (no certificates were passed)
DEBUG flwr 2025-11-10 22:07:55,125 | connection.py:55 | ChannelConnectivity.IDLE
DEBUG flwr 2025-11-10 22:07:55,126 | connection.py:55 | ChannelConnectivity.CONNECTING
DEBUG flwr 2025-11-10 22:07:55,126 | connection.py:55 | ChannelConnectivity.READY
INFO flwr 2025-11-10 22:07:55,190 | server.py:280 | Received initial parameters from one random client
INFO flwr 2025-11-10 22:07:55,191 | server.py:91 | Evaluating initial parameters
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.4841, 0.6858]
Batch 0: pred_labels unique=[0 1], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.4547, 0.7084]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Starting FedProx client 2 (mu=0.01): python -u federated/client_fedprox.py --cid 2 --server 127.0.0.1:8080 --mu 0.01
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.4606, 0.7736]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Using device: cuda
Starting DAD FedProx client 1 with mu=0.01
Client 1: Using FedProx with mu=0.01
Client 1: total=256, train=217, val=39
INFO flwr 2025-11-10 22:07:57,388 | grpc.py:52 | Opened insecure gRPC connection (no certificates were passed)
DEBUG flwr 2025-11-10 22:07:57,389 | connection.py:55 | ChannelConnectivity.IDLE
DEBUG flwr 2025-11-10 22:07:57,389 | connection.py:55 | ChannelConnectivity.READY
Starting FedProx client 3 (mu=0.01): python -u federated/client_fedprox.py --cid 3 --server 127.0.0.1:8080 --mu 0.01
Using device: cuda
Starting DAD FedProx client 2 with mu=0.01
Starting FedProx client 4 (mu=0.01): python -u federated/client_fedprox.py --cid 4 --server 127.0.0.1:8080 --mu 0.01
Client 2: Using FedProx with mu=0.01
Client 2: total=255, train=216, val=39
INFO flwr 2025-11-10 22:07:59,892 | grpc.py:52 | Opened insecure gRPC connection (no certificates were passed)
DEBUG flwr 2025-11-10 22:07:59,896 | connection.py:55 | ChannelConnectivity.IDLE
DEBUG flwr 2025-11-10 22:07:59,900 | connection.py:55 | ChannelConnectivity.CONNECTING
DEBUG flwr 2025-11-10 22:07:59,900 | connection.py:55 | ChannelConnectivity.READY
Using device: cuda
Starting DAD FedProx client 3 with mu=0.01
Client 3: Using FedProx with mu=0.01
Client 3: total=255, train=216, val=39
INFO flwr 2025-11-10 22:08:01,669 | grpc.py:52 | Opened insecure gRPC connection (no certificates were passed)
DEBUG flwr 2025-11-10 22:08:01,670 | connection.py:55 | ChannelConnectivity.IDLE
DEBUG flwr 2025-11-10 22:08:01,671 | connection.py:55 | ChannelConnectivity.READY
Using device: cuda
Starting DAD FedProx client 4 with mu=0.01
Client 4: Using FedProx with mu=0.01
Client 4: total=255, train=216, val=39
INFO flwr 2025-11-10 22:08:03,663 | grpc.py:52 | Opened insecure gRPC connection (no certificates were passed)
DEBUG flwr 2025-11-10 22:08:03,664 | connection.py:55 | ChannelConnectivity.IDLE
DEBUG flwr 2025-11-10 22:08:03,664 | connection.py:55 | ChannelConnectivity.READY
Average Precision= 0.2961, mean Time to accident= 4.9419
Recall@80%, Time to accident= 4.944

=== SERVER EVALUATION ROUND 0 ===
Confusion Matrix:
[[ 3638 26462]
 [ 1807 14093]]
Class-wise recall: [0.121 0.886]
==================================================
Saved PR curve: results/federated/pr_curve_round_0.png
INFO flwr 2025-11-10 22:08:50,110 | server.py:94 | initial parameters (loss, other metrics): 0.0, {'ap': 0.2960974626332453, 'mtta': 4.941864707078467, 'tta_r80': 4.943569553805775, 'recall_neg': 0.12086378737541528, 'recall_pos': 0.8863522012578616, 'pr_auc_frame': 0.3445584056709552}
INFO flwr 2025-11-10 22:08:50,110 | server.py:104 | FL starting
DEBUG flwr 2025-11-10 22:08:50,110 | server.py:222 | fit_round 1: strategy sampled 5 clients (out of 5)
Client 0: Loaded global parameters for FedProx (mu=0.01)
Client 0: Starting epoch 1/7
Client 2: Loaded global parameters for FedProx (mu=0.01)
Client 2: Starting epoch 1/7
Client 3: Loaded global parameters for FedProx (mu=0.01)
Client 3: Starting epoch 1/7
Client 1: Loaded global parameters for FedProx (mu=0.01)
Client 1: Starting epoch 1/7
Client 4: Loaded global parameters for FedProx (mu=0.01)
Client 4: Starting epoch 1/7
Client 0: Processing batch 0
Client 2: Processing batch 0
Client 3: Processing batch 0
Client 1: Processing batch 0
Client 4: Processing batch 0
Client 0: Processing batch 10
Client 2: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 30
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 2: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 100
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 1: Processing batch 120
Client 2: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Client 2: Processing batch 210
Client 3: Processing batch 210
Average Precision= 0.1620, mean Time to accident= 3.7546
Recall@80%, Time to accident= 3.352
Client 4: Epoch 1 validation AP = 0.1620
Client 4: New best AP = 0.1620, saving checkpoint
Client 4: Starting epoch 2/7
Client 4: Processing batch 0
Average Precision= 0.2642, mean Time to accident= 3.8217
Recall@80%, Time to accident= 3.954
Client 2: Epoch 1 validation AP = 0.2642
Client 2: New best AP = 0.2642, saving checkpoint
Client 2: Starting epoch 2/7
Average Precision= 0.8120, mean Time to accident= 4.1101
Recall@80%, Time to accident= 3.957
Client 0: Epoch 1 validation AP = 0.8120
Client 0: New best AP = 0.8120, saving checkpoint
Client 0: Starting epoch 2/7
Client 2: Processing batch 0
Average Precision= 0.0479, mean Time to accident= 4.0556
Recall@80%, Time to accident= 5.0
Client 3: Epoch 1 validation AP = 0.0479
Client 3: New best AP = 0.0479, saving checkpoint
Client 3: Starting epoch 2/7
Client 0: Processing batch 0
Average Precision= 0.6429, mean Time to accident= 4.5900
Recall@80%, Time to accident= 4.014
Client 1: Epoch 1 validation AP = 0.6429
Client 1: New best AP = 0.6429, saving checkpoint
Client 1: Starting epoch 2/7
Client 3: Processing batch 0
Client 1: Processing batch 0
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 10
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 210
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.1487, mean Time to accident= 3.3252
Recall@80%, Time to accident= 3.87
Client 4: Epoch 2 validation AP = 0.1487
Client 4: Starting epoch 3/7
Client 4: Processing batch 0
Average Precision= 0.3211, mean Time to accident= 3.6939
Recall@80%, Time to accident= 3.889
Client 2: Epoch 2 validation AP = 0.3211
Client 2: New best AP = 0.3211, saving checkpoint
Client 2: Starting epoch 3/7
Client 2: Processing batch 0
Average Precision= 0.5208, mean Time to accident= 4.5273
Recall@80%, Time to accident= 4.544
Client 1: Epoch 2 validation AP = 0.5208
Client 1: Starting epoch 3/7
Client 1: Processing batch 0
Average Precision= 0.2081, mean Time to accident= 4.6204
Recall@80%, Time to accident= 3.917
Client 3: Epoch 2 validation AP = 0.2081
Client 3: New best AP = 0.2081, saving checkpoint
Client 3: Starting epoch 3/7
Client 3: Processing batch 0
Average Precision= 0.8555, mean Time to accident= 4.4505
Recall@80%, Time to accident= 4.459
Client 0: Epoch 2 validation AP = 0.8555
Client 0: New best AP = 0.8555, saving checkpoint
Client 0: Starting epoch 3/7
Client 0: Processing batch 0
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 120
Client 4: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Client 3: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.2416, mean Time to accident= 4.0390
Recall@80%, Time to accident= 4.815
Client 2: Epoch 3 validation AP = 0.2416
Client 2: Starting epoch 4/7
Average Precision= 0.2347, mean Time to accident= 4.5532
Recall@80%, Time to accident= 4.519
Client 4: Epoch 3 validation AP = 0.2347
Client 4: New best AP = 0.2347, saving checkpoint
Client 4: Starting epoch 4/7
Client 2: Processing batch 0
Client 4: Processing batch 0
Average Precision= 0.0905, mean Time to accident= 4.7778
Recall@80%, Time to accident= 4.778
Client 3: Epoch 3 validation AP = 0.0905
Client 3: Starting epoch 4/7
Average Precision= 0.5798, mean Time to accident= 4.6095
Recall@80%, Time to accident= 4.417
Client 1: Epoch 3 validation AP = 0.5798
Client 1: Starting epoch 4/7
Client 3: Processing batch 0
Client 1: Processing batch 0
Average Precision= 0.8016, mean Time to accident= 4.4906
Recall@80%, Time to accident= 4.513
Client 0: Epoch 3 validation AP = 0.8016
Client 0: Starting epoch 4/7
Client 0: Processing batch 0
Client 2: Processing batch 10
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 30
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 40
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 60
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.3870, mean Time to accident= 4.1108
Recall@80%, Time to accident= 4.352
Client 2: Epoch 4 validation AP = 0.3870
Client 2: New best AP = 0.3870, saving checkpoint
Client 2: Starting epoch 5/7
Average Precision= 0.3030, mean Time to accident= 3.7060
Recall@80%, Time to accident= 4.519
Client 4: Epoch 4 validation AP = 0.3030
Client 4: New best AP = 0.3030, saving checkpoint
Client 4: Starting epoch 5/7
Client 2: Processing batch 0
Client 4: Processing batch 0
Average Precision= 0.2012, mean Time to accident= 3.0988
Recall@80%, Time to accident= 2.778
Client 3: Epoch 4 validation AP = 0.2012
Client 3: Starting epoch 5/7
Client 3: Processing batch 0
Average Precision= 0.7164, mean Time to accident= 4.6860
Recall@80%, Time to accident= 4.531
Client 1: Epoch 4 validation AP = 0.7164
Client 1: New best AP = 0.7164, saving checkpoint
Client 1: Starting epoch 5/7
Client 1: Processing batch 0
Average Precision= 0.9023, mean Time to accident= 4.6887
Recall@80%, Time to accident= 4.381
Client 0: Epoch 4 validation AP = 0.9023
Client 0: New best AP = 0.9023, saving checkpoint
Client 0: Starting epoch 5/7
Client 0: Processing batch 0
Client 2: Processing batch 10
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 0: Processing batch 120
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 0: Processing batch 130
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 160
Client 0: Processing batch 150
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 170
Client 0: Processing batch 160
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 180
Client 0: Processing batch 170
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 0: Processing batch 180
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 0: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 210
Client 0: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.1497, mean Time to accident= 4.6285
Recall@80%, Time to accident= 4.611
Client 4: Epoch 5 validation AP = 0.1497
Client 4: Starting epoch 6/7
Client 4: Processing batch 0
Average Precision= 0.3228, mean Time to accident= 3.9516
Recall@80%, Time to accident= 4.324
Client 2: Epoch 5 validation AP = 0.3228
Client 2: Starting epoch 6/7
Client 2: Processing batch 0
Average Precision= 0.2489, mean Time to accident= 4.4352
Recall@80%, Time to accident= 4.417
Client 3: Epoch 5 validation AP = 0.2489
Client 3: New best AP = 0.2489, saving checkpoint
Client 3: Starting epoch 6/7
Client 3: Processing batch 0
Average Precision= 0.6055, mean Time to accident= 3.9046
Recall@80%, Time to accident= 4.092
Client 1: Epoch 5 validation AP = 0.6055
Client 1: Starting epoch 6/7
Client 1: Processing batch 0
Average Precision= 0.8535, mean Time to accident= 4.4993
Recall@80%, Time to accident= 4.385
Client 0: Epoch 5 validation AP = 0.8535
Client 0: Starting epoch 6/7
Client 4: Processing batch 10
Client 0: Processing batch 0
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 20
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 30
Client 0: Processing batch 20
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 0: Processing batch 30
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 50
Client 0: Processing batch 40
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 0: Processing batch 50
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 0: Processing batch 60
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 0: Processing batch 70
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 0: Processing batch 80
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 0: Processing batch 90
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 0: Processing batch 100
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 0: Processing batch 110
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 0: Processing batch 120
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 0: Processing batch 130
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 150
Client 0: Processing batch 140
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 160
Client 0: Processing batch 150
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 0: Processing batch 180
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 0: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 210
Client 0: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.1934, mean Time to accident= 4.4375
Recall@80%, Time to accident= 3.889
Client 4: Epoch 6 validation AP = 0.1934
Client 4: Starting epoch 7/7
Client 4: Processing batch 0
Average Precision= 0.2682, mean Time to accident= 3.0110
Recall@80%, Time to accident= 3.204
Client 2: Epoch 6 validation AP = 0.2682
Client 2: Starting epoch 7/7
Client 2: Processing batch 0
Average Precision= 0.5741, mean Time to accident= 3.9414
Recall@80%, Time to accident= 3.528
Client 3: Epoch 6 validation AP = 0.5741
Client 3: New best AP = 0.5741, saving checkpoint
Client 3: Starting epoch 7/7
Client 3: Processing batch 0
Average Precision= 0.8717, mean Time to accident= 4.4727
Recall@80%, Time to accident= 4.382
Client 0: Epoch 6 validation AP = 0.8717
Client 0: Starting epoch 7/7
Client 4: Processing batch 10
Client 0: Processing batch 0
Average Precision= 0.7015, mean Time to accident= 4.6715
Recall@80%, Time to accident= 4.794
Client 1: Epoch 6 validation AP = 0.7015
Client 1: Starting epoch 7/7
Client 1: Processing batch 0
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 4: Processing batch 20
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 30
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 4: Processing batch 40
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 50
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 60
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 70
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 80
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 90
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 100
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 110
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 120
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 130
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 140
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 150
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 160
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 170
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 180
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 190
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 200
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 210
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.1755, mean Time to accident= 4.9306
Recall@80%, Time to accident= 4.833
Client 4: Epoch 7 validation AP = 0.1755
Client 4: Loaded best model checkpoint with AP = 0.3030
Average Precision= 0.3359, mean Time to accident= 3.7236
Recall@80%, Time to accident= 4.12
Client 2: Epoch 7 validation AP = 0.3359
Client 2: Loaded best model checkpoint with AP = 0.3870
Average Precision= 0.2045, mean Time to accident= 4.7593
Recall@80%, Time to accident= 4.722
Client 3: Epoch 7 validation AP = 0.2045
Client 3: Loaded best model checkpoint with AP = 0.5741
Average Precision= 0.8482, mean Time to accident= 3.9053
Recall@80%, Time to accident= 4.278
Client 0: Epoch 7 validation AP = 0.8482
Client 0: Loaded best model checkpoint with AP = 0.9023
Average Precision= 0.6435, mean Time to accident= 4.2232
Recall@80%, Time to accident= 4.494
Client 1: Epoch 7 validation AP = 0.6435
Client 1: Loaded best model checkpoint with AP = 0.7164
DEBUG flwr 2025-11-11 03:03:32,467 | server.py:236 | fit_round 1 received 5 results and 0 failures
WARNING flwr 2025-11-11 03:03:32,494 | fedavg.py:250 | No fit_metrics_aggregation_fn provided
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0794, 0.4080]
Batch 0: pred_labels unique=[0], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.1263, 0.3491]
Batch 1: pred_labels unique=[0], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.0083, 0.5973]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.4104, mean Time to accident= 2.9960
Recall@80%, Time to accident= 3.091

=== SERVER EVALUATION ROUND 1 ===
Confusion Matrix:
[[30098     2]
 [15887    13]]
Class-wise recall: [1.    0.001]
==================================================
Saved PR curve: results/federated/pr_curve_round_1.png
INFO flwr 2025-11-11 03:04:26,880 | server.py:125 | fit progress: (1, 0.0, {'ap': 0.410395342041238, 'mtta': 2.996025138704172, 'tta_r80': 3.091145833333332, 'recall_neg': 0.9999335548172757, 'recall_pos': 0.0008176100628930818, 'pr_auc_frame': 0.36305287649455814}, 17736.770447927003)
DEBUG flwr 2025-11-11 03:04:26,880 | server.py:173 | evaluate_round 1: strategy sampled 5 clients (out of 5)
Client 0: Loaded global parameters for FedProx (mu=0.01)
Client 2: Loaded global parameters for FedProx (mu=0.01)
Client 1: Loaded global parameters for FedProx (mu=0.01)
Client 4: Loaded global parameters for FedProx (mu=0.01)
Client 3: Loaded global parameters for FedProx (mu=0.01)
Average Precision= 0.7893, mean Time to accident= 4.0646
Recall@80%, Time to accident= 4.111
Average Precision= 0.3372, mean Time to accident= 4.0718
Recall@80%, Time to accident= 3.593
Average Precision= 0.8289, mean Time to accident= 3.3476
Recall@80%, Time to accident= 3.402
Average Precision= 0.1350, mean Time to accident= 4.6204
Recall@80%, Time to accident= 4.972
Average Precision= 0.5985, mean Time to accident= 3.2998
Recall@80%, Time to accident= 3.13
DEBUG flwr 2025-11-11 03:10:48,366 | server.py:187 | evaluate_round 1 received 5 results and 0 failures
WARNING flwr 2025-11-11 03:10:48,366 | fedavg.py:281 | No evaluate_metrics_aggregation_fn provided
DEBUG flwr 2025-11-11 03:10:48,366 | server.py:222 | fit_round 2: strategy sampled 5 clients (out of 5)
Client 1: Loaded global parameters for FedProx (mu=0.01)
Client 1: Starting epoch 1/7
Client 2: Loaded global parameters for FedProx (mu=0.01)
Client 2: Starting epoch 1/7
Client 3: Loaded global parameters for FedProx (mu=0.01)
Client 3: Starting epoch 1/7
Client 0: Loaded global parameters for FedProx (mu=0.01)
Client 0: Starting epoch 1/7
Client 4: Loaded global parameters for FedProx (mu=0.01)
Client 4: Starting epoch 1/7
Client 1: Processing batch 0
Client 3: Processing batch 0
Client 2: Processing batch 0
Client 0: Processing batch 0
Client 4: Processing batch 0
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 4: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 70
Client 2: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 0: Processing batch 80
Client 2: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 1: Processing batch 120
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 130
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 1: Processing batch 140
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 150
Client 1: Processing batch 150
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 160
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.9150, mean Time to accident= 4.5346
Recall@80%, Time to accident= 4.41
Client 0: Epoch 1 validation AP = 0.9150
Client 0: New best AP = 0.9150, saving checkpoint
Client 0: Starting epoch 2/7
Average Precision= 0.2112, mean Time to accident= 2.7346
Recall@80%, Time to accident= 2.056
Client 3: Epoch 1 validation AP = 0.2112
Client 3: New best AP = 0.2112, saving checkpoint
Client 3: Starting epoch 2/7
Average Precision= 0.1248, mean Time to accident= 2.8113
Recall@80%, Time to accident= 2.315
Client 4: Epoch 1 validation AP = 0.1248
Client 4: New best AP = 0.1248, saving checkpoint
Client 4: Starting epoch 2/7
Client 0: Processing batch 0
Client 3: Processing batch 0
Client 4: Processing batch 0
Average Precision= 0.2668, mean Time to accident= 3.0852
Recall@80%, Time to accident= 3.519
Client 2: Epoch 1 validation AP = 0.2668
Client 2: New best AP = 0.2668, saving checkpoint
Client 2: Starting epoch 2/7
Client 2: Processing batch 0
Average Precision= 0.6582, mean Time to accident= 4.3956
Recall@80%, Time to accident= 4.642
Client 1: Epoch 1 validation AP = 0.6582
Client 1: New best AP = 0.6582, saving checkpoint
Client 1: Starting epoch 2/7
Client 1: Processing batch 0
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 10
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 110
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 120
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 130
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 140
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 150
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 160
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 4: Processing batch 210
Client 1: Processing batch 210
Client 2: Processing batch 210
Average Precision= 0.2401, mean Time to accident= 3.9846
Recall@80%, Time to accident= 4.139
Client 3: Epoch 2 validation AP = 0.2401
Client 3: New best AP = 0.2401, saving checkpoint
Client 3: Starting epoch 3/7
Client 3: Processing batch 0
Average Precision= 0.1577, mean Time to accident= 3.2986
Recall@80%, Time to accident= 3.722
Client 4: Epoch 2 validation AP = 0.1577
Client 4: New best AP = 0.1577, saving checkpoint
Client 4: Starting epoch 3/7
Average Precision= 0.9068, mean Time to accident= 4.3190
Recall@80%, Time to accident= 4.87
Client 0: Epoch 2 validation AP = 0.9068
Client 0: Starting epoch 3/7
Client 4: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.2752, mean Time to accident= 3.3388
Recall@80%, Time to accident= 3.556
Client 2: Epoch 2 validation AP = 0.2752
Client 2: New best AP = 0.2752, saving checkpoint
Client 2: Starting epoch 3/7
Average Precision= 0.6761, mean Time to accident= 4.7767
Recall@80%, Time to accident= 4.611
Client 1: Epoch 2 validation AP = 0.6761
Client 1: New best AP = 0.6761, saving checkpoint
Client 1: Starting epoch 3/7
Client 2: Processing batch 0
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 2: Processing batch 210
Average Precision= 0.8462, mean Time to accident= 3.2593
Recall@80%, Time to accident= 4.111
Client 3: Epoch 3 validation AP = 0.8462
Client 3: New best AP = 0.8462, saving checkpoint
Client 3: Starting epoch 4/7
Client 3: Processing batch 0
Average Precision= 0.8263, mean Time to accident= 4.1543
Recall@80%, Time to accident= 4.034
Client 0: Epoch 3 validation AP = 0.8263
Client 0: Starting epoch 4/7
Client 0: Processing batch 0
Average Precision= 0.7450, mean Time to accident= 4.7617
Recall@80%, Time to accident= 4.397
Client 1: Epoch 3 validation AP = 0.7450
Client 1: New best AP = 0.7450, saving checkpoint
Client 1: Starting epoch 4/7
Average Precision= 0.2510, mean Time to accident= 2.7396
Recall@80%, Time to accident= 3.056
Client 4: Epoch 3 validation AP = 0.2510
Client 4: New best AP = 0.2510, saving checkpoint
Client 4: Starting epoch 4/7
Client 1: Processing batch 0
Client 4: Processing batch 0
Average Precision= 0.7008, mean Time to accident= 3.6493
Recall@80%, Time to accident= 4.093
Client 2: Epoch 3 validation AP = 0.7008
Client 2: New best AP = 0.7008, saving checkpoint
Client 2: Starting epoch 4/7
Client 2: Processing batch 0
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 2: Processing batch 210
Average Precision= 0.5962, mean Time to accident= 4.6914
Recall@80%, Time to accident= 4.167
Client 3: Epoch 4 validation AP = 0.5962
Client 3: Starting epoch 5/7
Client 3: Processing batch 0
Average Precision= 0.7846, mean Time to accident= 3.9900
Recall@80%, Time to accident= 3.964
Client 0: Epoch 4 validation AP = 0.7846
Client 0: Starting epoch 5/7
Client 0: Processing batch 0
Average Precision= 0.2039, mean Time to accident= 3.2072
Recall@80%, Time to accident= 4.037
Client 4: Epoch 4 validation AP = 0.2039
Client 4: Starting epoch 5/7
Average Precision= 0.8291, mean Time to accident= 4.5591
Recall@80%, Time to accident= 4.259
Client 2: Epoch 4 validation AP = 0.8291
Client 2: New best AP = 0.8291, saving checkpoint
Client 2: Starting epoch 5/7
Client 4: Processing batch 0
Average Precision= 0.7196, mean Time to accident= 4.6172
Recall@80%, Time to accident= 4.594
Client 1: Epoch 4 validation AP = 0.7196
Client 1: Starting epoch 5/7
Client 2: Processing batch 0
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 4: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 150
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 160
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 170
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 180
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 190
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 200
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Average Precision= 0.6462, mean Time to accident= 4.0463
Recall@80%, Time to accident= 4.194
Client 3: Epoch 5 validation AP = 0.6462
Client 3: Starting epoch 6/7
Client 3: Processing batch 0
Average Precision= 0.8205, mean Time to accident= 4.3756
Recall@80%, Time to accident= 4.079
Client 0: Epoch 5 validation AP = 0.8205
Client 0: Starting epoch 6/7
Client 0: Processing batch 0
Average Precision= 0.7802, mean Time to accident= 4.3739
Recall@80%, Time to accident= 4.361
Average Precision= 0.4892, mean Time to accident= 4.3416
Recall@80%, Time to accident= 4.472
Client 2: Epoch 5 validation AP = 0.4892
Client 2: Starting epoch 6/7
Client 1: Epoch 5 validation AP = 0.7802
Client 1: New best AP = 0.7802, saving checkpoint
Client 1: Starting epoch 6/7
Average Precision= 0.3030, mean Time to accident= 4.2361
Recall@80%, Time to accident= 4.0
Client 4: Epoch 5 validation AP = 0.3030
Client 4: New best AP = 0.3030, saving checkpoint
Client 4: Starting epoch 6/7
Client 2: Processing batch 0
Client 1: Processing batch 0
Client 4: Processing batch 0
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 20
Client 4: Processing batch 10
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 30
Client 4: Processing batch 20
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 4: Processing batch 30
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 50
Client 4: Processing batch 40
Client 0: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 60
Client 1: Processing batch 50
Client 4: Processing batch 50
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 70
Client 1: Processing batch 60
Client 4: Processing batch 60
Client 0: Processing batch 70
Client 2: Processing batch 70
Client 3: Processing batch 80
Client 1: Processing batch 70
Client 4: Processing batch 70
Client 0: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 90
Client 1: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 100
Client 1: Processing batch 90
Client 4: Processing batch 90
Client 0: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 110
Client 1: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 120
Client 1: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 120
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 130
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 150
Client 1: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 150
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 4: Processing batch 160
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 4: Processing batch 170
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 4: Processing batch 180
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 200
Client 1: Processing batch 190
Client 4: Processing batch 190
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 210
Client 1: Processing batch 200
Client 4: Processing batch 200
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Average Precision= 0.5795, mean Time to accident= 4.9475
Recall@80%, Time to accident= 4.917
Client 3: Epoch 6 validation AP = 0.5795
Client 3: Starting epoch 7/7
Client 3: Processing batch 0
Average Precision= 0.6055, mean Time to accident= 4.4228
Recall@80%, Time to accident= 4.269
Client 2: Epoch 6 validation AP = 0.6055
Client 2: Starting epoch 7/7
Client 2: Processing batch 0
Average Precision= 0.7726, mean Time to accident= 4.0733
Recall@80%, Time to accident= 3.791
Client 0: Epoch 6 validation AP = 0.7726
Client 0: Starting epoch 7/7
Client 3: Processing batch 10
Client 0: Processing batch 0
Average Precision= 0.6833, mean Time to accident= 4.7685
Recall@80%, Time to accident= 4.675
Client 1: Epoch 6 validation AP = 0.6833
Client 1: Starting epoch 7/7
Average Precision= 0.4718, mean Time to accident= 3.3171
Recall@80%, Time to accident= 3.407
Client 4: Epoch 6 validation AP = 0.4718
Client 4: New best AP = 0.4718, saving checkpoint
Client 4: Starting epoch 7/7
Client 1: Processing batch 0
Client 4: Processing batch 0
Client 2: Processing batch 10
Client 3: Processing batch 20
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 30
Client 1: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 30
Client 3: Processing batch 40
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 40
Client 3: Processing batch 50
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 50
Client 3: Processing batch 60
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 70
Client 1: Processing batch 60
Client 4: Processing batch 60
Client 2: Processing batch 70
Client 3: Processing batch 80
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 70
Client 2: Processing batch 80
Client 3: Processing batch 90
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 80
Client 2: Processing batch 90
Client 3: Processing batch 100
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 90
Client 2: Processing batch 100
Client 3: Processing batch 110
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 120
Client 1: Processing batch 110
Client 4: Processing batch 110
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 130
Client 1: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 140
Client 1: Processing batch 130
Client 4: Processing batch 130
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 150
Client 1: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 160
Client 1: Processing batch 150
Client 4: Processing batch 150
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 170
Client 1: Processing batch 160
Client 4: Processing batch 160
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 180
Client 1: Processing batch 170
Client 4: Processing batch 170
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 190
Client 1: Processing batch 180
Client 4: Processing batch 180
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 200
Client 1: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 210
Client 1: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Average Precision= 0.2128, mean Time to accident= 3.5185
Recall@80%, Time to accident= 2.556
Client 3: Epoch 7 validation AP = 0.2128
Client 3: Loaded best model checkpoint with AP = 0.8462
Average Precision= 0.8059, mean Time to accident= 3.9783
Recall@80%, Time to accident= 3.744
Client 0: Epoch 7 validation AP = 0.8059
Client 0: Loaded best model checkpoint with AP = 0.9150
Average Precision= 0.7665, mean Time to accident= 4.3542
Recall@80%, Time to accident= 4.35
Client 1: Epoch 7 validation AP = 0.7665
Client 1: Loaded best model checkpoint with AP = 0.7802
Average Precision= 0.3702, mean Time to accident= 4.2622
Recall@80%, Time to accident= 4.185
Client 2: Epoch 7 validation AP = 0.3702
Client 2: Loaded best model checkpoint with AP = 0.8291
Average Precision= 0.3212, mean Time to accident= 4.0625
Recall@80%, Time to accident= 4.5
Client 4: Epoch 7 validation AP = 0.3212
Client 4: Loaded best model checkpoint with AP = 0.4718
DEBUG flwr 2025-11-11 08:05:12,715 | server.py:236 | fit_round 2 received 5 results and 0 failures
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0401, 0.4826]
Batch 0: pred_labels unique=[0], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0430, 0.4027]
Batch 1: pred_labels unique=[0], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.0056, 0.7622]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.4186, mean Time to accident= 3.6114
Recall@80%, Time to accident= 3.707

=== SERVER EVALUATION ROUND 2 ===
Confusion Matrix:
[[29825   275]
 [15569   331]]
Class-wise recall: [0.991 0.021]
==================================================
Saved PR curve: results/federated/pr_curve_round_2.png
INFO flwr 2025-11-11 08:06:07,261 | server.py:125 | fit progress: (2, 0.0, {'ap': 0.4186332856071766, 'mtta': 3.611428645024012, 'tta_r80': 3.7069116360454935, 'recall_neg': 0.9908637873754153, 'recall_pos': 0.020817610062893083, 'pr_auc_frame': 0.3964078896322358}, 35837.15141268604)
DEBUG flwr 2025-11-11 08:06:07,261 | server.py:173 | evaluate_round 2: strategy sampled 5 clients (out of 5)
Client 3: Loaded global parameters for FedProx (mu=0.01)
Client 1: Loaded global parameters for FedProx (mu=0.01)
Client 2: Loaded global parameters for FedProx (mu=0.01)
Client 0: Loaded global parameters for FedProx (mu=0.01)
Client 4: Loaded global parameters for FedProx (mu=0.01)
Average Precision= 0.5170, mean Time to accident= 4.6366
Recall@80%, Time to accident= 4.185
Average Precision= 0.1681, mean Time to accident= 4.9352
Recall@80%, Time to accident= 4.972
Average Precision= 0.4639, mean Time to accident= 4.5185
Recall@80%, Time to accident= 4.074
Average Precision= 0.8755, mean Time to accident= 4.0296
Recall@80%, Time to accident= 3.85
Average Precision= 0.8112, mean Time to accident= 4.1840
Recall@80%, Time to accident= 3.997
DEBUG flwr 2025-11-11 08:12:29,557 | server.py:187 | evaluate_round 2 received 5 results and 0 failures
DEBUG flwr 2025-11-11 08:12:29,557 | server.py:222 | fit_round 3: strategy sampled 5 clients (out of 5)
Client 0: Loaded global parameters for FedProx (mu=0.01)
Client 0: Starting epoch 1/7
Client 1: Loaded global parameters for FedProx (mu=0.01)
Client 1: Starting epoch 1/7
Client 2: Loaded global parameters for FedProx (mu=0.01)
Client 2: Starting epoch 1/7
Client 3: Loaded global parameters for FedProx (mu=0.01)
Client 3: Starting epoch 1/7
Client 4: Loaded global parameters for FedProx (mu=0.01)
Client 4: Starting epoch 1/7
Client 0: Processing batch 0
Client 1: Processing batch 0
Client 2: Processing batch 0
Client 3: Processing batch 0
Client 4: Processing batch 0
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 40
Client 4: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 160
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 210
Client 1: Processing batch 210
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 2: Processing batch 210
Average Precision= 0.2212, mean Time to accident= 3.6736
Recall@80%, Time to accident= 4.222
Client 4: Epoch 1 validation AP = 0.2212
Client 4: New best AP = 0.2212, saving checkpoint
Client 4: Starting epoch 2/7
Average Precision= 0.1239, mean Time to accident= 4.5432
Recall@80%, Time to accident= 3.944
Client 3: Epoch 1 validation AP = 0.1239
Client 3: New best AP = 0.1239, saving checkpoint
Client 3: Starting epoch 2/7
Client 4: Processing batch 0
Average Precision= 0.7240, mean Time to accident= 4.8383
Recall@80%, Time to accident= 4.803
Client 1: Epoch 1 validation AP = 0.7240
Client 1: New best AP = 0.7240, saving checkpoint
Client 1: Starting epoch 2/7
Average Precision= 0.5531, mean Time to accident= 4.2098
Recall@80%, Time to accident= 4.074
Client 2: Epoch 1 validation AP = 0.5531
Client 2: New best AP = 0.5531, saving checkpoint
Client 2: Starting epoch 2/7
Client 3: Processing batch 0
Average Precision= 0.8813, mean Time to accident= 4.7101
Recall@80%, Time to accident= 4.355
Client 0: Epoch 1 validation AP = 0.8813
Client 0: New best AP = 0.8813, saving checkpoint
Client 0: Starting epoch 2/7
Client 1: Processing batch 0
Client 2: Processing batch 0
Client 0: Processing batch 0
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 60
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 70
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 80
Client 4: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 120
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 130
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 140
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 150
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 160
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 170
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 4: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.0783, mean Time to accident= 4.6451
Recall@80%, Time to accident= 4.139
Client 3: Epoch 2 validation AP = 0.0783
Client 3: Starting epoch 3/7
Client 3: Processing batch 0
Average Precision= 0.7042, mean Time to accident= 4.2178
Recall@80%, Time to accident= 3.694
Client 2: Epoch 2 validation AP = 0.7042
Client 2: New best AP = 0.7042, saving checkpoint
Client 2: Starting epoch 3/7
Average Precision= 0.4714, mean Time to accident= 3.3183
Recall@80%, Time to accident= 3.204
Client 4: Epoch 2 validation AP = 0.4714
Client 4: New best AP = 0.4714, saving checkpoint
Client 4: Starting epoch 3/7
Average Precision= 0.7892, mean Time to accident= 4.4545
Recall@80%, Time to accident= 4.468
Client 0: Epoch 2 validation AP = 0.7892
Client 0: Starting epoch 3/7
Client 2: Processing batch 0
Client 4: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.8363, mean Time to accident= 4.5658
Recall@80%, Time to accident= 4.553
Client 1: Epoch 2 validation AP = 0.8363
Client 1: New best AP = 0.8363, saving checkpoint
Client 1: Starting epoch 3/7
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 4: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 4: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.5366, mean Time to accident= 4.3148
Recall@80%, Time to accident= 3.5
Client 3: Epoch 3 validation AP = 0.5366
Client 3: New best AP = 0.5366, saving checkpoint
Client 3: Starting epoch 4/7
Client 3: Processing batch 0
Average Precision= 0.4741, mean Time to accident= 3.7014
Recall@80%, Time to accident= 3.167
Client 4: Epoch 3 validation AP = 0.4741
Client 4: New best AP = 0.4741, saving checkpoint
Client 4: Starting epoch 4/7
Average Precision= 0.5444, mean Time to accident= 4.6001
Recall@80%, Time to accident= 4.241
Client 2: Epoch 3 validation AP = 0.5444
Client 2: Starting epoch 4/7
Average Precision= 0.7848, mean Time to accident= 4.1982
Recall@80%, Time to accident= 4.071
Client 0: Epoch 3 validation AP = 0.7848
Client 0: Starting epoch 4/7
Client 4: Processing batch 0
Client 2: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.7900, mean Time to accident= 4.6812
Recall@80%, Time to accident= 4.533
Client 1: Epoch 3 validation AP = 0.7900
Client 1: Starting epoch 4/7
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.4844, mean Time to accident= 4.5839
Recall@80%, Time to accident= 4.25
Client 2: Epoch 4 validation AP = 0.4844
Client 2: Starting epoch 5/7
Client 2: Processing batch 0
Average Precision= 0.1350, mean Time to accident= 4.4383
Recall@80%, Time to accident= 3.5
Client 3: Epoch 4 validation AP = 0.1350
Client 3: Starting epoch 5/7
Average Precision= 0.6482, mean Time to accident= 4.4606
Recall@80%, Time to accident= 4.481
Client 4: Epoch 4 validation AP = 0.6482
Client 4: New best AP = 0.6482, saving checkpoint
Client 4: Starting epoch 5/7
Client 3: Processing batch 0
Client 4: Processing batch 0
Average Precision= 0.8032, mean Time to accident= 4.3385
Recall@80%, Time to accident= 4.237
Client 0: Epoch 4 validation AP = 0.8032
Client 0: Starting epoch 5/7
Client 0: Processing batch 0
Average Precision= 0.7378, mean Time to accident= 4.7056
Recall@80%, Time to accident= 4.608
Client 1: Epoch 4 validation AP = 0.7378
Client 1: Starting epoch 5/7
Client 2: Processing batch 10
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 30
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 40
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 50
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 4: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.5125, mean Time to accident= 4.2899
Recall@80%, Time to accident= 4.574
Client 2: Epoch 5 validation AP = 0.5125
Client 2: Starting epoch 6/7
Client 2: Processing batch 0
Average Precision= 0.3020, mean Time to accident= 4.1975
Recall@80%, Time to accident= 3.5
Client 3: Epoch 5 validation AP = 0.3020
Client 3: Starting epoch 6/7
Client 3: Processing batch 0
Average Precision= 0.8023, mean Time to accident= 4.4402
Recall@80%, Time to accident= 4.327
Client 0: Epoch 5 validation AP = 0.8023
Client 0: Starting epoch 6/7
Average Precision= 0.8902, mean Time to accident= 3.9132
Recall@80%, Time to accident= 3.778
Client 4: Epoch 5 validation AP = 0.8902
Client 4: New best AP = 0.8902, saving checkpoint
Client 4: Starting epoch 6/7
Client 0: Processing batch 0
Client 4: Processing batch 0
Average Precision= 0.7072, mean Time to accident= 4.6095
Recall@80%, Time to accident= 4.744
Client 1: Epoch 5 validation AP = 0.7072
Client 1: Starting epoch 6/7
Client 1: Processing batch 0
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 120
Client 3: Processing batch 130
Client 1: Processing batch 120
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 130
Client 3: Processing batch 140
Client 1: Processing batch 130
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 140
Client 3: Processing batch 150
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 180
Client 3: Processing batch 190
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 190
Client 3: Processing batch 200
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 200
Client 3: Processing batch 210
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 4: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.1829, mean Time to accident= 3.7840
Recall@80%, Time to accident= 3.333
Client 3: Epoch 6 validation AP = 0.1829
Client 3: Starting epoch 7/7
Client 3: Processing batch 0
Average Precision= 0.5495, mean Time to accident= 4.2937
Recall@80%, Time to accident= 4.389
Client 2: Epoch 6 validation AP = 0.5495
Client 2: Starting epoch 7/7
Client 2: Processing batch 0
Average Precision= 0.8988, mean Time to accident= 3.9479
Recall@80%, Time to accident= 3.389
Client 4: Epoch 6 validation AP = 0.8988
Client 4: New best AP = 0.8988, saving checkpoint
Client 4: Starting epoch 7/7
Average Precision= 0.8304, mean Time to accident= 4.3841
Recall@80%, Time to accident= 4.31
Client 0: Epoch 6 validation AP = 0.8304
Client 0: Starting epoch 7/7
Client 4: Processing batch 0
Client 0: Processing batch 0
Client 3: Processing batch 10
Average Precision= 0.7084, mean Time to accident= 4.6639
Recall@80%, Time to accident= 4.364
Client 1: Epoch 6 validation AP = 0.7084
Client 1: Starting epoch 7/7
Client 2: Processing batch 10
Client 1: Processing batch 0
Client 4: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 10
Client 4: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 20
Client 4: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 50
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 1: Processing batch 140
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 150
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 160
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 1: Processing batch 170
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 200
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.1527, mean Time to accident= 3.5864
Recall@80%, Time to accident= 4.167
Client 3: Epoch 7 validation AP = 0.1527
Client 3: Loaded best model checkpoint with AP = 0.5366
Average Precision= 0.4474, mean Time to accident= 4.4211
Recall@80%, Time to accident= 4.444
Client 2: Epoch 7 validation AP = 0.4474
Client 2: Loaded best model checkpoint with AP = 0.7042
Average Precision= 0.8253, mean Time to accident= 4.0278
Recall@80%, Time to accident= 3.778
Client 4: Epoch 7 validation AP = 0.8253
Client 4: Loaded best model checkpoint with AP = 0.8988
Average Precision= 0.7835, mean Time to accident= 4.3552
Recall@80%, Time to accident= 4.137
Client 0: Epoch 7 validation AP = 0.7835
Client 0: Loaded best model checkpoint with AP = 0.8813
Average Precision= 0.6721, mean Time to accident= 4.4576
Recall@80%, Time to accident= 4.075
Client 1: Epoch 7 validation AP = 0.6721
Client 1: Loaded best model checkpoint with AP = 0.8363
DEBUG flwr 2025-11-11 13:08:11,616 | server.py:236 | fit_round 3 received 5 results and 0 failures
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0192, 0.4028]
Batch 0: pred_labels unique=[0], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0145, 0.6584]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.0004, 0.9390]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.3885, mean Time to accident= 4.2494
Recall@80%, Time to accident= 4.095

=== SERVER EVALUATION ROUND 3 ===
Confusion Matrix:
[[27898  2202]
 [13972  1928]]
Class-wise recall: [0.927 0.121]
==================================================
Saved PR curve: results/federated/pr_curve_round_3.png
INFO flwr 2025-11-11 13:09:06,226 | server.py:125 | fit progress: (3, 0.0, {'ap': 0.388468354429755, 'mtta': 4.249398152326592, 'tta_r80': 4.095363079615048, 'recall_neg': 0.926843853820598, 'recall_pos': 0.12125786163522012, 'pr_auc_frame': 0.405242330109448}, 54016.11653776304)
DEBUG flwr 2025-11-11 13:09:06,226 | server.py:173 | evaluate_round 3: strategy sampled 5 clients (out of 5)
Client 3: Loaded global parameters for FedProx (mu=0.01)
Client 2: Loaded global parameters for FedProx (mu=0.01)
Client 0: Loaded global parameters for FedProx (mu=0.01)
Client 4: Loaded global parameters for FedProx (mu=0.01)
Client 1: Loaded global parameters for FedProx (mu=0.01)
Average Precision= 0.3295, mean Time to accident= 4.7315
Recall@80%, Time to accident= 4.306
Average Precision= 0.7902, mean Time to accident= 4.1717
Recall@80%, Time to accident= 4.128
Average Precision= 0.4592, mean Time to accident= 4.8258
Recall@80%, Time to accident= 4.88
Average Precision= 0.8043, mean Time to accident= 4.4648
Recall@80%, Time to accident= 4.692
Average Precision= 0.4923, mean Time to accident= 4.2106
Recall@80%, Time to accident= 4.037
DEBUG flwr 2025-11-11 13:15:28,856 | server.py:187 | evaluate_round 3 received 5 results and 0 failures
DEBUG flwr 2025-11-11 13:15:28,856 | server.py:222 | fit_round 4: strategy sampled 5 clients (out of 5)
Client 0: Loaded global parameters for FedProx (mu=0.01)
Client 0: Starting epoch 1/7
Client 1: Loaded global parameters for FedProx (mu=0.01)
Client 1: Starting epoch 1/7
Client 3: Loaded global parameters for FedProx (mu=0.01)
Client 3: Starting epoch 1/7
Client 2: Loaded global parameters for FedProx (mu=0.01)
Client 2: Starting epoch 1/7
Client 4: Loaded global parameters for FedProx (mu=0.01)
Client 4: Starting epoch 1/7
Client 0: Processing batch 0
Client 4: Processing batch 0
Client 1: Processing batch 0
Client 3: Processing batch 0
Client 2: Processing batch 0
Client 0: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 0: Processing batch 20
Client 2: Processing batch 20
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 130
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 4: Processing batch 210
Client 1: Processing batch 210
Client 3: Processing batch 210
Average Precision= 0.4424, mean Time to accident= 3.9184
Recall@80%, Time to accident= 4.306
Client 2: Epoch 1 validation AP = 0.4424
Client 2: New best AP = 0.4424, saving checkpoint
Client 2: Starting epoch 2/7
Client 2: Processing batch 0
Average Precision= 0.6795, mean Time to accident= 3.9062
Recall@80%, Time to accident= 3.778
Client 4: Epoch 1 validation AP = 0.6795
Client 4: New best AP = 0.6795, saving checkpoint
Client 4: Starting epoch 2/7
Average Precision= 0.6775, mean Time to accident= 4.6997
Recall@80%, Time to accident= 4.708
Client 1: Epoch 1 validation AP = 0.6775
Client 1: New best AP = 0.6775, saving checkpoint
Client 1: Starting epoch 2/7
Average Precision= 0.7945, mean Time to accident= 4.8093
Recall@80%, Time to accident= 4.782
Client 0: Epoch 1 validation AP = 0.7945
Client 0: New best AP = 0.7945, saving checkpoint
Client 0: Starting epoch 2/7
Client 4: Processing batch 0
Average Precision= 0.0957, mean Time to accident= 4.2377
Recall@80%, Time to accident= 4.306
Client 3: Epoch 1 validation AP = 0.0957
Client 3: New best AP = 0.0957, saving checkpoint
Client 3: Starting epoch 2/7
Client 1: Processing batch 0
Client 0: Processing batch 0
Client 3: Processing batch 0
Client 2: Processing batch 10
Client 4: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 60
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 2: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 80
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 2: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 100
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 140
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 150
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 180
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Average Precision= 0.3683, mean Time to accident= 4.4258
Recall@80%, Time to accident= 4.519
Client 2: Epoch 2 validation AP = 0.3683
Client 2: Starting epoch 3/7
Client 2: Processing batch 0
Average Precision= 0.7885, mean Time to accident= 4.6627
Recall@80%, Time to accident= 4.378
Client 1: Epoch 2 validation AP = 0.7885
Client 1: New best AP = 0.7885, saving checkpoint
Client 1: Starting epoch 3/7
Average Precision= 0.7045, mean Time to accident= 3.4850
Recall@80%, Time to accident= 3.815
Client 4: Epoch 2 validation AP = 0.7045
Client 4: New best AP = 0.7045, saving checkpoint
Client 4: Starting epoch 3/7
Client 1: Processing batch 0
Average Precision= 0.1628, mean Time to accident= 3.5679
Recall@80%, Time to accident= 2.722
Client 3: Epoch 2 validation AP = 0.1628
Client 3: New best AP = 0.1628, saving checkpoint
Client 3: Starting epoch 3/7
Client 4: Processing batch 0
Average Precision= 0.8165, mean Time to accident= 4.4639
Recall@80%, Time to accident= 4.466
Client 0: Epoch 2 validation AP = 0.8165
Client 0: New best AP = 0.8165, saving checkpoint
Client 0: Starting epoch 3/7
Client 3: Processing batch 0
Client 0: Processing batch 0
Client 2: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 120
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 150
Client 4: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 190
Client 0: Processing batch 180
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 200
Client 0: Processing batch 190
Client 4: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 210
Client 0: Processing batch 200
Client 4: Processing batch 210
Client 1: Processing batch 210
Client 3: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.5198, mean Time to accident= 4.4440
Recall@80%, Time to accident= 4.296
Client 2: Epoch 3 validation AP = 0.5198
Client 2: New best AP = 0.5198, saving checkpoint
Client 2: Starting epoch 4/7
Client 2: Processing batch 0
Average Precision= 0.8882, mean Time to accident= 3.8924
Recall@80%, Time to accident= 4.556
Client 4: Epoch 3 validation AP = 0.8882
Client 4: New best AP = 0.8882, saving checkpoint
Client 4: Starting epoch 4/7
Client 4: Processing batch 0
Average Precision= 0.1239, mean Time to accident= 3.6296
Recall@80%, Time to accident= 4.167
Client 3: Epoch 3 validation AP = 0.1239
Client 3: Starting epoch 4/7
Average Precision= 0.7348, mean Time to accident= 4.4262
Recall@80%, Time to accident= 4.453
Client 1: Epoch 3 validation AP = 0.7348
Client 1: Starting epoch 4/7
Client 3: Processing batch 0
Client 1: Processing batch 0
Average Precision= 0.7525, mean Time to accident= 4.3355
Recall@80%, Time to accident= 3.994
Client 0: Epoch 3 validation AP = 0.7525
Client 0: Starting epoch 4/7
Client 2: Processing batch 10
Client 0: Processing batch 0
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 20
Client 0: Processing batch 10
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 30
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 40
Client 0: Processing batch 30
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 0: Processing batch 40
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 60
Client 0: Processing batch 50
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 0: Processing batch 60
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 0: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 0: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 0: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 110
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 120
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 130
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 140
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 150
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 160
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 170
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 180
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 190
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 200
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 210
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.4589, mean Time to accident= 4.6954
Recall@80%, Time to accident= 4.12
Client 2: Epoch 4 validation AP = 0.4589
Client 2: Starting epoch 5/7
Client 2: Processing batch 0
Average Precision= 0.9028, mean Time to accident= 3.5961
Recall@80%, Time to accident= 4.481
Client 4: Epoch 4 validation AP = 0.9028
Client 4: New best AP = 0.9028, saving checkpoint
Client 4: Starting epoch 5/7
Client 4: Processing batch 0
Average Precision= 0.2135, mean Time to accident= 3.9506
Recall@80%, Time to accident= 3.889
Client 3: Epoch 4 validation AP = 0.2135
Client 3: New best AP = 0.2135, saving checkpoint
Client 3: Starting epoch 5/7
Client 3: Processing batch 0
Average Precision= 0.6859, mean Time to accident= 3.8796
Recall@80%, Time to accident= 3.9
Client 1: Epoch 4 validation AP = 0.6859
Client 1: Starting epoch 5/7
Client 2: Processing batch 10
Client 1: Processing batch 0
Average Precision= 0.7922, mean Time to accident= 4.2857
Recall@80%, Time to accident= 3.919
Client 0: Epoch 4 validation AP = 0.7922
Client 0: Starting epoch 5/7
Client 0: Processing batch 0
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 20
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 30
Client 1: Processing batch 20
Client 4: Processing batch 30
Client 0: Processing batch 20
Client 3: Processing batch 30
Client 2: Processing batch 40
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 50
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 60
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 70
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 0: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 0: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 100
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 100
Client 3: Processing batch 110
Client 2: Processing batch 120
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 0: Processing batch 110
Client 3: Processing batch 120
Client 2: Processing batch 130
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 0: Processing batch 120
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 130
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 0: Processing batch 140
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 0: Processing batch 150
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 0: Processing batch 160
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 0: Processing batch 170
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 0: Processing batch 180
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 0: Processing batch 190
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 0: Processing batch 200
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.3568, mean Time to accident= 4.5517
Recall@80%, Time to accident= 4.194
Client 2: Epoch 5 validation AP = 0.3568
Client 2: Starting epoch 6/7
Client 2: Processing batch 0
Average Precision= 0.8878, mean Time to accident= 4.2593
Recall@80%, Time to accident= 4.87
Client 4: Epoch 5 validation AP = 0.8878
Client 4: Starting epoch 6/7
Client 4: Processing batch 0
Average Precision= 0.0803, mean Time to accident= 2.2809
Recall@80%, Time to accident= 2.028
Client 3: Epoch 5 validation AP = 0.0803
Client 3: Starting epoch 6/7
Client 3: Processing batch 0
Average Precision= 0.6487, mean Time to accident= 4.2790
Recall@80%, Time to accident= 4.044
Client 1: Epoch 5 validation AP = 0.6487
Client 1: Starting epoch 6/7
Client 2: Processing batch 10
Client 1: Processing batch 0
Average Precision= 0.7131, mean Time to accident= 3.8742
Recall@80%, Time to accident= 3.803
Client 0: Epoch 5 validation AP = 0.7131
Client 0: Starting epoch 6/7
Client 0: Processing batch 0
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 20
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 30
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 40
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 50
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 60
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 0: Processing batch 60
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 80
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 90
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 100
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 0: Processing batch 100
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 120
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 130
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 140
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 150
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 160
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 170
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 180
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 190
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 200
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 210
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.4834, mean Time to accident= 4.6029
Recall@80%, Time to accident= 4.306
Client 2: Epoch 6 validation AP = 0.4834
Client 2: Starting epoch 7/7
Client 2: Processing batch 0
Average Precision= 0.7420, mean Time to accident= 4.4965
Recall@80%, Time to accident= 4.444
Client 4: Epoch 6 validation AP = 0.7420
Client 4: Starting epoch 7/7
Client 4: Processing batch 0
Average Precision= 0.0712, mean Time to accident= 3.0741
Recall@80%, Time to accident= 2.333
Client 3: Epoch 6 validation AP = 0.0712
Client 3: Starting epoch 7/7
Client 3: Processing batch 0
Client 2: Processing batch 10
Average Precision= 0.6585, mean Time to accident= 4.0791
Recall@80%, Time to accident= 4.108
Client 1: Epoch 6 validation AP = 0.6585
Client 1: Starting epoch 7/7
Client 1: Processing batch 0
Average Precision= 0.7609, mean Time to accident= 4.0623
Recall@80%, Time to accident= 3.684
Client 0: Epoch 6 validation AP = 0.7609
Client 0: Starting epoch 7/7
Client 0: Processing batch 0
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 20
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 30
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 40
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 0: Processing batch 30
Client 3: Processing batch 40
Client 2: Processing batch 50
Client 1: Processing batch 40
Client 4: Processing batch 50
Client 0: Processing batch 40
Client 3: Processing batch 50
Client 2: Processing batch 60
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 0: Processing batch 50
Client 2: Processing batch 70
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 0: Processing batch 60
Client 2: Processing batch 80
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 0: Processing batch 70
Client 2: Processing batch 90
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 0: Processing batch 80
Client 2: Processing batch 100
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 0: Processing batch 90
Client 2: Processing batch 110
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 0: Processing batch 100
Client 2: Processing batch 120
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 0: Processing batch 110
Client 2: Processing batch 130
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 0: Processing batch 120
Client 2: Processing batch 140
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 0: Processing batch 130
Client 2: Processing batch 150
Client 1: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 150
Client 0: Processing batch 140
Client 2: Processing batch 160
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 160
Client 0: Processing batch 150
Client 2: Processing batch 170
Client 1: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 170
Client 0: Processing batch 160
Client 2: Processing batch 180
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 180
Client 0: Processing batch 170
Client 2: Processing batch 190
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.5678, mean Time to accident= 4.1866
Recall@80%, Time to accident= 3.87
Client 2: Epoch 7 validation AP = 0.5678
Client 2: New best AP = 0.5678, saving checkpoint
Client 2: Loaded best model checkpoint with AP = 0.5678
Average Precision= 0.9000, mean Time to accident= 4.2049
Recall@80%, Time to accident= 4.778
Client 4: Epoch 7 validation AP = 0.9000
Client 4: Loaded best model checkpoint with AP = 0.9028
Average Precision= 0.1378, mean Time to accident= 4.4753
Recall@80%, Time to accident= 4.0
Client 3: Epoch 7 validation AP = 0.1378
Client 3: Loaded best model checkpoint with AP = 0.2135
Average Precision= 0.7069, mean Time to accident= 3.6632
Recall@80%, Time to accident= 3.933
Client 1: Epoch 7 validation AP = 0.7069
Client 1: Loaded best model checkpoint with AP = 0.7885
Average Precision= 0.7603, mean Time to accident= 4.1981
Recall@80%, Time to accident= 4.105
Client 0: Epoch 7 validation AP = 0.7603
Client 0: Loaded best model checkpoint with AP = 0.8165
DEBUG flwr 2025-11-11 18:12:02,362 | server.py:236 | fit_round 4 received 5 results and 0 failures
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0076, 0.3918]
Batch 0: pred_labels unique=[0], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0079, 0.8830]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.0002, 0.9548]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.4092, mean Time to accident= 4.3110
Recall@80%, Time to accident= 4.24

=== SERVER EVALUATION ROUND 4 ===
Confusion Matrix:
[[26994  3106]
 [13092  2808]]
Class-wise recall: [0.897 0.177]
==================================================
Saved PR curve: results/federated/pr_curve_round_4.png
INFO flwr 2025-11-11 18:12:57,045 | server.py:125 | fit progress: (4, 0.0, {'ap': 0.4092433250578687, 'mtta': 4.31099666540108, 'tta_r80': 4.240157480314961, 'recall_neg': 0.8968106312292359, 'recall_pos': 0.17660377358490567, 'pr_auc_frame': 0.4154591029842286}, 72246.93555512105)
DEBUG flwr 2025-11-11 18:12:57,045 | server.py:173 | evaluate_round 4: strategy sampled 5 clients (out of 5)
Client 0: Loaded global parameters for FedProx (mu=0.01)
Client 4: Loaded global parameters for FedProx (mu=0.01)
Client 3: Loaded global parameters for FedProx (mu=0.01)
Client 1: Loaded global parameters for FedProx (mu=0.01)
Client 2: Loaded global parameters for FedProx (mu=0.01)
Average Precision= 0.7997, mean Time to accident= 4.4882
Recall@80%, Time to accident= 4.126
Average Precision= 0.8375, mean Time to accident= 4.7034
Recall@80%, Time to accident= 4.656
Average Precision= 0.7893, mean Time to accident= 4.1956
Recall@80%, Time to accident= 3.852
Average Precision= 0.5377, mean Time to accident= 4.8845
Recall@80%, Time to accident= 4.824
Average Precision= 0.7361, mean Time to accident= 4.7562
Recall@80%, Time to accident= 4.361
DEBUG flwr 2025-11-11 18:19:22,744 | server.py:187 | evaluate_round 4 received 5 results and 0 failures
DEBUG flwr 2025-11-11 18:19:22,744 | server.py:222 | fit_round 5: strategy sampled 5 clients (out of 5)
Client 2: Loaded global parameters for FedProx (mu=0.01)
Client 2: Starting epoch 1/7
Client 3: Loaded global parameters for FedProx (mu=0.01)
Client 3: Starting epoch 1/7
Client 0: Loaded global parameters for FedProx (mu=0.01)
Client 0: Starting epoch 1/7
Client 1: Loaded global parameters for FedProx (mu=0.01)
Client 1: Starting epoch 1/7
Client 4: Loaded global parameters for FedProx (mu=0.01)
Client 4: Starting epoch 1/7
Client 2: Processing batch 0
Client 3: Processing batch 0
Client 1: Processing batch 0
Client 0: Processing batch 0
Client 4: Processing batch 0
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.5244, mean Time to accident= 4.3644
Recall@80%, Time to accident= 3.667
Client 2: Epoch 1 validation AP = 0.5244
Client 2: New best AP = 0.5244, saving checkpoint
Client 2: Starting epoch 2/7
Average Precision= 0.7782, mean Time to accident= 4.4557
Recall@80%, Time to accident= 4.468
Client 0: Epoch 1 validation AP = 0.7782
Client 0: New best AP = 0.7782, saving checkpoint
Client 0: Starting epoch 2/7
Average Precision= 0.1208, mean Time to accident= 1.8981
Recall@80%, Time to accident= 1.361
Client 3: Epoch 1 validation AP = 0.1208
Client 3: New best AP = 0.1208, saving checkpoint
Client 3: Starting epoch 2/7
Average Precision= 0.8902, mean Time to accident= 4.1794
Recall@80%, Time to accident= 4.259
Client 4: Epoch 1 validation AP = 0.8902
Client 4: New best AP = 0.8902, saving checkpoint
Client 4: Starting epoch 2/7
Client 2: Processing batch 0
Client 0: Processing batch 0
Client 3: Processing batch 0
Client 4: Processing batch 0
Average Precision= 0.7368, mean Time to accident= 4.6716
Recall@80%, Time to accident= 4.847
Client 1: Epoch 1 validation AP = 0.7368
Client 1: New best AP = 0.7368, saving checkpoint
Client 1: Starting epoch 2/7
Client 1: Processing batch 0
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 4: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.4597, mean Time to accident= 4.3305
Recall@80%, Time to accident= 3.676
Client 2: Epoch 2 validation AP = 0.4597
Client 2: Starting epoch 3/7
Client 2: Processing batch 0
Average Precision= 0.1033, mean Time to accident= 2.8920
Recall@80%, Time to accident= 4.083
Client 3: Epoch 2 validation AP = 0.1033
Client 3: Starting epoch 3/7
Client 3: Processing batch 0
Average Precision= 0.7743, mean Time to accident= 4.4298
Recall@80%, Time to accident= 4.393
Client 0: Epoch 2 validation AP = 0.7743
Client 0: Starting epoch 3/7
Average Precision= 0.8935, mean Time to accident= 3.5243
Recall@80%, Time to accident= 4.389
Client 4: Epoch 2 validation AP = 0.8935
Client 4: New best AP = 0.8935, saving checkpoint
Client 4: Starting epoch 3/7
Client 0: Processing batch 0
Client 4: Processing batch 0
Average Precision= 0.7606, mean Time to accident= 4.5482
Recall@80%, Time to accident= 4.65
Client 1: Epoch 2 validation AP = 0.7606
Client 1: New best AP = 0.7606, saving checkpoint
Client 1: Starting epoch 3/7
Client 2: Processing batch 10
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 1: Processing batch 10
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 30
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 40
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 50
Client 1: Processing batch 40
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 60
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 70
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 120
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 130
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 190
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 200
Client 1: Processing batch 190
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 210
Client 1: Processing batch 200
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.5095, mean Time to accident= 4.3505
Recall@80%, Time to accident= 4.194
Client 2: Epoch 3 validation AP = 0.5095
Client 2: Starting epoch 4/7
Client 2: Processing batch 0
Average Precision= 0.8878, mean Time to accident= 3.5509
Recall@80%, Time to accident= 4.87
Client 4: Epoch 3 validation AP = 0.8878
Client 4: Starting epoch 4/7
Client 4: Processing batch 0
Average Precision= 0.0987, mean Time to accident= 2.7253
Recall@80%, Time to accident= 3.472
Client 3: Epoch 3 validation AP = 0.0987
Client 3: Starting epoch 4/7
Client 3: Processing batch 0
Average Precision= 0.7429, mean Time to accident= 4.3846
Recall@80%, Time to accident= 4.239
Client 0: Epoch 3 validation AP = 0.7429
Client 0: Starting epoch 4/7
Client 0: Processing batch 0
Client 2: Processing batch 10
Average Precision= 0.6819, mean Time to accident= 4.3745
Recall@80%, Time to accident= 4.347
Client 1: Epoch 3 validation AP = 0.6819
Client 1: Starting epoch 4/7
Client 1: Processing batch 0
Client 4: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 1: Processing batch 10
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 30
Client 1: Processing batch 20
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 40
Client 1: Processing batch 30
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 50
Client 1: Processing batch 40
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 60
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 70
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 80
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 90
Client 1: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 100
Client 1: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 110
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 120
Client 1: Processing batch 110
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 150
Client 4: Processing batch 150
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 210
Client 4: Processing batch 210
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.3866, mean Time to accident= 4.6488
Recall@80%, Time to accident= 4.407
Client 2: Epoch 4 validation AP = 0.3866
Client 2: Starting epoch 5/7
Average Precision= 0.9000, mean Time to accident= 3.6123
Recall@80%, Time to accident= 4.019
Client 4: Epoch 4 validation AP = 0.9000
Client 4: New best AP = 0.9000, saving checkpoint
Client 4: Starting epoch 5/7
Client 2: Processing batch 0
Client 4: Processing batch 0
Average Precision= 0.0861, mean Time to accident= 3.8704
Recall@80%, Time to accident= 4.222
Client 3: Epoch 4 validation AP = 0.0861
Client 3: Starting epoch 5/7
Client 3: Processing batch 0
Average Precision= 0.7493, mean Time to accident= 3.9709
Recall@80%, Time to accident= 3.704
Client 0: Epoch 4 validation AP = 0.7493
Client 0: Starting epoch 5/7
Client 0: Processing batch 0
Client 2: Processing batch 10
Client 4: Processing batch 10
Average Precision= 0.7317, mean Time to accident= 4.2144
Recall@80%, Time to accident= 4.158
Client 1: Epoch 4 validation AP = 0.7317
Client 1: Starting epoch 5/7
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 2: Processing batch 30
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 40
Client 4: Processing batch 40
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 70
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 1: Processing batch 90
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 120
Client 4: Processing batch 120
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 150
Client 4: Processing batch 150
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 160
Client 0: Processing batch 170
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 170
Client 0: Processing batch 180
Client 2: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 200
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 190
Client 0: Processing batch 200
Client 2: Processing batch 210
Client 4: Processing batch 210
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.5066, mean Time to accident= 4.5532
Recall@80%, Time to accident= 4.213
Client 2: Epoch 5 validation AP = 0.5066
Client 2: Starting epoch 6/7
Client 2: Processing batch 0
Average Precision= 0.9000, mean Time to accident= 3.6991
Recall@80%, Time to accident= 4.796
Client 4: Epoch 5 validation AP = 0.9000
Client 4: Starting epoch 6/7
Client 4: Processing batch 0
Average Precision= 0.0725, mean Time to accident= 2.3981
Recall@80%, Time to accident= 3.583
Client 3: Epoch 5 validation AP = 0.0725
Client 3: Starting epoch 6/7
Client 3: Processing batch 0
Average Precision= 0.7531, mean Time to accident= 4.0690
Recall@80%, Time to accident= 3.552
Client 0: Epoch 5 validation AP = 0.7531
Client 0: Starting epoch 6/7
Client 0: Processing batch 0
Client 2: Processing batch 10
Client 4: Processing batch 10
Client 3: Processing batch 10
Average Precision= 0.6924, mean Time to accident= 4.2885
Recall@80%, Time to accident= 3.931
Client 1: Epoch 5 validation AP = 0.6924
Client 1: Starting epoch 6/7
Client 1: Processing batch 0
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 10
Client 0: Processing batch 20
Client 2: Processing batch 30
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 20
Client 0: Processing batch 30
Client 2: Processing batch 40
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 30
Client 0: Processing batch 40
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 40
Client 0: Processing batch 50
Client 2: Processing batch 60
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 50
Client 0: Processing batch 60
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 60
Client 0: Processing batch 70
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 1: Processing batch 70
Client 0: Processing batch 80
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 80
Client 0: Processing batch 90
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 90
Client 0: Processing batch 100
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 1: Processing batch 100
Client 0: Processing batch 110
Client 2: Processing batch 120
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 110
Client 0: Processing batch 120
Client 2: Processing batch 130
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 120
Client 0: Processing batch 130
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 130
Client 0: Processing batch 140
Client 2: Processing batch 150
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 140
Client 0: Processing batch 150
Client 2: Processing batch 160
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 150
Client 0: Processing batch 160
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 160
Client 0: Processing batch 170
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 170
Client 0: Processing batch 180
Client 2: Processing batch 190
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 180
Client 0: Processing batch 190
Client 2: Processing batch 200
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 190
Client 0: Processing batch 200
Client 2: Processing batch 210
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 200
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.4746, mean Time to accident= 4.5599
Recall@80%, Time to accident= 4.167
Client 2: Epoch 6 validation AP = 0.4746
Client 2: Starting epoch 7/7
Client 2: Processing batch 0
Average Precision= 0.8325, mean Time to accident= 3.9097
Recall@80%, Time to accident= 4.611
Client 4: Epoch 6 validation AP = 0.8325
Client 4: Starting epoch 7/7
Client 4: Processing batch 0
Average Precision= 0.0931, mean Time to accident= 2.9105
Recall@80%, Time to accident= 4.083
Client 3: Epoch 6 validation AP = 0.0931
Client 3: Starting epoch 7/7
Client 3: Processing batch 0
Average Precision= 0.8109, mean Time to accident= 4.0563
Recall@80%, Time to accident= 4.091
Client 0: Epoch 6 validation AP = 0.8109
Client 0: New best AP = 0.8109, saving checkpoint
Client 0: Starting epoch 7/7
Client 2: Processing batch 10
Client 0: Processing batch 0
Client 4: Processing batch 10
Average Precision= 0.7108, mean Time to accident= 4.0667
Recall@80%, Time to accident= 3.731
Client 1: Epoch 6 validation AP = 0.7108
Client 1: Starting epoch 7/7
Client 3: Processing batch 10
Client 1: Processing batch 0
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 4: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 10
Client 2: Processing batch 30
Client 0: Processing batch 20
Client 4: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 20
Client 2: Processing batch 40
Client 0: Processing batch 30
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 30
Client 2: Processing batch 50
Client 0: Processing batch 40
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 40
Client 2: Processing batch 60
Client 0: Processing batch 50
Client 4: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 50
Client 2: Processing batch 70
Client 0: Processing batch 60
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 60
Client 2: Processing batch 80
Client 0: Processing batch 70
Client 4: Processing batch 80
Client 3: Processing batch 80
Client 1: Processing batch 70
Client 2: Processing batch 90
Client 0: Processing batch 80
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 80
Client 2: Processing batch 100
Client 0: Processing batch 90
Client 4: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 90
Client 2: Processing batch 110
Client 0: Processing batch 100
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 1: Processing batch 100
Client 2: Processing batch 120
Client 0: Processing batch 110
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 110
Client 2: Processing batch 130
Client 0: Processing batch 120
Client 4: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 120
Client 2: Processing batch 140
Client 0: Processing batch 130
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 130
Client 2: Processing batch 150
Client 0: Processing batch 140
Client 4: Processing batch 150
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 2: Processing batch 160
Client 0: Processing batch 150
Client 4: Processing batch 160
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 2: Processing batch 170
Client 0: Processing batch 160
Client 4: Processing batch 170
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 2: Processing batch 190
Client 0: Processing batch 180
Client 4: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 180
Client 2: Processing batch 200
Client 0: Processing batch 190
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 190
Client 2: Processing batch 210
Client 0: Processing batch 200
Client 4: Processing batch 210
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.4742, mean Time to accident= 4.4951
Recall@80%, Time to accident= 4.241
Client 2: Epoch 7 validation AP = 0.4742
Client 2: Loaded best model checkpoint with AP = 0.5244
Average Precision= 0.8917, mean Time to accident= 3.3947
Recall@80%, Time to accident= 4.426
Client 4: Epoch 7 validation AP = 0.8917
Client 4: Loaded best model checkpoint with AP = 0.9000
Average Precision= 0.0658, mean Time to accident= 3.3549
Recall@80%, Time to accident= 4.139
Client 3: Epoch 7 validation AP = 0.0658
Client 3: Loaded best model checkpoint with AP = 0.1208
Average Precision= 0.7004, mean Time to accident= 4.1560
Recall@80%, Time to accident= 3.504
Client 0: Epoch 7 validation AP = 0.7004
Client 0: Loaded best model checkpoint with AP = 0.8109
Average Precision= 0.6845, mean Time to accident= 4.2984
Recall@80%, Time to accident= 4.067
Client 1: Epoch 7 validation AP = 0.6845
Client 1: Loaded best model checkpoint with AP = 0.7606
DEBUG flwr 2025-11-11 23:14:25,456 | server.py:236 | fit_round 5 received 5 results and 0 failures
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0030, 0.4504]
Batch 0: pred_labels unique=[0], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0068, 0.9613]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.0001, 0.9946]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.4266, mean Time to accident= 3.9918
Recall@80%, Time to accident= 4.139

=== SERVER EVALUATION ROUND 5 ===
Confusion Matrix:
[[26455  3645]
 [12615  3285]]
Class-wise recall: [0.879 0.207]
==================================================
Saved PR curve: results/federated/pr_curve_round_5.png
INFO flwr 2025-11-11 23:15:20,383 | server.py:125 | fit progress: (5, 0.0, {'ap': 0.4265556875661972, 'mtta': 3.99179656403166, 'tta_r80': 4.139107611548557, 'recall_neg': 0.8789036544850498, 'recall_pos': 0.20660377358490567, 'pr_auc_frame': 0.422043363569444}, 90390.27320826304)
DEBUG flwr 2025-11-11 23:15:20,383 | server.py:173 | evaluate_round 5: strategy sampled 5 clients (out of 5)
Client 4: Loaded global parameters for FedProx (mu=0.01)
Client 0: Loaded global parameters for FedProx (mu=0.01)
Client 1: Loaded global parameters for FedProx (mu=0.01)
Client 3: Loaded global parameters for FedProx (mu=0.01)
Client 2: Loaded global parameters for FedProx (mu=0.01)
Average Precision= 0.8889, mean Time to accident= 3.6771
Recall@80%, Time to accident= 3.611
Average Precision= 0.7667, mean Time to accident= 4.1798
Recall@80%, Time to accident= 4.141
Average Precision= 0.4306, mean Time to accident= 4.6049
Recall@80%, Time to accident= 4.333
Average Precision= 0.5350, mean Time to accident= 4.8293
Recall@80%, Time to accident= 4.944
Average Precision= 0.8543, mean Time to accident= 4.3595
Recall@80%, Time to accident= 4.372
DEBUG flwr 2025-11-11 23:21:45,892 | server.py:187 | evaluate_round 5 received 5 results and 0 failures
DEBUG flwr 2025-11-11 23:21:45,892 | server.py:222 | fit_round 6: strategy sampled 5 clients (out of 5)
Client 3: Loaded global parameters for FedProx (mu=0.01)
Client 3: Starting epoch 1/7
Client 2: Loaded global parameters for FedProx (mu=0.01)
Client 2: Starting epoch 1/7
Client 4: Loaded global parameters for FedProx (mu=0.01)
Client 4: Starting epoch 1/7
Client 0: Loaded global parameters for FedProx (mu=0.01)
Client 0: Starting epoch 1/7
Client 1: Loaded global parameters for FedProx (mu=0.01)
Client 1: Starting epoch 1/7
Client 3: Processing batch 0
Client 1: Processing batch 0
Client 0: Processing batch 0
Client 2: Processing batch 0
Client 4: Processing batch 0
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 10
Client 4: Processing batch 10
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 1: Processing batch 100
Client 0: Processing batch 110
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 120
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.1238, mean Time to accident= 4.0123
Recall@80%, Time to accident= 4.278
Client 3: Epoch 1 validation AP = 0.1238
Client 3: New best AP = 0.1238, saving checkpoint
Client 3: Starting epoch 2/7
Client 3: Processing batch 0
Average Precision= 0.4685, mean Time to accident= 4.0456
Recall@80%, Time to accident= 3.38
Client 2: Epoch 1 validation AP = 0.4685
Client 2: New best AP = 0.4685, saving checkpoint
Client 2: Starting epoch 2/7
Average Precision= 0.8958, mean Time to accident= 3.7755
Recall@80%, Time to accident= 4.185
Client 4: Epoch 1 validation AP = 0.8958
Client 4: New best AP = 0.8958, saving checkpoint
Client 4: Starting epoch 2/7
Client 2: Processing batch 0
Client 4: Processing batch 0
Average Precision= 0.7644, mean Time to accident= 4.3904
Recall@80%, Time to accident= 4.308
Client 0: Epoch 1 validation AP = 0.7644
Client 0: New best AP = 0.7644, saving checkpoint
Client 0: Starting epoch 2/7
Client 0: Processing batch 0
Average Precision= 0.7107, mean Time to accident= 4.7854
Recall@80%, Time to accident= 4.769
Client 1: Epoch 1 validation AP = 0.7107
Client 1: New best AP = 0.7107, saving checkpoint
Client 1: Starting epoch 2/7
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 4: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.0953, mean Time to accident= 3.8920
Recall@80%, Time to accident= 4.417
Client 3: Epoch 2 validation AP = 0.0953
Client 3: Starting epoch 3/7
Average Precision= 0.4433, mean Time to accident= 4.2701
Recall@80%, Time to accident= 3.944
Client 2: Epoch 2 validation AP = 0.4433
Client 2: Starting epoch 3/7
Average Precision= 0.8977, mean Time to accident= 3.3333
Recall@80%, Time to accident= 3.833
Client 4: Epoch 2 validation AP = 0.8977
Client 4: New best AP = 0.8977, saving checkpoint
Client 4: Starting epoch 3/7
Client 3: Processing batch 0
Client 2: Processing batch 0
Client 4: Processing batch 0
Average Precision= 0.7832, mean Time to accident= 4.3106
Recall@80%, Time to accident= 3.985
Client 0: Epoch 2 validation AP = 0.7832
Client 0: New best AP = 0.7832, saving checkpoint
Client 0: Starting epoch 3/7
Client 0: Processing batch 0
Average Precision= 0.7122, mean Time to accident= 4.7165
Recall@80%, Time to accident= 4.892
Client 1: Epoch 2 validation AP = 0.7122
Client 1: New best AP = 0.7122, saving checkpoint
Client 1: Starting epoch 3/7
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 4: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 4: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 4: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.0523, mean Time to accident= 3.3858
Recall@80%, Time to accident= 4.139
Client 3: Epoch 3 validation AP = 0.0523
Client 3: Starting epoch 4/7
Client 3: Processing batch 0
Average Precision= 0.5614, mean Time to accident= 4.7414
Recall@80%, Time to accident= 4.657
Client 2: Epoch 3 validation AP = 0.5614
Client 2: New best AP = 0.5614, saving checkpoint
Client 2: Starting epoch 4/7
Average Precision= 0.9062, mean Time to accident= 3.6262
Recall@80%, Time to accident= 3.963
Client 4: Epoch 3 validation AP = 0.9062
Client 4: New best AP = 0.9062, saving checkpoint
Client 4: Starting epoch 4/7
Client 2: Processing batch 0
Client 4: Processing batch 0
Average Precision= 0.7043, mean Time to accident= 4.4250
Recall@80%, Time to accident= 4.15
Client 1: Epoch 3 validation AP = 0.7043
Client 1: Starting epoch 4/7
Average Precision= 0.7672, mean Time to accident= 4.3819
Recall@80%, Time to accident= 4.184
Client 0: Epoch 3 validation AP = 0.7672
Client 0: Starting epoch 4/7
Client 0: Processing batch 0
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 4: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.0597, mean Time to accident= 2.1173
Recall@80%, Time to accident= 1.944
Client 3: Epoch 4 validation AP = 0.0597
Client 3: Starting epoch 5/7
Client 3: Processing batch 0
Average Precision= 0.8878, mean Time to accident= 3.7951
Recall@80%, Time to accident= 3.889
Client 4: Epoch 4 validation AP = 0.8878
Client 4: Starting epoch 5/7
Average Precision= 0.4341, mean Time to accident= 4.5340
Recall@80%, Time to accident= 3.898
Client 2: Epoch 4 validation AP = 0.4341
Client 2: Starting epoch 5/7
Client 4: Processing batch 0
Client 2: Processing batch 0
Average Precision= 0.7750, mean Time to accident= 4.2942
Recall@80%, Time to accident= 4.265
Client 0: Epoch 4 validation AP = 0.7750
Client 0: Starting epoch 5/7
Average Precision= 0.6938, mean Time to accident= 4.4579
Recall@80%, Time to accident= 4.019
Client 1: Epoch 4 validation AP = 0.6938
Client 1: Starting epoch 5/7
Client 0: Processing batch 0
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.0561, mean Time to accident= 2.9815
Recall@80%, Time to accident= 3.222
Client 3: Epoch 5 validation AP = 0.0561
Client 3: Starting epoch 6/7
Client 3: Processing batch 0
Average Precision= 0.8878, mean Time to accident= 3.4722
Recall@80%, Time to accident= 4.167
Client 4: Epoch 5 validation AP = 0.8878
Client 4: Starting epoch 6/7
Average Precision= 0.4567, mean Time to accident= 4.4405
Recall@80%, Time to accident= 4.213
Client 2: Epoch 5 validation AP = 0.4567
Client 2: Starting epoch 6/7
Client 4: Processing batch 0
Client 2: Processing batch 0
Average Precision= 0.7483, mean Time to accident= 4.1781
Recall@80%, Time to accident= 3.996
Client 0: Epoch 5 validation AP = 0.7483
Client 0: Starting epoch 6/7
Client 0: Processing batch 0
Average Precision= 0.6766, mean Time to accident= 4.3792
Recall@80%, Time to accident= 3.894
Client 1: Epoch 5 validation AP = 0.6766
Client 1: Starting epoch 6/7
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 80
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 140
Client 1: Processing batch 130
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 210
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Average Precision= 0.0623, mean Time to accident= 3.1049
Recall@80%, Time to accident= 4.111
Client 3: Epoch 6 validation AP = 0.0623
Client 3: Starting epoch 7/7
Client 3: Processing batch 0
Average Precision= 0.9083, mean Time to accident= 3.3009
Recall@80%, Time to accident= 4.148
Client 4: Epoch 6 validation AP = 0.9083
Client 4: New best AP = 0.9083, saving checkpoint
Client 4: Starting epoch 7/7
Client 4: Processing batch 0
Average Precision= 0.4427, mean Time to accident= 4.2789
Recall@80%, Time to accident= 3.954
Client 2: Epoch 6 validation AP = 0.4427
Client 2: Starting epoch 7/7
Client 2: Processing batch 0
Average Precision= 0.8010, mean Time to accident= 4.3055
Recall@80%, Time to accident= 4.137
Client 0: Epoch 6 validation AP = 0.8010
Client 0: New best AP = 0.8010, saving checkpoint
Client 0: Starting epoch 7/7
Client 0: Processing batch 0
Client 3: Processing batch 10
Average Precision= 0.7091, mean Time to accident= 4.5024
Recall@80%, Time to accident= 4.474
Client 1: Epoch 6 validation AP = 0.7091
Client 1: Starting epoch 7/7
Client 4: Processing batch 10
Client 1: Processing batch 0
Client 2: Processing batch 10
Client 3: Processing batch 20
Client 0: Processing batch 10
Client 4: Processing batch 20
Client 1: Processing batch 10
Client 2: Processing batch 20
Client 3: Processing batch 30
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 40
Client 0: Processing batch 30
Client 4: Processing batch 40
Client 1: Processing batch 30
Client 2: Processing batch 40
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 3: Processing batch 60
Client 1: Processing batch 50
Client 4: Processing batch 60
Client 0: Processing batch 50
Client 2: Processing batch 60
Client 3: Processing batch 70
Client 1: Processing batch 60
Client 4: Processing batch 70
Client 0: Processing batch 60
Client 2: Processing batch 70
Client 3: Processing batch 80
Client 1: Processing batch 70
Client 4: Processing batch 80
Client 0: Processing batch 70
Client 2: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 80
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 90
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 100
Client 4: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 110
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 120
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 130
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 140
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 150
Client 4: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 0: Processing batch 160
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 0: Processing batch 170
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 0: Processing batch 180
Client 2: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 0: Processing batch 190
Client 2: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 0: Processing batch 200
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Client 0: Processing batch 210
Average Precision= 0.0632, mean Time to accident= 2.9074
Recall@80%, Time to accident= 4.222
Client 3: Epoch 7 validation AP = 0.0632
Client 3: Loaded best model checkpoint with AP = 0.1238
Average Precision= 0.9107, mean Time to accident= 3.1331
Recall@80%, Time to accident= 4.074
Client 4: Epoch 7 validation AP = 0.9107
Client 4: New best AP = 0.9107, saving checkpoint
Client 4: Loaded best model checkpoint with AP = 0.9107
Average Precision= 0.4474, mean Time to accident= 4.3947
Recall@80%, Time to accident= 4.204
Client 2: Epoch 7 validation AP = 0.4474
Client 2: Loaded best model checkpoint with AP = 0.5614
Average Precision= 0.7121, mean Time to accident= 4.3815
Recall@80%, Time to accident= 4.095
Client 1: Epoch 7 validation AP = 0.7121
Client 1: Loaded best model checkpoint with AP = 0.7122
Average Precision= 0.8165, mean Time to accident= 4.2419
Recall@80%, Time to accident= 3.987
Client 0: Epoch 7 validation AP = 0.8165
Client 0: New best AP = 0.8165, saving checkpoint
Client 0: Loaded best model checkpoint with AP = 0.8165
DEBUG flwr 2025-11-12 04:16:12,295 | server.py:236 | fit_round 6 received 5 results and 0 failures
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0013, 0.4441]
Batch 0: pred_labels unique=[0], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0038, 0.9715]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.0000, 0.9945]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.4499, mean Time to accident= 3.9105
Recall@80%, Time to accident= 4.032

=== SERVER EVALUATION ROUND 6 ===
Confusion Matrix:
[[26862  3238]
 [12868  3032]]
Class-wise recall: [0.892 0.191]
==================================================
Saved PR curve: results/federated/pr_curve_round_6.png
INFO flwr 2025-11-12 04:17:07,376 | server.py:125 | fit progress: (6, 0.0, {'ap': 0.44992954739042884, 'mtta': 3.9105113431355853, 'tta_r80': 4.032370953630796, 'recall_neg': 0.8924252491694352, 'recall_pos': 0.19069182389937106, 'pr_auc_frame': 0.42563491316596175}, 108497.26615151402)
DEBUG flwr 2025-11-12 04:17:07,376 | server.py:173 | evaluate_round 6: strategy sampled 5 clients (out of 5)
Client 2: Loaded global parameters for FedProx (mu=0.01)
Client 4: Loaded global parameters for FedProx (mu=0.01)
Client 0: Loaded global parameters for FedProx (mu=0.01)
Client 1: Loaded global parameters for FedProx (mu=0.01)
Client 3: Loaded global parameters for FedProx (mu=0.01)
Average Precision= 0.5203, mean Time to accident= 4.7428
Recall@80%, Time to accident= 4.722
Average Precision= 0.3976, mean Time to accident= 4.6265
Recall@80%, Time to accident= 4.361
Average Precision= 0.8264, mean Time to accident= 3.6528
Recall@80%, Time to accident= 3.5
Average Precision= 0.8765, mean Time to accident= 4.3164
Recall@80%, Time to accident= 3.967
Average Precision= 0.7654, mean Time to accident= 4.1523
Recall@80%, Time to accident= 4.194
DEBUG flwr 2025-11-12 04:23:29,704 | server.py:187 | evaluate_round 6 received 5 results and 0 failures
INFO flwr 2025-11-12 04:23:29,704 | server.py:153 | FL finished in 108879.59447477205
INFO flwr 2025-11-12 04:23:29,704 | app.py:226 | app_fit: losses_distributed [(1, 0.699999988079071), (2, 0.699999988079071), (3, 0.699999988079071), (4, 0.699999988079071), (5, 0.699999988079071), (6, 0.699999988079071)]
INFO flwr 2025-11-12 04:23:29,704 | app.py:227 | app_fit: metrics_distributed_fit {}
INFO flwr 2025-11-12 04:23:29,704 | app.py:228 | app_fit: metrics_distributed {}
INFO flwr 2025-11-12 04:23:29,704 | app.py:229 | app_fit: losses_centralized [(0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0), (5, 0.0), (6, 0.0)]
INFO flwr 2025-11-12 04:23:29,704 | app.py:230 | app_fit: metrics_centralized {'ap': [(0, 0.2960974626332453), (1, 0.410395342041238), (2, 0.4186332856071766), (3, 0.388468354429755), (4, 0.4092433250578687), (5, 0.4265556875661972), (6, 0.44992954739042884)], 'mtta': [(0, 4.941864707078467), (1, 2.996025138704172), (2, 3.611428645024012), (3, 4.249398152326592), (4, 4.31099666540108), (5, 3.99179656403166), (6, 3.9105113431355853)], 'tta_r80': [(0, 4.943569553805775), (1, 3.091145833333332), (2, 3.7069116360454935), (3, 4.095363079615048), (4, 4.240157480314961), (5, 4.139107611548557), (6, 4.032370953630796)], 'recall_neg': [(0, 0.12086378737541528), (1, 0.9999335548172757), (2, 0.9908637873754153), (3, 0.926843853820598), (4, 0.8968106312292359), (5, 0.8789036544850498), (6, 0.8924252491694352)], 'recall_pos': [(0, 0.8863522012578616), (1, 0.0008176100628930818), (2, 0.020817610062893083), (3, 0.12125786163522012), (4, 0.17660377358490567), (5, 0.20660377358490567), (6, 0.19069182389937106)], 'pr_auc_frame': [(0, 0.3445584056709552), (1, 0.36305287649455814), (2, 0.3964078896322358), (3, 0.405242330109448), (4, 0.4154591029842286), (5, 0.422043363569444), (6, 0.42563491316596175)]}
DEBUG flwr 2025-11-12 04:23:29,706 | connection.py:220 | gRPC channel closed
DEBUG flwr 2025-11-12 04:23:29,706 | connection.py:220 | gRPC channel closed
DEBUG flwr 2025-11-12 04:23:29,706 | connection.py:220 | gRPC channel closed
DEBUG flwr 2025-11-12 04:23:29,706 | connection.py:220 | gRPC channel closed
DEBUG flwr 2025-11-12 04:23:29,706 | connection.py:220 | gRPC channel closed
INFO flwr 2025-11-12 04:23:29,706 | app.py:398 | Disconnect and shut down
INFO flwr 2025-11-12 04:23:29,706 | app.py:398 | Disconnect and shut down
INFO flwr 2025-11-12 04:23:29,706 | app.py:398 | Disconnect and shut down
INFO flwr 2025-11-12 04:23:29,706 | app.py:398 | Disconnect and shut down
INFO flwr 2025-11-12 04:23:29,707 | app.py:398 | Disconnect and shut down

Federated training running... (Ctrl+C to stop)

Federated training completed!
All processes terminated.
