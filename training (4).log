nohup: ignoring input
Using device: cuda
Server: Using unweighted CrossEntropyLoss
[93mWARNING [0m:   DEPRECATED FEATURE: flwr.server.start_server() is deprecated.
	Instead, use the `flower-superlink` CLI command to start a SuperLink as shown below:

		$ flower-superlink --insecure

	To view usage and all available options, run:

		$ flower-superlink --help

	Using `start_server()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      Starting Flower server, config: num_rounds=6, no round_timeout
[92mINFO [0m:      Flower ECE: gRPC server running (6 rounds), SSL is disabled
[92mINFO [0m:      [INIT]
[92mINFO [0m:      Requesting initial parameters from one random client
Using device: cuda
Starting DAD federated client 0
Client 0: Using unweighted CrossEntropyLoss
Client 0: total=254, train=215, val=39
[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_client() is deprecated.
	Instead, use the `flower-supernode` CLI command to start a SuperNode as shown below:

		$ flower-supernode --insecure --superlink='<IP>:<PORT>'

	To view all available options, run:

		$ flower-supernode --help

	Using `start_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      
[92mINFO [0m:      Received: get_parameters message 3509c685-2da6-4b51-99b2-8fdb0be57f5e
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Received initial parameters from one random client
[92mINFO [0m:      Starting evaluation of initial global parameters
Using device: cuda
Starting DAD federated client 1
Client 1: Using unweighted CrossEntropyLoss
Client 1: total=254, train=215, val=39
[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_client() is deprecated.
	Instead, use the `flower-supernode` CLI command to start a SuperNode as shown below:

		$ flower-supernode --insecure --superlink='<IP>:<PORT>'

	To view all available options, run:

		$ flower-supernode --help

	Using `start_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
Using device: cuda
Starting DAD federated client 2
Client 2: Using unweighted CrossEntropyLoss
Client 2: total=254, train=215, val=39
[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_client() is deprecated.
	Instead, use the `flower-supernode` CLI command to start a SuperNode as shown below:

		$ flower-supernode --insecure --superlink='<IP>:<PORT>'

	To view all available options, run:

		$ flower-supernode --help

	Using `start_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
Using device: cuda
Starting DAD federated client 3
Client 3: Using unweighted CrossEntropyLoss
Client 3: total=254, train=215, val=39
[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_client() is deprecated.
	Instead, use the `flower-supernode` CLI command to start a SuperNode as shown below:

		$ flower-supernode --insecure --superlink='<IP>:<PORT>'

	To view all available options, run:

		$ flower-supernode --help

	Using `start_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
Using device: cuda
Starting DAD federated client 4
Client 4: Using unweighted CrossEntropyLoss
Client 4: total=261, train=221, val=40
[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_client() is deprecated.
	Instead, use the `flower-supernode` CLI command to start a SuperNode as shown below:

		$ flower-supernode --insecure --superlink='<IP>:<PORT>'

	To view all available options, run:

		$ flower-supernode --help

	Using `start_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
Starting federated server with 6 rounds, 5 clients
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.3555, 0.5807]
Batch 0: pred_labels unique=[0 1], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.3661, 0.4747]
Batch 1: pred_labels unique=[0], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.2224, 0.5256]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.3620, mean Time to accident= 3.7599
Recall@80%, Time to accident= 3.467

=== SERVER EVALUATION ROUND 0 ===
Confusion Matrix:
[[28009  2091]
 [14632  1268]]
Class-wise recall: [0.931 0.08 ]
==================================================
[92mINFO [0m:      initial parameters (loss, other metrics): 0.0, {'ap': 0.36197640827092026, 'mtta': 3.75990880936758, 'tta_r80': 3.46657986111111, 'recall_neg': 0.930531561461794, 'recall_pos': 0.07974842767295598, 'pr_auc_frame': 0.3513502704394707}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 5 clients (out of 5)
[92mINFO [0m:      
[92mINFO [0m:      Received: train message b1e44a7a-8db3-4100-9094-656ad2804251
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 3: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 7416215d-4a7a-4dbb-9d9d-a007491d04a9
Client 1: Reset optimizer and scheduler state after loading server parameters
Client 1: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message dc006485-7608-47e9-b4b8-e193e965b466
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 4: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message f1cacf3b-5a5b-4f12-a890-43d93a444284
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 0: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 49a1daaa-e08d-4f17-8f9a-c92fd58f2034
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 2: Starting epoch 1/7
Client 3: Processing batch 0
/home/DSE425/miniconda3/lib/python3.13/site-packages/torch_geometric/utils/scatter.py:93: UserWarning: The usage of `scatter(reduce='max')` can be accelerated via the 'torch-scatter' package, but it was not found
  warnings.warn(f"The usage of `scatter(reduce='{reduce}')` "
Client 4: Processing batch 0
/home/DSE425/miniconda3/lib/python3.13/site-packages/torch_geometric/utils/scatter.py:93: UserWarning: The usage of `scatter(reduce='max')` can be accelerated via the 'torch-scatter' package, but it was not found
  warnings.warn(f"The usage of `scatter(reduce='{reduce}')` "
Client 2: Processing batch 0
Client 1: Processing batch 0
/home/DSE425/miniconda3/lib/python3.13/site-packages/torch_geometric/utils/scatter.py:93: UserWarning: The usage of `scatter(reduce='max')` can be accelerated via the 'torch-scatter' package, but it was not found
  warnings.warn(f"The usage of `scatter(reduce='{reduce}')` "
Client 0: Processing batch 0
/home/DSE425/miniconda3/lib/python3.13/site-packages/torch_geometric/utils/scatter.py:93: UserWarning: The usage of `scatter(reduce='max')` can be accelerated via the 'torch-scatter' package, but it was not found
  warnings.warn(f"The usage of `scatter(reduce='{reduce}')` "
/home/DSE425/miniconda3/lib/python3.13/site-packages/torch_geometric/utils/scatter.py:93: UserWarning: The usage of `scatter(reduce='max')` can be accelerated via the 'torch-scatter' package, but it was not found
  warnings.warn(f"The usage of `scatter(reduce='{reduce}')` "
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.4962, mean Time to accident= 4.8121
Recall@80%, Time to accident= 4.65
Client 3: Epoch 1 validation AP = 0.4962
Client 3: New best AP = 0.4962, saving checkpoint
Client 3: Starting epoch 2/7
Client 3: Processing batch 0
Average Precision= 0.6728, mean Time to accident= 4.9070
Recall@80%, Time to accident= 4.858
Client 1: Epoch 1 validation AP = 0.6728
Client 1: New best AP = 0.6728, saving checkpoint
Client 1: Starting epoch 2/7
Client 1: Processing batch 0
Average Precision= 0.4233, mean Time to accident= 4.4321
Recall@80%, Time to accident= 3.778
Client 2: Epoch 1 validation AP = 0.4233
Client 2: New best AP = 0.4233, saving checkpoint
Client 2: Starting epoch 2/7
Average Precision= 0.6440, mean Time to accident= 4.8678
Recall@80%, Time to accident= 4.911
Client 0: Epoch 1 validation AP = 0.6440
Client 0: New best AP = 0.6440, saving checkpoint
Client 0: Starting epoch 2/7
Client 2: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.4041, mean Time to accident= 3.9833
Recall@80%, Time to accident= 3.898
Client 4: Epoch 1 validation AP = 0.4041
Client 4: New best AP = 0.4041, saving checkpoint
Client 4: Starting epoch 2/7
Client 3: Processing batch 10
Client 4: Processing batch 0
Client 1: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 20
Client 4: Processing batch 10
Client 1: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 30
Client 4: Processing batch 20
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 40
Client 4: Processing batch 30
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 50
Client 4: Processing batch 40
Client 1: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 60
Client 4: Processing batch 50
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 70
Client 4: Processing batch 60
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 80
Client 4: Processing batch 70
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 90
Client 4: Processing batch 80
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 100
Client 4: Processing batch 90
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 110
Client 4: Processing batch 100
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 110
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 120
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 130
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 150
Client 4: Processing batch 140
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 150
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 170
Client 4: Processing batch 160
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 180
Client 4: Processing batch 170
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 190
Client 4: Processing batch 180
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 200
Client 4: Processing batch 190
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 210
Client 4: Processing batch 200
Client 1: Processing batch 210
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.3399, mean Time to accident= 4.0048
Recall@80%, Time to accident= 3.878
Client 3: Epoch 2 validation AP = 0.3399
Client 3: Starting epoch 3/7
Client 3: Processing batch 0
Average Precision= 0.7116, mean Time to accident= 4.7152
Recall@80%, Time to accident= 4.796
Client 1: Epoch 2 validation AP = 0.7116
Client 1: New best AP = 0.7116, saving checkpoint
Client 1: Starting epoch 3/7
Client 1: Processing batch 0
Average Precision= 0.6260, mean Time to accident= 4.7899
Recall@80%, Time to accident= 4.589
Client 0: Epoch 2 validation AP = 0.6260
Client 0: Starting epoch 3/7
Average Precision= 0.4995, mean Time to accident= 4.6557
Recall@80%, Time to accident= 4.369
Client 2: Epoch 2 validation AP = 0.4995
Client 2: New best AP = 0.4995, saving checkpoint
Client 2: Starting epoch 3/7
Client 0: Processing batch 0
Client 2: Processing batch 0
Client 3: Processing batch 10
Client 1: Processing batch 10
Average Precision= 0.6631, mean Time to accident= 3.3606
Recall@80%, Time to accident= 3.679
Client 4: Epoch 2 validation AP = 0.6631
Client 4: New best AP = 0.6631, saving checkpoint
Client 4: Starting epoch 3/7
Client 0: Processing batch 10
Client 4: Processing batch 0
Client 2: Processing batch 10
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 20
Client 4: Processing batch 10
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 20
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 30
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 40
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 50
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 60
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 70
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 80
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 90
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 100
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 110
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 120
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 130
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 140
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 150
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 160
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 170
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 180
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 190
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 200
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.4438, mean Time to accident= 3.6448
Recall@80%, Time to accident= 3.354
Client 3: Epoch 3 validation AP = 0.4438
Client 3: Starting epoch 4/7
Client 3: Processing batch 0
Average Precision= 0.5239, mean Time to accident= 4.2289
Recall@80%, Time to accident= 3.758
Client 2: Epoch 3 validation AP = 0.5239
Client 2: New best AP = 0.5239, saving checkpoint
Client 2: Starting epoch 4/7
Client 2: Processing batch 0
Average Precision= 0.5862, mean Time to accident= 4.9373
Recall@80%, Time to accident= 4.944
Client 1: Epoch 3 validation AP = 0.5862
Client 1: Starting epoch 4/7
Average Precision= 0.5352, mean Time to accident= 4.7985
Recall@80%, Time to accident= 4.811
Client 0: Epoch 3 validation AP = 0.5352
Client 0: Starting epoch 4/7
Client 1: Processing batch 0
Client 0: Processing batch 0
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 20
Average Precision= 0.7514, mean Time to accident= 3.8201
Recall@80%, Time to accident= 3.679
Client 4: Epoch 3 validation AP = 0.7514
Client 4: New best AP = 0.7514, saving checkpoint
Client 4: Starting epoch 4/7
Client 4: Processing batch 0
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 4: Processing batch 10
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 40
Client 4: Processing batch 20
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 50
Client 4: Processing batch 30
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 60
Client 4: Processing batch 40
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 4: Processing batch 50
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 80
Client 4: Processing batch 60
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 90
Client 4: Processing batch 70
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 100
Client 4: Processing batch 80
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 110
Client 4: Processing batch 90
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 100
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 110
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 120
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 4: Processing batch 130
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 140
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 4: Processing batch 150
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 4: Processing batch 160
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 4: Processing batch 170
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 200
Client 4: Processing batch 180
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 4: Processing batch 190
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 200
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.4625, mean Time to accident= 4.7200
Recall@80%, Time to accident= 4.928
Client 3: Epoch 4 validation AP = 0.4625
Client 3: Starting epoch 5/7
Client 3: Processing batch 0
Average Precision= 0.5162, mean Time to accident= 4.3398
Recall@80%, Time to accident= 3.753
Client 2: Epoch 4 validation AP = 0.5162
Client 2: Starting epoch 5/7
Client 2: Processing batch 0
Average Precision= 0.6986, mean Time to accident= 4.3921
Recall@80%, Time to accident= 4.506
Client 0: Epoch 4 validation AP = 0.6986
Client 0: New best AP = 0.6986, saving checkpoint
Client 0: Starting epoch 5/7
Average Precision= 0.6032, mean Time to accident= 4.6324
Recall@80%, Time to accident= 4.846
Client 1: Epoch 4 validation AP = 0.6032
Client 1: Starting epoch 5/7
Client 0: Processing batch 0
Client 1: Processing batch 0
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 30
Client 0: Processing batch 20
Client 1: Processing batch 20
Average Precision= 0.6303, mean Time to accident= 4.1631
Recall@80%, Time to accident= 4.013
Client 4: Epoch 4 validation AP = 0.6303
Client 4: Starting epoch 5/7
Client 4: Processing batch 0
Client 2: Processing batch 30
Client 3: Processing batch 40
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 10
Client 2: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 50
Client 4: Processing batch 20
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 60
Client 4: Processing batch 30
Client 2: Processing batch 60
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 70
Client 4: Processing batch 40
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 80
Client 4: Processing batch 50
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 90
Client 4: Processing batch 60
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 100
Client 0: Processing batch 90
Client 4: Processing batch 70
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 110
Client 4: Processing batch 80
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 90
Client 1: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 100
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 140
Client 0: Processing batch 130
Client 4: Processing batch 110
Client 1: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 150
Client 0: Processing batch 140
Client 4: Processing batch 120
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 130
Client 1: Processing batch 160
Client 3: Processing batch 170
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 140
Client 1: Processing batch 170
Client 3: Processing batch 180
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 4: Processing batch 150
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 160
Client 1: Processing batch 190
Client 3: Processing batch 200
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 170
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 180
Client 1: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 4: Processing batch 190
Client 4: Processing batch 200
Client 4: Processing batch 210
Average Precision= 0.5064, mean Time to accident= 4.7353
Recall@80%, Time to accident= 4.578
Client 3: Epoch 5 validation AP = 0.5064
Client 3: New best AP = 0.5064, saving checkpoint
Client 3: Starting epoch 6/7
Client 3: Processing batch 0
Client 4: Processing batch 220
Average Precision= 0.4611, mean Time to accident= 4.6890
Recall@80%, Time to accident= 4.444
Client 1: Epoch 5 validation AP = 0.4611
Client 1: Starting epoch 6/7
Average Precision= 0.5099, mean Time to accident= 4.2821
Recall@80%, Time to accident= 3.717
Client 2: Epoch 5 validation AP = 0.5099
Client 2: Starting epoch 6/7
Average Precision= 0.6165, mean Time to accident= 4.7942
Recall@80%, Time to accident= 4.894
Client 0: Epoch 5 validation AP = 0.6165
Client 0: Starting epoch 6/7
Client 1: Processing batch 0
Client 2: Processing batch 0
Client 3: Processing batch 10
Client 0: Processing batch 0
Client 1: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 40
Average Precision= 0.6606, mean Time to accident= 3.9461
Recall@80%, Time to accident= 4.171
Client 4: Epoch 5 validation AP = 0.6606
Client 4: Starting epoch 6/7
Client 4: Processing batch 0
Client 2: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 50
Client 4: Processing batch 10
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 60
Client 4: Processing batch 20
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 70
Client 4: Processing batch 30
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 3: Processing batch 80
Client 4: Processing batch 40
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 90
Client 4: Processing batch 50
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 100
Client 4: Processing batch 60
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 110
Client 4: Processing batch 70
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 80
Client 1: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 90
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 100
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 150
Client 4: Processing batch 110
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 120
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 170
Client 4: Processing batch 130
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 180
Client 4: Processing batch 140
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 190
Client 4: Processing batch 150
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 160
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 170
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 180
Client 4: Processing batch 190
Client 4: Processing batch 200
Client 4: Processing batch 210
Average Precision= 0.4867, mean Time to accident= 4.7107
Recall@80%, Time to accident= 4.633
Client 3: Epoch 6 validation AP = 0.4867
Client 3: Starting epoch 7/7
Client 3: Processing batch 0
Average Precision= 0.5306, mean Time to accident= 4.4496
Recall@80%, Time to accident= 4.456
Client 0: Epoch 6 validation AP = 0.5306
Client 0: Starting epoch 7/7
Client 0: Processing batch 0
Client 4: Processing batch 220
Average Precision= 0.5109, mean Time to accident= 4.7569
Recall@80%, Time to accident= 4.549
Client 1: Epoch 6 validation AP = 0.5109
Client 1: Starting epoch 7/7
Average Precision= 0.5686, mean Time to accident= 4.2731
Recall@80%, Time to accident= 3.823
Client 2: Epoch 6 validation AP = 0.5686
Client 2: New best AP = 0.5686, saving checkpoint
Client 2: Starting epoch 7/7
Client 1: Processing batch 0
Client 2: Processing batch 0
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 40
Client 0: Processing batch 40
Average Precision= 0.5753, mean Time to accident= 3.8137
Recall@80%, Time to accident= 4.235
Client 4: Epoch 6 validation AP = 0.5753
Client 4: Starting epoch 7/7
Client 4: Processing batch 0
Client 1: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 10
Client 1: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 20
Client 1: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 30
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 40
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 50
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 60
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 70
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 80
Client 1: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 90
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 100
Client 1: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 110
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 120
Client 1: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 130
Client 1: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 140
Client 1: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 150
Client 1: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 160
Client 1: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 4: Processing batch 170
Client 1: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 180
Client 4: Processing batch 190
Client 4: Processing batch 200
Average Precision= 0.4284, mean Time to accident= 4.6555
Recall@80%, Time to accident= 4.594
Client 3: Epoch 7 validation AP = 0.4284
Client 3: Loaded best model checkpoint with AP = 0.5064
[92mINFO [0m:      Sent reply
Client 4: Processing batch 210
Average Precision= 0.5493, mean Time to accident= 4.2864
Recall@80%, Time to accident= 4.422
Client 0: Epoch 7 validation AP = 0.5493
Client 0: Loaded best model checkpoint with AP = 0.6986
[92mINFO [0m:      Sent reply
Average Precision= 0.5416, mean Time to accident= 4.9035
Recall@80%, Time to accident= 4.994
Client 1: Epoch 7 validation AP = 0.5416
Client 1: Loaded best model checkpoint with AP = 0.7116
[92mINFO [0m:      Sent reply
Average Precision= 0.5592, mean Time to accident= 3.8739
Recall@80%, Time to accident= 3.551
Client 2: Epoch 7 validation AP = 0.5592
Client 2: Loaded best model checkpoint with AP = 0.5686
[92mINFO [0m:      Sent reply
Client 4: Processing batch 220
Average Precision= 0.5391, mean Time to accident= 3.8439
Recall@80%, Time to accident= 3.679
Client 4: Epoch 7 validation AP = 0.5391
Client 4: Loaded best model checkpoint with AP = 0.7514
[92mINFO [0m:      Sent reply
[92mINFO [0m:      aggregate_fit: received 5 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
Saved PR curve: results/federated/pr_curve_round_0.png
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0920, 0.5526]
Batch 0: pred_labels unique=[0 1], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.2047, 0.5342]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.0398, 0.5851]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.4986, mean Time to accident= 4.7542
Recall@80%, Time to accident= 4.527

=== SERVER EVALUATION ROUND 1 ===
Confusion Matrix:
[[28410  1690]
 [13861  2039]]
Class-wise recall: [0.944 0.128]
==================================================
[92mINFO [0m:      fit progress: (1, 0.0, {'ap': 0.4986479258169009, 'mtta': 4.754242787396188, 'tta_r80': 4.52668416447944, 'recall_neg': 0.9438538205980066, 'recall_pos': 0.12823899371069183, 'pr_auc_frame': 0.4312651460932098}, 22462.850476108957)
[92mINFO [0m:      configure_evaluate: strategy sampled 5 clients (out of 5)
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 7b22d722-471d-49dc-b44d-a041b69c2c1b
Client 0: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message f69f9894-5802-4654-a721-5e2f0b0d9880
Client 2: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message d8b9d885-6cf6-4875-ba3b-5c00e93c40b4
Client 4: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message dc036c2c-3c0c-4611-af0d-f347d18904ff
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message b1e0335c-c588-4943-a38c-49c3d454146c
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 1: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      aggregate_evaluate: received 5 results and 0 failures
[93mWARNING [0m:   No evaluate_metrics_aggregation_fn provided
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 5 clients (out of 5)
[92mINFO [0m:      
[92mINFO [0m:      Received: train message c4dd51dd-c7f6-4f16-844e-51ed001a248b
Average Precision= 0.3986, mean Time to accident= 4.4026
Recall@80%, Time to accident= 4.233
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 3: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message d0bb9df6-a4c5-4c1a-a797-f6ae914e7fb0
Average Precision= 0.5315, mean Time to accident= 4.8563
Recall@80%, Time to accident= 4.981
Client 1: Reset optimizer and scheduler state after loading server parameters
Client 1: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message fab8ac67-76fa-4b6b-9315-526c5d177b24
Average Precision= 0.4233, mean Time to accident= 4.3525
Recall@80%, Time to accident= 3.979
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 4: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message a55d2e40-cc1b-402e-b8f3-0433326fd650
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 5f908ca3-fd8b-4118-82e4-7b50013594c3
Average Precision= 0.6377, mean Time to accident= 4.4902
Recall@80%, Time to accident= 4.076
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 2: Starting epoch 1/7
Average Precision= 0.5734, mean Time to accident= 4.7652
Recall@80%, Time to accident= 4.378
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 0: Starting epoch 1/7
Client 3: Processing batch 0
Client 1: Processing batch 0
Client 4: Processing batch 0
Client 2: Processing batch 0
Client 0: Processing batch 0
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 4: Processing batch 30
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 40
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 60
Client 2: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 2: Processing batch 80
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 2: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 2: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 2: Processing batch 140
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 2: Processing batch 150
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 150
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 210
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 1: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.5354, mean Time to accident= 4.6284
Recall@80%, Time to accident= 4.63
Client 2: Epoch 1 validation AP = 0.5354
Client 2: New best AP = 0.5354, saving checkpoint
Client 2: Starting epoch 2/7
Client 2: Processing batch 0
Average Precision= 0.5214, mean Time to accident= 4.3787
Recall@80%, Time to accident= 4.467
Client 0: Epoch 1 validation AP = 0.5214
Client 0: New best AP = 0.5214, saving checkpoint
Client 0: Starting epoch 2/7
Average Precision= 0.5549, mean Time to accident= 4.7190
Recall@80%, Time to accident= 3.957
Client 1: Epoch 1 validation AP = 0.5549
Client 1: New best AP = 0.5549, saving checkpoint
Client 1: Starting epoch 2/7
Average Precision= 0.4452, mean Time to accident= 4.6471
Recall@80%, Time to accident= 4.433
Client 3: Epoch 1 validation AP = 0.4452
Client 3: New best AP = 0.4452, saving checkpoint
Client 3: Starting epoch 2/7
Client 0: Processing batch 0
Client 1: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.5890, mean Time to accident= 3.8331
Recall@80%, Time to accident= 3.385
Client 4: Epoch 1 validation AP = 0.5890
Client 4: New best AP = 0.5890, saving checkpoint
Client 4: Starting epoch 2/7
Client 4: Processing batch 0
Client 2: Processing batch 10
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 60
Client 2: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 70
Client 2: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 80
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 110
Client 4: Processing batch 100
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 1: Processing batch 120
Client 4: Processing batch 110
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 140
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 150
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.6224, mean Time to accident= 4.6764
Recall@80%, Time to accident= 4.265
Client 1: Epoch 2 validation AP = 0.6224
Client 1: New best AP = 0.6224, saving checkpoint
Client 1: Starting epoch 3/7
Client 1: Processing batch 0
Average Precision= 0.5744, mean Time to accident= 4.3622
Recall@80%, Time to accident= 4.467
Client 0: Epoch 2 validation AP = 0.5744
Client 0: New best AP = 0.5744, saving checkpoint
Client 0: Starting epoch 3/7
Client 0: Processing batch 0
Average Precision= 0.6138, mean Time to accident= 4.4834
Recall@80%, Time to accident= 4.192
Client 2: Epoch 2 validation AP = 0.6138
Client 2: New best AP = 0.6138, saving checkpoint
Client 2: Starting epoch 3/7
Average Precision= 0.4279, mean Time to accident= 4.6952
Recall@80%, Time to accident= 4.272
Client 3: Epoch 2 validation AP = 0.4279
Client 3: Starting epoch 3/7
Client 2: Processing batch 0
Client 3: Processing batch 0
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 10
Average Precision= 0.5368, mean Time to accident= 4.5234
Recall@80%, Time to accident= 4.432
Client 4: Epoch 2 validation AP = 0.5368
Client 4: Starting epoch 3/7
Client 4: Processing batch 0
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 10
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 4: Processing batch 20
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 30
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 40
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 50
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 60
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 70
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 80
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 90
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 100
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 110
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 120
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 130
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 140
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 150
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 160
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 170
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 180
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 190
Client 0: Processing batch 210
Client 1: Processing batch 210
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 200
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.5041, mean Time to accident= 4.2919
Recall@80%, Time to accident= 4.511
Client 0: Epoch 3 validation AP = 0.5041
Client 0: Starting epoch 4/7
Client 0: Processing batch 0
Average Precision= 0.7080, mean Time to accident= 4.6137
Recall@80%, Time to accident= 4.457
Client 1: Epoch 3 validation AP = 0.7080
Client 1: New best AP = 0.7080, saving checkpoint
Client 1: Starting epoch 4/7
Client 1: Processing batch 0
Average Precision= 0.7136, mean Time to accident= 4.0909
Recall@80%, Time to accident= 3.919
Client 2: Epoch 3 validation AP = 0.7136
Client 2: New best AP = 0.7136, saving checkpoint
Client 2: Starting epoch 4/7
Client 2: Processing batch 0
Average Precision= 0.4021, mean Time to accident= 4.7234
Recall@80%, Time to accident= 4.422
Client 3: Epoch 3 validation AP = 0.4021
Client 3: Starting epoch 4/7
Client 3: Processing batch 0
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 20
Client 1: Processing batch 20
Average Precision= 0.6294, mean Time to accident= 4.5822
Recall@80%, Time to accident= 4.269
Client 4: Epoch 3 validation AP = 0.6294
Client 4: New best AP = 0.6294, saving checkpoint
Client 4: Starting epoch 4/7
Client 2: Processing batch 20
Client 4: Processing batch 0
Client 3: Processing batch 20
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 30
Client 4: Processing batch 10
Client 3: Processing batch 30
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 20
Client 3: Processing batch 40
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 30
Client 3: Processing batch 50
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 40
Client 3: Processing batch 60
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 50
Client 3: Processing batch 70
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 60
Client 3: Processing batch 80
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 70
Client 3: Processing batch 90
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 80
Client 3: Processing batch 100
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 90
Client 3: Processing batch 110
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 120
Client 4: Processing batch 100
Client 3: Processing batch 120
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 110
Client 3: Processing batch 130
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 120
Client 3: Processing batch 140
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 4: Processing batch 130
Client 3: Processing batch 150
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 160
Client 4: Processing batch 140
Client 3: Processing batch 160
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 170
Client 4: Processing batch 150
Client 3: Processing batch 170
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 160
Client 3: Processing batch 180
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 170
Client 3: Processing batch 190
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 180
Client 3: Processing batch 200
Client 0: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 190
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 200
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.5104, mean Time to accident= 4.7755
Recall@80%, Time to accident= 4.861
Client 0: Epoch 4 validation AP = 0.5104
Client 0: Starting epoch 5/7
Average Precision= 0.6699, mean Time to accident= 4.6978
Recall@80%, Time to accident= 4.278
Client 1: Epoch 4 validation AP = 0.6699
Client 1: Starting epoch 5/7
Client 0: Processing batch 0
Client 1: Processing batch 0
Average Precision= 0.6344, mean Time to accident= 4.6050
Recall@80%, Time to accident= 4.237
Client 2: Epoch 4 validation AP = 0.6344
Client 2: Starting epoch 5/7
Client 2: Processing batch 0
Average Precision= 0.4080, mean Time to accident= 4.7263
Recall@80%, Time to accident= 4.678
Client 3: Epoch 4 validation AP = 0.4080
Client 3: Starting epoch 5/7
Client 3: Processing batch 0
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 20
Average Precision= 0.6337, mean Time to accident= 4.2270
Recall@80%, Time to accident= 3.645
Client 4: Epoch 4 validation AP = 0.6337
Client 4: New best AP = 0.6337, saving checkpoint
Client 4: Starting epoch 5/7
Client 4: Processing batch 0
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 40
Client 4: Processing batch 10
Client 1: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 20
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 60
Client 4: Processing batch 30
Client 1: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 70
Client 4: Processing batch 40
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 80
Client 4: Processing batch 50
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 90
Client 4: Processing batch 60
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 100
Client 4: Processing batch 70
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 110
Client 4: Processing batch 80
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 90
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 100
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 110
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 120
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 160
Client 4: Processing batch 130
Client 1: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 140
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 150
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 160
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 170
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 180
Client 0: Processing batch 210
Client 1: Processing batch 210
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 190
Client 4: Processing batch 200
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.6745, mean Time to accident= 4.5432
Recall@80%, Time to accident= 3.883
Client 1: Epoch 5 validation AP = 0.6745
Client 1: Starting epoch 6/7
Average Precision= 0.5348, mean Time to accident= 4.4717
Recall@80%, Time to accident= 4.344
Client 0: Epoch 5 validation AP = 0.5348
Client 0: Starting epoch 6/7
Client 1: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.7137, mean Time to accident= 4.1573
Recall@80%, Time to accident= 3.697
Client 2: Epoch 5 validation AP = 0.7137
Client 2: New best AP = 0.7137, saving checkpoint
Client 2: Starting epoch 6/7
Client 2: Processing batch 0
Average Precision= 0.4422, mean Time to accident= 4.4326
Recall@80%, Time to accident= 4.394
Client 3: Epoch 5 validation AP = 0.4422
Client 3: Starting epoch 6/7
Client 3: Processing batch 0
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Average Precision= 0.5624, mean Time to accident= 4.5522
Recall@80%, Time to accident= 4.568
Client 4: Epoch 5 validation AP = 0.5624
Client 4: Starting epoch 6/7
Client 4: Processing batch 0
Client 3: Processing batch 30
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 10
Client 3: Processing batch 40
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 20
Client 3: Processing batch 50
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 30
Client 3: Processing batch 60
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 40
Client 3: Processing batch 70
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 50
Client 3: Processing batch 80
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 60
Client 3: Processing batch 90
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 70
Client 3: Processing batch 100
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 80
Client 3: Processing batch 110
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 4: Processing batch 90
Client 3: Processing batch 120
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 100
Client 3: Processing batch 130
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 110
Client 3: Processing batch 140
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 120
Client 3: Processing batch 150
Client 1: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 130
Client 3: Processing batch 160
Client 1: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 140
Client 3: Processing batch 170
Client 1: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 150
Client 3: Processing batch 180
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 160
Client 3: Processing batch 190
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 170
Client 3: Processing batch 200
Client 1: Processing batch 210
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 180
Client 3: Processing batch 210
Client 4: Processing batch 190
Client 4: Processing batch 200
Client 4: Processing batch 210
Average Precision= 0.6287, mean Time to accident= 4.8922
Recall@80%, Time to accident= 4.988
Client 1: Epoch 6 validation AP = 0.6287
Client 1: Starting epoch 7/7
Average Precision= 0.4215, mean Time to accident= 4.5869
Recall@80%, Time to accident= 4.611
Client 0: Epoch 6 validation AP = 0.4215
Client 0: Starting epoch 7/7
Client 1: Processing batch 0
Average Precision= 0.7022, mean Time to accident= 4.1113
Recall@80%, Time to accident= 3.798
Client 2: Epoch 6 validation AP = 0.7022
Client 2: Starting epoch 7/7
Client 0: Processing batch 0
Client 4: Processing batch 220
Client 2: Processing batch 0
Average Precision= 0.4076, mean Time to accident= 4.5419
Recall@80%, Time to accident= 4.417
Client 3: Epoch 6 validation AP = 0.4076
Client 3: Starting epoch 7/7
Client 3: Processing batch 0
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 30
Average Precision= 0.6140, mean Time to accident= 4.4551
Recall@80%, Time to accident= 4.09
Client 4: Epoch 6 validation AP = 0.6140
Client 4: Starting epoch 7/7
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 0
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 10
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 20
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 30
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 40
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 90
Client 4: Processing batch 50
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 100
Client 4: Processing batch 60
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 110
Client 4: Processing batch 70
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 120
Client 4: Processing batch 80
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 130
Client 4: Processing batch 90
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 140
Client 4: Processing batch 100
Client 2: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 150
Client 4: Processing batch 110
Client 2: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 160
Client 4: Processing batch 120
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 4: Processing batch 130
Client 1: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 140
Client 1: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 150
Client 1: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 160
Client 3: Processing batch 200
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 170
Client 3: Processing batch 210
Client 4: Processing batch 180
Client 4: Processing batch 190
Client 4: Processing batch 200
Client 4: Processing batch 210
Average Precision= 0.4601, mean Time to accident= 4.0551
Recall@80%, Time to accident= 4.1
Client 0: Epoch 7 validation AP = 0.4601
Client 0: Loaded best model checkpoint with AP = 0.5744
[92mINFO [0m:      Sent reply
Average Precision= 0.6615, mean Time to accident= 3.9476
Recall@80%, Time to accident= 3.47
Client 2: Epoch 7 validation AP = 0.6615
Client 2: Loaded best model checkpoint with AP = 0.7137
[92mINFO [0m:      Sent reply
Average Precision= 0.6023, mean Time to accident= 4.3992
Recall@80%, Time to accident= 4.037
Client 1: Epoch 7 validation AP = 0.6023
Client 1: Loaded best model checkpoint with AP = 0.7080
[92mINFO [0m:      Sent reply
Client 4: Processing batch 220
Average Precision= 0.4256, mean Time to accident= 4.4331
Recall@80%, Time to accident= 4.656
Client 3: Epoch 7 validation AP = 0.4256
Client 3: Loaded best model checkpoint with AP = 0.4452
[92mINFO [0m:      Sent reply
Average Precision= 0.6308, mean Time to accident= 4.2999
Recall@80%, Time to accident= 3.974
Client 4: Epoch 7 validation AP = 0.6308
Client 4: Loaded best model checkpoint with AP = 0.6337
[92mINFO [0m:      Sent reply
[92mINFO [0m:      aggregate_fit: received 5 results and 0 failures
Saved PR curve: results/federated/pr_curve_round_1.png
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.1217, 0.8892]
Batch 0: pred_labels unique=[0 1], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0718, 0.8104]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.1441, 0.7913]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.5160, mean Time to accident= 4.3779
Recall@80%, Time to accident= 4.228

=== SERVER EVALUATION ROUND 2 ===
Confusion Matrix:
[[26316  3784]
 [11556  4344]]
Class-wise recall: [0.874 0.273]
==================================================
[92mINFO [0m:      fit progress: (2, 0.0, {'ap': 0.5160025402858185, 'mtta': 4.377877130856022, 'tta_r80': 4.228346456692913, 'recall_neg': 0.8742857142857143, 'recall_pos': 0.2732075471698113, 'pr_auc_frame': 0.47427369856203416}, 45209.605913836975)
[92mINFO [0m:      configure_evaluate: strategy sampled 5 clients (out of 5)
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 1efca36e-fd41-4ea3-9f6a-35324e745def
Client 1: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message ca2adfee-023a-4db3-861f-e6aefe122d37
Client 3: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 710057f8-fb60-4b2b-b18c-e650eb269b16
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 645a5648-baec-4c49-a82c-389957eb0fe6
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 0: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message bbce9e12-9718-41f8-bf31-b5a7ff46277b
Client 4: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      aggregate_evaluate: received 5 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 5 clients (out of 5)
[92mINFO [0m:      
[92mINFO [0m:      Received: train message a595eb2a-b2d4-4b7a-88b8-b358d2829eaf
Average Precision= 0.6864, mean Time to accident= 4.2255
Recall@80%, Time to accident= 3.727
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 2: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 1e49fcc6-894c-48e8-a208-4bba7c1de873
Average Precision= 0.5580, mean Time to accident= 4.4601
Recall@80%, Time to accident= 4.319
Client 1: Reset optimizer and scheduler state after loading server parameters
Client 1: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 98fb749e-065b-4654-92dc-fcfdd4b52d45
Average Precision= 0.4932, mean Time to accident= 4.5952
Recall@80%, Time to accident= 4.406
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 0: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message f6dfd706-9921-4304-b553-11a674c0b4cc
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 5ec80c43-66c3-4777-8a4f-b6862e6ee270
Average Precision= 0.6065, mean Time to accident= 4.2817
Recall@80%, Time to accident= 3.872
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 4: Starting epoch 1/7
Average Precision= 0.5317, mean Time to accident= 4.3246
Recall@80%, Time to accident= 4.2
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 3: Starting epoch 1/7
Client 2: Processing batch 0
Client 1: Processing batch 0
Client 0: Processing batch 0
Client 4: Processing batch 0
Client 3: Processing batch 0
Client 1: Processing batch 10
Client 2: Processing batch 10
Client 4: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 4: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 30
Client 4: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 70
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 80
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 90
Client 4: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 120
Client 4: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.7575, mean Time to accident= 4.6914
Recall@80%, Time to accident= 4.66
Client 1: Epoch 1 validation AP = 0.7575
Client 1: New best AP = 0.7575, saving checkpoint
Client 1: Starting epoch 2/7
Average Precision= 0.5119, mean Time to accident= 4.6503
Recall@80%, Time to accident= 4.278
Client 0: Epoch 1 validation AP = 0.5119
Client 0: New best AP = 0.5119, saving checkpoint
Client 0: Starting epoch 2/7
Client 1: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.7020, mean Time to accident= 4.5582
Recall@80%, Time to accident= 4.359
Client 2: Epoch 1 validation AP = 0.7020
Client 2: New best AP = 0.7020, saving checkpoint
Client 2: Starting epoch 2/7
Average Precision= 0.4178, mean Time to accident= 4.3148
Recall@80%, Time to accident= 4.406
Client 3: Epoch 1 validation AP = 0.4178
Client 3: New best AP = 0.4178, saving checkpoint
Client 3: Starting epoch 2/7
Client 2: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.5418, mean Time to accident= 4.2926
Recall@80%, Time to accident= 3.85
Client 4: Epoch 1 validation AP = 0.5418
Client 4: New best AP = 0.5418, saving checkpoint
Client 4: Starting epoch 2/7
Client 4: Processing batch 0
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 1: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 150
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 210
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.5752, mean Time to accident= 4.6935
Recall@80%, Time to accident= 4.975
Client 1: Epoch 2 validation AP = 0.5752
Client 1: Starting epoch 3/7
Average Precision= 0.5254, mean Time to accident= 4.4139
Recall@80%, Time to accident= 4.444
Client 0: Epoch 2 validation AP = 0.5254
Client 0: New best AP = 0.5254, saving checkpoint
Client 0: Starting epoch 3/7
Client 1: Processing batch 0
Average Precision= 0.4659, mean Time to accident= 4.0627
Recall@80%, Time to accident= 4.233
Client 3: Epoch 2 validation AP = 0.4659
Client 3: New best AP = 0.4659, saving checkpoint
Client 3: Starting epoch 3/7
Average Precision= 0.7811, mean Time to accident= 4.0699
Recall@80%, Time to accident= 4.141
Client 2: Epoch 2 validation AP = 0.7811
Client 2: New best AP = 0.7811, saving checkpoint
Client 2: Starting epoch 3/7
Client 0: Processing batch 0
Client 3: Processing batch 0
Client 2: Processing batch 0
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Average Precision= 0.5737, mean Time to accident= 4.1213
Recall@80%, Time to accident= 3.812
Client 4: Epoch 2 validation AP = 0.5737
Client 4: New best AP = 0.5737, saving checkpoint
Client 4: Starting epoch 3/7
Client 4: Processing batch 0
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 4: Processing batch 10
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 4: Processing batch 20
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 30
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 40
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 50
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 60
Client 1: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 70
Client 1: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 80
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 90
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 100
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 4: Processing batch 110
Client 1: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 120
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 130
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 4: Processing batch 140
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 4: Processing batch 150
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 4: Processing batch 160
Client 1: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 170
Client 1: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 180
Client 1: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 190
Client 1: Processing batch 210
Client 3: Processing batch 210
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 200
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.5303, mean Time to accident= 4.7592
Recall@80%, Time to accident= 4.58
Client 1: Epoch 3 validation AP = 0.5303
Client 1: Starting epoch 4/7
Client 1: Processing batch 0
Average Precision= 0.5923, mean Time to accident= 4.5942
Recall@80%, Time to accident= 4.544
Client 0: Epoch 3 validation AP = 0.5923
Client 0: New best AP = 0.5923, saving checkpoint
Client 0: Starting epoch 4/7
Average Precision= 0.3909, mean Time to accident= 4.3580
Recall@80%, Time to accident= 4.522
Client 3: Epoch 3 validation AP = 0.3909
Client 3: Starting epoch 4/7
Client 0: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.7082, mean Time to accident= 4.5786
Recall@80%, Time to accident= 4.424
Client 2: Epoch 3 validation AP = 0.7082
Client 2: Starting epoch 4/7
Client 2: Processing batch 0
Client 1: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 20
Average Precision= 0.5906, mean Time to accident= 3.9744
Recall@80%, Time to accident= 3.962
Client 4: Epoch 3 validation AP = 0.5906
Client 4: New best AP = 0.5906, saving checkpoint
Client 4: Starting epoch 4/7
Client 3: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 0
Client 2: Processing batch 20
Client 1: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 10
Client 2: Processing batch 30
Client 1: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 20
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 1: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 30
Client 0: Processing batch 50
Client 2: Processing batch 50
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 40
Client 2: Processing batch 60
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 50
Client 2: Processing batch 70
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 60
Client 2: Processing batch 80
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 70
Client 2: Processing batch 90
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 80
Client 2: Processing batch 100
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 90
Client 2: Processing batch 110
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 100
Client 2: Processing batch 120
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 110
Client 2: Processing batch 130
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 120
Client 2: Processing batch 140
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 130
Client 2: Processing batch 150
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 140
Client 2: Processing batch 160
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 150
Client 2: Processing batch 170
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 4: Processing batch 160
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 170
Client 2: Processing batch 190
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 180
Client 2: Processing batch 200
Client 1: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 190
Client 2: Processing batch 210
Client 4: Processing batch 200
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.6424, mean Time to accident= 4.6841
Recall@80%, Time to accident= 4.537
Client 1: Epoch 4 validation AP = 0.6424
Client 1: Starting epoch 5/7
Client 1: Processing batch 0
Average Precision= 0.5511, mean Time to accident= 4.4375
Recall@80%, Time to accident= 4.35
Client 0: Epoch 4 validation AP = 0.5511
Client 0: Starting epoch 5/7
Average Precision= 0.3897, mean Time to accident= 4.5129
Recall@80%, Time to accident= 4.256
Client 3: Epoch 4 validation AP = 0.3897
Client 3: Starting epoch 5/7
Client 0: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.6347, mean Time to accident= 4.2659
Recall@80%, Time to accident= 3.919
Client 2: Epoch 4 validation AP = 0.6347
Client 2: Starting epoch 5/7
Client 2: Processing batch 0
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 30
Average Precision= 0.5685, mean Time to accident= 3.9170
Recall@80%, Time to accident= 3.868
Client 4: Epoch 4 validation AP = 0.5685
Client 4: Starting epoch 5/7
Client 0: Processing batch 30
Client 4: Processing batch 0
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 10
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 20
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 30
Client 2: Processing batch 60
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 40
Client 2: Processing batch 70
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 50
Client 2: Processing batch 80
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 60
Client 2: Processing batch 90
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 70
Client 2: Processing batch 100
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 80
Client 2: Processing batch 110
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 90
Client 2: Processing batch 120
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 100
Client 2: Processing batch 130
Client 1: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 110
Client 2: Processing batch 140
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 120
Client 2: Processing batch 150
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 130
Client 2: Processing batch 160
Client 1: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 140
Client 2: Processing batch 170
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 150
Client 2: Processing batch 180
Client 1: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 160
Client 2: Processing batch 190
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 170
Client 2: Processing batch 200
Client 1: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 180
Client 2: Processing batch 210
Client 4: Processing batch 190
Client 4: Processing batch 200
Client 4: Processing batch 210
Average Precision= 0.6110, mean Time to accident= 4.4130
Recall@80%, Time to accident= 4.494
Client 1: Epoch 5 validation AP = 0.6110
Client 1: Starting epoch 6/7
Client 4: Processing batch 220
Client 1: Processing batch 0
Average Precision= 0.4263, mean Time to accident= 4.4456
Recall@80%, Time to accident= 4.239
Client 3: Epoch 5 validation AP = 0.4263
Client 3: Starting epoch 6/7
Average Precision= 0.5095, mean Time to accident= 4.3535
Recall@80%, Time to accident= 3.906
Client 0: Epoch 5 validation AP = 0.5095
Client 0: Starting epoch 6/7
Client 3: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.7362, mean Time to accident= 4.1451
Recall@80%, Time to accident= 4.212
Client 2: Epoch 5 validation AP = 0.7362
Client 2: Starting epoch 6/7
Client 2: Processing batch 0
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 30
Average Precision= 0.5815, mean Time to accident= 3.7283
Recall@80%, Time to accident= 3.842
Client 4: Epoch 5 validation AP = 0.5815
Client 4: Starting epoch 6/7
Client 4: Processing batch 0
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 10
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 20
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 30
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 40
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 50
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 60
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 70
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 80
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 4: Processing batch 90
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 100
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 110
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 4: Processing batch 120
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 4: Processing batch 130
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 180
Client 4: Processing batch 140
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 190
Client 4: Processing batch 150
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 4: Processing batch 160
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 210
Client 4: Processing batch 170
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 180
Client 4: Processing batch 190
Client 4: Processing batch 200
Client 4: Processing batch 210
Average Precision= 0.6216, mean Time to accident= 4.1266
Recall@80%, Time to accident= 4.512
Client 1: Epoch 6 validation AP = 0.6216
Client 1: Starting epoch 7/7
Client 1: Processing batch 0
Average Precision= 0.5197, mean Time to accident= 4.3880
Recall@80%, Time to accident= 4.239
Client 0: Epoch 6 validation AP = 0.5197
Client 0: Starting epoch 7/7
Client 0: Processing batch 0
Average Precision= 0.4076, mean Time to accident= 4.3840
Recall@80%, Time to accident= 4.317
Client 3: Epoch 6 validation AP = 0.4076
Client 3: Starting epoch 7/7
Average Precision= 0.7216, mean Time to accident= 4.2130
Recall@80%, Time to accident= 3.682
Client 2: Epoch 6 validation AP = 0.7216
Client 2: Starting epoch 7/7
Client 3: Processing batch 0
Client 4: Processing batch 220
Client 2: Processing batch 0
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Average Precision= 0.5321, mean Time to accident= 3.8933
Recall@80%, Time to accident= 3.829
Client 4: Epoch 6 validation AP = 0.5321
Client 4: Starting epoch 7/7
Client 2: Processing batch 40
Client 4: Processing batch 0
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 4: Processing batch 10
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 20
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 30
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 40
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 50
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 60
Client 1: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 70
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 4: Processing batch 80
Client 1: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 90
Client 1: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 100
Client 1: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 4: Processing batch 110
Client 1: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 4: Processing batch 120
Client 1: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 4: Processing batch 130
Client 1: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 140
Client 1: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 150
Client 1: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 160
Client 1: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 4: Processing batch 170
Client 4: Processing batch 180
Client 4: Processing batch 190
Client 4: Processing batch 200
Average Precision= 0.5745, mean Time to accident= 4.7907
Recall@80%, Time to accident= 4.537
Client 1: Epoch 7 validation AP = 0.5745
Client 1: Loaded best model checkpoint with AP = 0.7575
[92mINFO [0m:      Sent reply
Average Precision= 0.4456, mean Time to accident= 4.2627
Recall@80%, Time to accident= 4.0
Client 3: Epoch 7 validation AP = 0.4456
Client 3: Loaded best model checkpoint with AP = 0.4659
[92mINFO [0m:      Sent reply
Client 4: Processing batch 210
Average Precision= 0.7556, mean Time to accident= 4.0249
Recall@80%, Time to accident= 3.823
Client 2: Epoch 7 validation AP = 0.7556
Client 2: Loaded best model checkpoint with AP = 0.7811
[92mINFO [0m:      Sent reply
Average Precision= 0.5101, mean Time to accident= 4.4672
Recall@80%, Time to accident= 4.406
Client 0: Epoch 7 validation AP = 0.5101
Client 0: Loaded best model checkpoint with AP = 0.5923
[92mINFO [0m:      Sent reply
Client 4: Processing batch 220
Average Precision= 0.5784, mean Time to accident= 3.8695
Recall@80%, Time to accident= 3.718
Client 4: Epoch 7 validation AP = 0.5784
Client 4: Loaded best model checkpoint with AP = 0.5906
[92mINFO [0m:      Sent reply
[92mINFO [0m:      aggregate_fit: received 5 results and 0 failures
Saved PR curve: results/federated/pr_curve_round_2.png
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0452, 0.9578]
Batch 0: pred_labels unique=[0 1], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0440, 0.8709]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.4153, 0.9603]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.5360, mean Time to accident= 4.3070
Recall@80%, Time to accident= 4.357

=== SERVER EVALUATION ROUND 3 ===
Confusion Matrix:
[[25391  4709]
 [10375  5525]]
Class-wise recall: [0.844 0.347]
==================================================
[92mINFO [0m:      fit progress: (3, 0.0, {'ap': 0.5359883341373026, 'mtta': 4.306993939372987, 'tta_r80': 4.357392825896763, 'recall_neg': 0.8435548172757475, 'recall_pos': 0.3474842767295597, 'pr_auc_frame': 0.5018370172208271}, 67937.20886821765)
[92mINFO [0m:      configure_evaluate: strategy sampled 5 clients (out of 5)
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message ad7da83b-316d-4f06-9b52-04deb3e90cfa
Client 2: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message d844656d-aa46-4b86-82d0-43676ec5af25
Client 4: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 0400abbb-ea13-432b-824e-25a515bdc7da
Client 0: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 64259e2c-8bc3-402c-9be1-0a767c085c50
Client 3: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message ed3daf6e-4260-468d-a09f-359e00f1e500
Client 1: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      aggregate_evaluate: received 5 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 5 clients (out of 5)
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 371503a7-acba-47f7-b3cb-e264740dc82c
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 7af83569-b481-436f-8d7b-20ce57099645
Average Precision= 0.7418, mean Time to accident= 4.2320
Recall@80%, Time to accident= 3.949
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 2: Starting epoch 1/7
Average Precision= 0.6217, mean Time to accident= 4.5777
Recall@80%, Time to accident= 4.479
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 4: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 6fc1576c-2534-4669-8318-f0ac31a35149
Average Precision= 0.4740, mean Time to accident= 4.1770
Recall@80%, Time to accident= 4.139
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 3: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 7664f711-a4a0-4f5d-9cb8-eff2d8735a33
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 2f2d546d-1b31-4e13-b457-92d028119d30
Average Precision= 0.5858, mean Time to accident= 4.6753
Recall@80%, Time to accident= 4.306
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 0: Starting epoch 1/7
Average Precision= 0.6442, mean Time to accident= 4.4306
Recall@80%, Time to accident= 4.593
Client 1: Reset optimizer and scheduler state after loading server parameters
Client 1: Starting epoch 1/7
Client 2: Processing batch 0
Client 0: Processing batch 0
Client 1: Processing batch 0
Client 3: Processing batch 0
Client 4: Processing batch 0
Client 2: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 30
Client 4: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 50
Client 4: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 120
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 160
Client 4: Processing batch 160
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 170
Client 4: Processing batch 170
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 180
Client 4: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 4: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 4: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 210
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.6528, mean Time to accident= 3.9630
Recall@80%, Time to accident= 3.404
Client 2: Epoch 1 validation AP = 0.6528
Client 2: New best AP = 0.6528, saving checkpoint
Client 2: Starting epoch 2/7
Client 2: Processing batch 0
Average Precision= 0.6372, mean Time to accident= 4.3920
Recall@80%, Time to accident= 3.806
Client 0: Epoch 1 validation AP = 0.6372
Client 0: New best AP = 0.6372, saving checkpoint
Client 0: Starting epoch 2/7
Average Precision= 0.5117, mean Time to accident= 4.5047
Recall@80%, Time to accident= 4.426
Client 1: Epoch 1 validation AP = 0.5117
Client 1: New best AP = 0.5117, saving checkpoint
Client 1: Starting epoch 2/7
Client 0: Processing batch 0
Average Precision= 0.4396, mean Time to accident= 3.1883
Recall@80%, Time to accident= 3.517
Client 3: Epoch 1 validation AP = 0.4396
Client 3: New best AP = 0.4396, saving checkpoint
Client 3: Starting epoch 2/7
Client 1: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.5883, mean Time to accident= 4.3918
Recall@80%, Time to accident= 4.419
Client 4: Epoch 1 validation AP = 0.5883
Client 4: New best AP = 0.5883, saving checkpoint
Client 4: Starting epoch 2/7
Client 4: Processing batch 0
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 70
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 130
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 140
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 150
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 160
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 170
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 180
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 190
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 200
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.6480, mean Time to accident= 4.3629
Recall@80%, Time to accident= 4.146
Client 2: Epoch 2 validation AP = 0.6480
Client 2: Starting epoch 3/7
Average Precision= 0.5697, mean Time to accident= 4.6954
Recall@80%, Time to accident= 4.144
Client 0: Epoch 2 validation AP = 0.5697
Client 0: Starting epoch 3/7
Client 2: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.4452, mean Time to accident= 3.8598
Recall@80%, Time to accident= 3.528
Client 3: Epoch 2 validation AP = 0.4452
Client 3: New best AP = 0.4452, saving checkpoint
Client 3: Starting epoch 3/7
Client 3: Processing batch 0
Average Precision= 0.7075, mean Time to accident= 4.3391
Recall@80%, Time to accident= 4.272
Client 1: Epoch 2 validation AP = 0.7075
Client 1: New best AP = 0.7075, saving checkpoint
Client 1: Starting epoch 3/7
Client 1: Processing batch 0
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Average Precision= 0.6021, mean Time to accident= 4.1662
Recall@80%, Time to accident= 4.269
Client 4: Epoch 2 validation AP = 0.6021
Client 4: New best AP = 0.6021, saving checkpoint
Client 4: Starting epoch 3/7
Client 4: Processing batch 0
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 10
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 20
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 30
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 40
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 50
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 60
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 70
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 80
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 90
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 100
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 110
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 120
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 130
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 140
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 150
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 160
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 170
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 180
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 190
Client 1: Processing batch 200
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 200
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.6518, mean Time to accident= 4.6920
Recall@80%, Time to accident= 4.517
Client 0: Epoch 3 validation AP = 0.6518
Client 0: New best AP = 0.6518, saving checkpoint
Client 0: Starting epoch 4/7
Average Precision= 0.6926, mean Time to accident= 4.0699
Recall@80%, Time to accident= 3.985
Client 2: Epoch 3 validation AP = 0.6926
Client 2: New best AP = 0.6926, saving checkpoint
Client 2: Starting epoch 4/7
Client 0: Processing batch 0
Client 2: Processing batch 0
Average Precision= 0.4063, mean Time to accident= 4.2721
Recall@80%, Time to accident= 4.472
Client 3: Epoch 3 validation AP = 0.4063
Client 3: Starting epoch 4/7
Client 3: Processing batch 0
Average Precision= 0.6212, mean Time to accident= 4.6045
Recall@80%, Time to accident= 4.549
Client 1: Epoch 3 validation AP = 0.6212
Client 1: Starting epoch 4/7
Client 1: Processing batch 0
Client 0: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 0: Processing batch 20
Client 2: Processing batch 20
Average Precision= 0.6267, mean Time to accident= 4.2695
Recall@80%, Time to accident= 4.115
Client 4: Epoch 3 validation AP = 0.6267
Client 4: New best AP = 0.6267, saving checkpoint
Client 4: Starting epoch 4/7
Client 4: Processing batch 0
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 4: Processing batch 10
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 4: Processing batch 20
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 30
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 40
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 0: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 50
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 60
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 70
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 0: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 80
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 0: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 90
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 100
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 110
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 120
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 130
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 4: Processing batch 140
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 150
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 160
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 170
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 180
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 4: Processing batch 190
Client 1: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 200
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.7645, mean Time to accident= 4.2579
Recall@80%, Time to accident= 4.197
Client 2: Epoch 4 validation AP = 0.7645
Client 2: New best AP = 0.7645, saving checkpoint
Client 2: Starting epoch 5/7
Average Precision= 0.6194, mean Time to accident= 4.7081
Recall@80%, Time to accident= 4.572
Client 0: Epoch 4 validation AP = 0.6194
Client 0: Starting epoch 5/7
Client 2: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.4653, mean Time to accident= 3.4659
Recall@80%, Time to accident= 3.489
Client 3: Epoch 4 validation AP = 0.4653
Client 3: New best AP = 0.4653, saving checkpoint
Client 3: Starting epoch 5/7
Client 3: Processing batch 0
Average Precision= 0.6937, mean Time to accident= 4.4972
Recall@80%, Time to accident= 4.364
Client 1: Epoch 4 validation AP = 0.6937
Client 1: Starting epoch 5/7
Client 1: Processing batch 0
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 20
Average Precision= 0.5102, mean Time to accident= 4.2056
Recall@80%, Time to accident= 4.158
Client 4: Epoch 4 validation AP = 0.5102
Client 4: Starting epoch 5/7
Client 4: Processing batch 0
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 10
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 20
Client 0: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 30
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 40
Client 0: Processing batch 70
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 50
Client 0: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 60
Client 0: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 70
Client 0: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 0: Processing batch 110
Client 4: Processing batch 80
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 0: Processing batch 120
Client 4: Processing batch 90
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 0: Processing batch 130
Client 4: Processing batch 100
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 0: Processing batch 140
Client 4: Processing batch 110
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 150
Client 1: Processing batch 140
Client 4: Processing batch 120
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 160
Client 1: Processing batch 150
Client 4: Processing batch 130
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 170
Client 1: Processing batch 160
Client 4: Processing batch 140
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 180
Client 4: Processing batch 150
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 0: Processing batch 190
Client 4: Processing batch 160
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 0: Processing batch 200
Client 4: Processing batch 170
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 0: Processing batch 210
Client 4: Processing batch 180
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 190
Client 1: Processing batch 210
Client 4: Processing batch 200
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.6701, mean Time to accident= 4.4456
Recall@80%, Time to accident= 4.583
Client 0: Epoch 5 validation AP = 0.6701
Client 0: New best AP = 0.6701, saving checkpoint
Client 0: Starting epoch 6/7
Client 0: Processing batch 0
Average Precision= 0.7612, mean Time to accident= 4.1920
Recall@80%, Time to accident= 3.838
Client 2: Epoch 5 validation AP = 0.7612
Client 2: Starting epoch 6/7
Client 2: Processing batch 0
Average Precision= 0.4808, mean Time to accident= 4.1328
Recall@80%, Time to accident= 4.067
Client 3: Epoch 5 validation AP = 0.4808
Client 3: New best AP = 0.4808, saving checkpoint
Client 3: Starting epoch 6/7
Client 3: Processing batch 0
Client 0: Processing batch 10
Average Precision= 0.5762, mean Time to accident= 4.6261
Recall@80%, Time to accident= 4.179
Client 1: Epoch 5 validation AP = 0.5762
Client 1: Starting epoch 6/7
Client 1: Processing batch 0
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 0: Processing batch 20
Client 1: Processing batch 10
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 30
Client 1: Processing batch 20
Client 2: Processing batch 30
Average Precision= 0.5073, mean Time to accident= 4.1996
Recall@80%, Time to accident= 4.226
Client 4: Epoch 5 validation AP = 0.5073
Client 4: Starting epoch 6/7
Client 3: Processing batch 30
Client 4: Processing batch 0
Client 0: Processing batch 40
Client 1: Processing batch 30
Client 2: Processing batch 40
Client 4: Processing batch 10
Client 3: Processing batch 40
Client 0: Processing batch 50
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 4: Processing batch 20
Client 3: Processing batch 50
Client 0: Processing batch 60
Client 1: Processing batch 50
Client 2: Processing batch 60
Client 4: Processing batch 30
Client 3: Processing batch 60
Client 0: Processing batch 70
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 4: Processing batch 40
Client 3: Processing batch 70
Client 0: Processing batch 80
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 50
Client 0: Processing batch 90
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 60
Client 0: Processing batch 100
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 70
Client 0: Processing batch 110
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 80
Client 0: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 90
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 100
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 1: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 110
Client 0: Processing batch 150
Client 2: Processing batch 150
Client 1: Processing batch 140
Client 3: Processing batch 150
Client 4: Processing batch 120
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 130
Client 0: Processing batch 170
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 140
Client 0: Processing batch 180
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 150
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 180
Client 3: Processing batch 190
Client 4: Processing batch 160
Client 0: Processing batch 200
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 170
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 200
Client 3: Processing batch 210
Client 4: Processing batch 180
Client 1: Processing batch 210
Client 4: Processing batch 190
Client 4: Processing batch 200
Client 4: Processing batch 210
Average Precision= 0.7447, mean Time to accident= 4.1716
Recall@80%, Time to accident= 3.813
Client 2: Epoch 6 validation AP = 0.7447
Client 2: Starting epoch 7/7
Average Precision= 0.6068, mean Time to accident= 4.6568
Recall@80%, Time to accident= 4.556
Client 0: Epoch 6 validation AP = 0.6068
Client 0: Starting epoch 7/7
Client 2: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.4369, mean Time to accident= 3.9920
Recall@80%, Time to accident= 3.972
Client 3: Epoch 6 validation AP = 0.4369
Client 3: Starting epoch 7/7
Client 3: Processing batch 0
Client 4: Processing batch 220
Average Precision= 0.7315, mean Time to accident= 4.0003
Recall@80%, Time to accident= 4.093
Client 1: Epoch 6 validation AP = 0.7315
Client 1: New best AP = 0.7315, saving checkpoint
Client 1: Starting epoch 7/7
Client 1: Processing batch 0
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 20
Client 1: Processing batch 10
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 30
Client 1: Processing batch 20
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 40
Client 1: Processing batch 30
Client 0: Processing batch 40
Client 3: Processing batch 40
Average Precision= 0.5214, mean Time to accident= 4.1627
Recall@80%, Time to accident= 3.872
Client 4: Epoch 6 validation AP = 0.5214
Client 4: Starting epoch 7/7
Client 4: Processing batch 0
Client 2: Processing batch 50
Client 1: Processing batch 40
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 10
Client 1: Processing batch 50
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 20
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 30
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 40
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 50
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 60
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 70
Client 1: Processing batch 110
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 80
Client 1: Processing batch 120
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 90
Client 1: Processing batch 130
Client 0: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 100
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 110
Client 1: Processing batch 150
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 120
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 130
Client 1: Processing batch 170
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 140
Client 1: Processing batch 180
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 150
Client 1: Processing batch 190
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 160
Client 1: Processing batch 200
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 170
Client 1: Processing batch 210
Client 4: Processing batch 180
Client 4: Processing batch 190
Client 4: Processing batch 200
Average Precision= 0.6839, mean Time to accident= 4.5498
Recall@80%, Time to accident= 4.556
Client 0: Epoch 7 validation AP = 0.6839
Client 0: New best AP = 0.6839, saving checkpoint
Client 0: Loaded best model checkpoint with AP = 0.6839
[92mINFO [0m:      Sent reply
Client 4: Processing batch 210
Average Precision= 0.6842, mean Time to accident= 4.1223
Recall@80%, Time to accident= 4.465
Client 2: Epoch 7 validation AP = 0.6842
Client 2: Loaded best model checkpoint with AP = 0.7645
[92mINFO [0m:      Sent reply
Average Precision= 0.4175, mean Time to accident= 4.0411
Recall@80%, Time to accident= 3.667
Client 3: Epoch 7 validation AP = 0.4175
Client 3: Loaded best model checkpoint with AP = 0.4808
[92mINFO [0m:      Sent reply
Average Precision= 0.7404, mean Time to accident= 4.3847
Recall@80%, Time to accident= 4.426
Client 1: Epoch 7 validation AP = 0.7404
Client 1: New best AP = 0.7404, saving checkpoint
Client 1: Loaded best model checkpoint with AP = 0.7404
[92mINFO [0m:      Sent reply
Client 4: Processing batch 220
Average Precision= 0.5370, mean Time to accident= 4.2039
Recall@80%, Time to accident= 4.162
Client 4: Epoch 7 validation AP = 0.5370
Client 4: Loaded best model checkpoint with AP = 0.6267
[92mINFO [0m:      Sent reply
[92mINFO [0m:      aggregate_fit: received 5 results and 0 failures
Saved PR curve: results/federated/pr_curve_round_3.png
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0049, 0.9863]
Batch 0: pred_labels unique=[0 1], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0522, 0.9941]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.4731, 0.9929]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.5219, mean Time to accident= 4.1097
Recall@80%, Time to accident= 4.269

=== SERVER EVALUATION ROUND 4 ===
Confusion Matrix:
[[24645  5455]
 [ 9729  6171]]
Class-wise recall: [0.819 0.388]
==================================================
[92mINFO [0m:      fit progress: (4, 0.0, {'ap': 0.5219384656041219, 'mtta': 4.109657994122559, 'tta_r80': 4.269028871391076, 'recall_neg': 0.8187707641196014, 'recall_pos': 0.3881132075471698, 'pr_auc_frame': 0.5083063750055745}, 90951.6850258587)
[92mINFO [0m:      configure_evaluate: strategy sampled 5 clients (out of 5)
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 80d316ed-f3c6-4dfb-bbfb-37ccec66cb8b
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 94760eba-f3e1-4269-a042-8264c3361c27
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 3: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message d8feef99-09cc-431d-b3f1-69a627565627
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message ce67bb92-fd02-48f8-99b0-d31ce594914d
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 4: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message e4fb4eaf-3197-402a-82b0-86b390b1c0ae
Client 1: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      aggregate_evaluate: received 5 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 5 clients (out of 5)
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 88f8b4e9-064b-4ed1-89f8-8c4afdaaa4b8
Average Precision= 0.6228, mean Time to accident= 4.6588
Recall@80%, Time to accident= 4.206
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 0: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message d80e0b20-bfde-4b36-adc0-c37744dcac81
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 6768c22b-bd46-460c-b238-0c32ee24148d
Average Precision= 0.5808, mean Time to accident= 4.6201
Recall@80%, Time to accident= 4.556
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 4: Starting epoch 1/7
Average Precision= 0.7411, mean Time to accident= 4.4423
Recall@80%, Time to accident= 4.818
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 2: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 9b3757d1-07ae-4855-87f8-bc3a1962494e
Average Precision= 0.4723, mean Time to accident= 4.4105
Recall@80%, Time to accident= 4.25
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 3: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 88d597a2-e3cd-4fde-b260-63b05c73a931
Average Precision= 0.4962, mean Time to accident= 4.5914
Recall@80%, Time to accident= 4.593
Client 1: Reset optimizer and scheduler state after loading server parameters
Client 1: Starting epoch 1/7
Client 0: Processing batch 0
Client 4: Processing batch 0
Client 2: Processing batch 0
Client 3: Processing batch 0
Client 1: Processing batch 0
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 0: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 120
Client 4: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 210
Client 0: Processing batch 210
Client 4: Processing batch 210
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.4922, mean Time to accident= 3.9480
Recall@80%, Time to accident= 3.79
Client 1: Epoch 1 validation AP = 0.4922
Client 1: New best AP = 0.4922, saving checkpoint
Client 1: Starting epoch 2/7
Average Precision= 0.3675, mean Time to accident= 4.6021
Recall@80%, Time to accident= 4.539
Client 0: Epoch 1 validation AP = 0.3675
Client 0: New best AP = 0.3675, saving checkpoint
Client 0: Starting epoch 2/7
Client 1: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.7319, mean Time to accident= 4.1977
Recall@80%, Time to accident= 4.177
Client 2: Epoch 1 validation AP = 0.7319
Client 2: New best AP = 0.7319, saving checkpoint
Client 2: Starting epoch 2/7
Client 2: Processing batch 0
Average Precision= 0.4553, mean Time to accident= 4.2949
Recall@80%, Time to accident= 3.811
Client 3: Epoch 1 validation AP = 0.4553
Client 3: New best AP = 0.4553, saving checkpoint
Client 3: Starting epoch 2/7
Client 3: Processing batch 0
Average Precision= 0.7289, mean Time to accident= 4.2497
Recall@80%, Time to accident= 3.987
Client 4: Epoch 1 validation AP = 0.7289
Client 4: New best AP = 0.7289, saving checkpoint
Client 4: Starting epoch 2/7
Client 4: Processing batch 0
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 20
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 3: Processing batch 30
Client 4: Processing batch 30
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 40
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 50
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 2: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 70
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 90
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 110
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 120
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 140
Client 4: Processing batch 130
Client 1: Processing batch 140
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 150
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 160
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 170
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 180
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 190
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 200
Client 1: Processing batch 210
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.5588, mean Time to accident= 3.7458
Recall@80%, Time to accident= 3.654
Client 1: Epoch 2 validation AP = 0.5588
Client 1: New best AP = 0.5588, saving checkpoint
Client 1: Starting epoch 3/7
Client 1: Processing batch 0
Average Precision= 0.6091, mean Time to accident= 4.7754
Recall@80%, Time to accident= 4.372
Client 0: Epoch 2 validation AP = 0.6091
Client 0: New best AP = 0.6091, saving checkpoint
Client 0: Starting epoch 3/7
Client 0: Processing batch 0
Average Precision= 0.7644, mean Time to accident= 4.2569
Recall@80%, Time to accident= 4.833
Client 2: Epoch 2 validation AP = 0.7644
Client 2: New best AP = 0.7644, saving checkpoint
Client 2: Starting epoch 3/7
Average Precision= 0.4813, mean Time to accident= 4.1818
Recall@80%, Time to accident= 3.906
Client 3: Epoch 2 validation AP = 0.4813
Client 3: New best AP = 0.4813, saving checkpoint
Client 3: Starting epoch 3/7
Client 2: Processing batch 0
Client 3: Processing batch 0
Client 1: Processing batch 10
Client 0: Processing batch 10
Average Precision= 0.6834, mean Time to accident= 4.5545
Recall@80%, Time to accident= 4.355
Client 4: Epoch 2 validation AP = 0.6834
Client 4: Starting epoch 3/7
Client 2: Processing batch 10
Client 4: Processing batch 0
Client 3: Processing batch 10
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 2: Processing batch 20
Client 4: Processing batch 10
Client 3: Processing batch 20
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 2: Processing batch 30
Client 4: Processing batch 20
Client 3: Processing batch 30
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 2: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 30
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 2: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 40
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 4: Processing batch 50
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 4: Processing batch 60
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 4: Processing batch 70
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 4: Processing batch 80
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 4: Processing batch 90
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 4: Processing batch 100
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 110
Client 2: Processing batch 120
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 120
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 4: Processing batch 130
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 4: Processing batch 140
Client 1: Processing batch 160
Client 0: Processing batch 160
Client 2: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 150
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 160
Client 1: Processing batch 180
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 170
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 180
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 4: Processing batch 190
Client 1: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 200
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.5729, mean Time to accident= 4.8128
Recall@80%, Time to accident= 4.517
Client 0: Epoch 3 validation AP = 0.5729
Client 0: Starting epoch 4/7
Average Precision= 0.5682, mean Time to accident= 3.9203
Recall@80%, Time to accident= 4.111
Client 1: Epoch 3 validation AP = 0.5682
Client 1: New best AP = 0.5682, saving checkpoint
Client 1: Starting epoch 4/7
Client 0: Processing batch 0
Client 1: Processing batch 0
Average Precision= 0.4691, mean Time to accident= 3.9178
Recall@80%, Time to accident= 4.461
Client 3: Epoch 3 validation AP = 0.4691
Client 3: Starting epoch 4/7
Average Precision= 0.8328, mean Time to accident= 4.0879
Recall@80%, Time to accident= 4.106
Client 2: Epoch 3 validation AP = 0.8328
Client 2: New best AP = 0.8328, saving checkpoint
Client 2: Starting epoch 4/7
Client 3: Processing batch 0
Client 2: Processing batch 0
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 20
Client 0: Processing batch 20
Average Precision= 0.6245, mean Time to accident= 4.0813
Recall@80%, Time to accident= 4.205
Client 4: Epoch 3 validation AP = 0.6245
Client 4: Starting epoch 4/7
Client 4: Processing batch 0
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 4: Processing batch 10
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 20
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 30
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 40
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 50
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 60
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 1: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 70
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 1: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 80
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 90
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 100
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 110
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 120
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 130
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 140
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 4: Processing batch 150
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 160
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 170
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 180
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 210
Client 0: Processing batch 210
Client 4: Processing batch 190
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 200
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.4443, mean Time to accident= 3.9148
Recall@80%, Time to accident= 3.809
Client 1: Epoch 4 validation AP = 0.4443
Client 1: Starting epoch 5/7
Average Precision= 0.5785, mean Time to accident= 4.3331
Recall@80%, Time to accident= 4.344
Client 0: Epoch 4 validation AP = 0.5785
Client 0: Starting epoch 5/7
Client 1: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.4201, mean Time to accident= 3.7480
Recall@80%, Time to accident= 4.028
Client 3: Epoch 4 validation AP = 0.4201
Client 3: Starting epoch 5/7
Client 3: Processing batch 0
Average Precision= 0.6812, mean Time to accident= 3.9329
Recall@80%, Time to accident= 3.98
Client 2: Epoch 4 validation AP = 0.6812
Client 2: Starting epoch 5/7
Client 2: Processing batch 0
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 10
Client 1: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Average Precision= 0.5931, mean Time to accident= 4.1712
Recall@80%, Time to accident= 4.15
Client 4: Epoch 4 validation AP = 0.5931
Client 4: Starting epoch 5/7
Client 1: Processing batch 30
Client 4: Processing batch 0
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 30
Client 1: Processing batch 40
Client 4: Processing batch 10
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 40
Client 1: Processing batch 50
Client 4: Processing batch 20
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 50
Client 1: Processing batch 60
Client 4: Processing batch 30
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 60
Client 1: Processing batch 70
Client 4: Processing batch 40
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 70
Client 1: Processing batch 80
Client 4: Processing batch 50
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 80
Client 1: Processing batch 90
Client 4: Processing batch 60
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 2: Processing batch 90
Client 1: Processing batch 100
Client 4: Processing batch 70
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 100
Client 1: Processing batch 110
Client 4: Processing batch 80
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 120
Client 4: Processing batch 90
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 120
Client 1: Processing batch 130
Client 4: Processing batch 100
Client 0: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 130
Client 1: Processing batch 140
Client 4: Processing batch 110
Client 0: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 1: Processing batch 150
Client 4: Processing batch 120
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 1: Processing batch 160
Client 4: Processing batch 130
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 1: Processing batch 170
Client 4: Processing batch 140
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 180
Client 4: Processing batch 150
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 1: Processing batch 190
Client 4: Processing batch 160
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 200
Client 4: Processing batch 170
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 210
Client 4: Processing batch 180
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 190
Client 4: Processing batch 200
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.6125, mean Time to accident= 3.3558
Recall@80%, Time to accident= 3.753
Client 1: Epoch 5 validation AP = 0.6125
Client 1: New best AP = 0.6125, saving checkpoint
Client 1: Starting epoch 6/7
Client 1: Processing batch 0
Average Precision= 0.6181, mean Time to accident= 4.2799
Recall@80%, Time to accident= 4.4
Client 0: Epoch 5 validation AP = 0.6181
Client 0: New best AP = 0.6181, saving checkpoint
Client 0: Starting epoch 6/7
Client 0: Processing batch 0
Average Precision= 0.4830, mean Time to accident= 3.7601
Recall@80%, Time to accident= 4.061
Client 3: Epoch 5 validation AP = 0.4830
Client 3: New best AP = 0.4830, saving checkpoint
Client 3: Starting epoch 6/7
Client 3: Processing batch 0
Average Precision= 0.6932, mean Time to accident= 4.1879
Recall@80%, Time to accident= 4.455
Client 2: Epoch 5 validation AP = 0.6932
Client 2: Starting epoch 6/7
Client 1: Processing batch 10
Client 2: Processing batch 0
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 20
Client 2: Processing batch 10
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 20
Client 1: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Average Precision= 0.6497, mean Time to accident= 4.1408
Recall@80%, Time to accident= 4.004
Client 4: Epoch 5 validation AP = 0.6497
Client 4: Starting epoch 6/7
Client 4: Processing batch 0
Client 2: Processing batch 30
Client 1: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 10
Client 2: Processing batch 40
Client 1: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 20
Client 2: Processing batch 50
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 30
Client 2: Processing batch 60
Client 1: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 40
Client 2: Processing batch 70
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 50
Client 1: Processing batch 90
Client 2: Processing batch 80
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 60
Client 1: Processing batch 100
Client 2: Processing batch 90
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 70
Client 1: Processing batch 110
Client 2: Processing batch 100
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 110
Client 1: Processing batch 120
Client 4: Processing batch 80
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 130
Client 4: Processing batch 90
Client 1: Processing batch 130
Client 2: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 100
Client 2: Processing batch 130
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 140
Client 2: Processing batch 140
Client 0: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 110
Client 3: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 120
Client 3: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 130
Client 3: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 140
Client 3: Processing batch 180
Client 2: Processing batch 180
Client 1: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 150
Client 3: Processing batch 190
Client 1: Processing batch 200
Client 2: Processing batch 190
Client 4: Processing batch 160
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 210
Client 2: Processing batch 200
Client 4: Processing batch 170
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 180
Client 4: Processing batch 190
Client 4: Processing batch 200
Client 4: Processing batch 210
Average Precision= 0.4333, mean Time to accident= 3.8849
Recall@80%, Time to accident= 3.802
Client 1: Epoch 6 validation AP = 0.4333
Client 1: Starting epoch 7/7
Average Precision= 0.6145, mean Time to accident= 4.1862
Recall@80%, Time to accident= 4.567
Client 0: Epoch 6 validation AP = 0.6145
Client 0: Starting epoch 7/7
Client 1: Processing batch 0
Client 0: Processing batch 0
Average Precision= 0.4608, mean Time to accident= 3.8835
Recall@80%, Time to accident= 4.106
Client 3: Epoch 6 validation AP = 0.4608
Client 3: Starting epoch 7/7
Client 3: Processing batch 0
Client 4: Processing batch 220
Average Precision= 0.7185, mean Time to accident= 4.0091
Recall@80%, Time to accident= 4.364
Client 2: Epoch 6 validation AP = 0.7185
Client 2: Starting epoch 7/7
Client 1: Processing batch 10
Client 0: Processing batch 10
Client 2: Processing batch 0
Client 3: Processing batch 10
Client 1: Processing batch 20
Client 2: Processing batch 10
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 30
Client 2: Processing batch 20
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 40
Client 2: Processing batch 30
Client 0: Processing batch 40
Client 3: Processing batch 40
Average Precision= 0.5928, mean Time to accident= 4.0625
Recall@80%, Time to accident= 4.214
Client 4: Epoch 6 validation AP = 0.5928
Client 4: Starting epoch 7/7
Client 4: Processing batch 0
Client 1: Processing batch 50
Client 2: Processing batch 40
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 10
Client 1: Processing batch 60
Client 0: Processing batch 60
Client 2: Processing batch 50
Client 3: Processing batch 60
Client 4: Processing batch 20
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 60
Client 3: Processing batch 70
Client 4: Processing batch 30
Client 1: Processing batch 80
Client 0: Processing batch 80
Client 2: Processing batch 70
Client 3: Processing batch 80
Client 4: Processing batch 40
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 80
Client 4: Processing batch 50
Client 3: Processing batch 90
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 90
Client 3: Processing batch 100
Client 4: Processing batch 60
Client 1: Processing batch 110
Client 0: Processing batch 110
Client 2: Processing batch 100
Client 3: Processing batch 110
Client 4: Processing batch 70
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 110
Client 3: Processing batch 120
Client 4: Processing batch 80
Client 1: Processing batch 130
Client 0: Processing batch 130
Client 2: Processing batch 120
Client 3: Processing batch 130
Client 4: Processing batch 90
Client 1: Processing batch 140
Client 0: Processing batch 140
Client 2: Processing batch 130
Client 3: Processing batch 140
Client 4: Processing batch 100
Client 1: Processing batch 150
Client 0: Processing batch 150
Client 2: Processing batch 140
Client 3: Processing batch 150
Client 4: Processing batch 110
Client 0: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 150
Client 3: Processing batch 160
Client 4: Processing batch 120
Client 1: Processing batch 170
Client 0: Processing batch 170
Client 2: Processing batch 160
Client 4: Processing batch 130
Client 3: Processing batch 170
Client 0: Processing batch 180
Client 1: Processing batch 180
Client 2: Processing batch 170
Client 4: Processing batch 140
Client 3: Processing batch 180
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 180
Client 4: Processing batch 150
Client 3: Processing batch 190
Client 1: Processing batch 200
Client 0: Processing batch 200
Client 2: Processing batch 190
Client 4: Processing batch 160
Client 3: Processing batch 200
Client 1: Processing batch 210
Client 0: Processing batch 210
Client 2: Processing batch 200
Client 4: Processing batch 170
Client 3: Processing batch 210
Client 2: Processing batch 210
Client 4: Processing batch 180
Client 4: Processing batch 190
Client 4: Processing batch 200
Average Precision= 0.5928, mean Time to accident= 4.1667
Recall@80%, Time to accident= 4.394
Client 0: Epoch 7 validation AP = 0.5928
Client 0: Loaded best model checkpoint with AP = 0.6181
[92mINFO [0m:      Sent reply
Average Precision= 0.4668, mean Time to accident= 3.8849
Recall@80%, Time to accident= 3.926
Client 1: Epoch 7 validation AP = 0.4668
Client 1: Loaded best model checkpoint with AP = 0.6125
[92mINFO [0m:      Sent reply
Client 4: Processing batch 210
Average Precision= 0.4638, mean Time to accident= 3.6199
Recall@80%, Time to accident= 4.106
Client 3: Epoch 7 validation AP = 0.4638
Client 3: Loaded best model checkpoint with AP = 0.4830
[92mINFO [0m:      Sent reply
Client 4: Processing batch 220
Average Precision= 0.7344, mean Time to accident= 4.2974
Recall@80%, Time to accident= 4.343
Client 2: Epoch 7 validation AP = 0.7344
Client 2: Loaded best model checkpoint with AP = 0.8328
[92mINFO [0m:      Sent reply
Average Precision= 0.6426, mean Time to accident= 4.0514
Recall@80%, Time to accident= 3.996
Client 4: Epoch 7 validation AP = 0.6426
Client 4: Loaded best model checkpoint with AP = 0.7289
[92mINFO [0m:      Sent reply
[92mINFO [0m:      aggregate_fit: received 5 results and 0 failures
Saved PR curve: results/federated/pr_curve_round_4.png
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0031, 0.9973]
Batch 0: pred_labels unique=[0 1], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0141, 0.9942]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.5878, 0.9967]
Batch 2: pred_labels unique=[1], y unique=[1]
Average Precision= 0.5418, mean Time to accident= 3.9818
Recall@80%, Time to accident= 4.161

=== SERVER EVALUATION ROUND 5 ===
Confusion Matrix:
[[24979  5121]
 [ 9611  6289]]
Class-wise recall: [0.83  0.396]
==================================================
[92mINFO [0m:      fit progress: (5, 0.0, {'ap': 0.5418047080449524, 'mtta': 3.981771486394006, 'tta_r80': 4.1605424321959745, 'recall_neg': 0.8298671096345515, 'recall_pos': 0.39553459119496853, 'pr_auc_frame': 0.5211904240709979}, 113921.14487638976)
[92mINFO [0m:      configure_evaluate: strategy sampled 5 clients (out of 5)
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 4879e003-6026-43ed-95f1-e91df20e1a94
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 197529de-8e6b-49c3-b507-875229bd9f09
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 0: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 89f953a8-078c-4dcb-928e-2555c2e081af
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 7ca143fa-48be-4032-bfca-485c90cf902f
Client 1: Reset optimizer and scheduler state after loading server parameters
Client 3: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 3e454f9a-98e6-4ed4-b378-ce864f14da87
Client 4: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      aggregate_evaluate: received 5 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 5 clients (out of 5)
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 11b99bb9-8438-49df-b49b-bb31ee7b2dbf
Average Precision= 0.8092, mean Time to accident= 4.2865
Recall@80%, Time to accident= 4.5
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 2: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 82ea8c6f-a7d5-4b02-9782-919f0c5ebe29
Average Precision= 0.5883, mean Time to accident= 4.0845
Recall@80%, Time to accident= 4.37
Client 1: Reset optimizer and scheduler state after loading server parameters
Client 1: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message d40cdedc-63d8-4911-99a1-737ff9607637
Average Precision= 0.6404, mean Time to accident= 4.5048
Recall@80%, Time to accident= 4.333
Client 0: Reset optimizer and scheduler state after loading server parameters
Client 0: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message f1a3e967-2112-42c4-b3c6-3f3dfb748a35
Average Precision= 0.5485, mean Time to accident= 4.3954
Recall@80%, Time to accident= 3.906
Client 4: Reset optimizer and scheduler state after loading server parameters
Client 4: Starting epoch 1/7
[92mINFO [0m:      
[92mINFO [0m:      Received: train message 26f55ee9-89e3-4db5-9c57-9074ce930018
Average Precision= 0.4336, mean Time to accident= 3.7369
Recall@80%, Time to accident= 4.306
Client 3: Reset optimizer and scheduler state after loading server parameters
Client 3: Starting epoch 1/7
Client 2: Processing batch 0
Client 0: Processing batch 0
Client 1: Processing batch 0
Client 4: Processing batch 0
Client 3: Processing batch 0
Client 2: Processing batch 10
Client 3: Processing batch 10
Client 4: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 20
Client 4: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 30
Client 4: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 4: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 50
Client 1: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 4: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 90
Client 4: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 4: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 110
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 120
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 130
Client 4: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 140
Client 4: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 150
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 160
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 170
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 180
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 190
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 200
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 210
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.5617, mean Time to accident= 4.2741
Recall@80%, Time to accident= 4.5
Client 2: Epoch 1 validation AP = 0.5617
Client 2: New best AP = 0.5617, saving checkpoint
Client 2: Starting epoch 2/7
Client 2: Processing batch 0
Average Precision= 0.6680, mean Time to accident= 4.5876
Recall@80%, Time to accident= 4.2
Client 0: Epoch 1 validation AP = 0.6680
Client 0: New best AP = 0.6680, saving checkpoint
Client 0: Starting epoch 2/7
Average Precision= 0.4134, mean Time to accident= 3.9491
Recall@80%, Time to accident= 3.661
Client 3: Epoch 1 validation AP = 0.4134
Client 3: New best AP = 0.4134, saving checkpoint
Client 3: Starting epoch 2/7
Client 0: Processing batch 0
Client 3: Processing batch 0
Average Precision= 0.4603, mean Time to accident= 4.8348
Recall@80%, Time to accident= 4.574
Client 1: Epoch 1 validation AP = 0.4603
Client 1: New best AP = 0.4603, saving checkpoint
Client 1: Starting epoch 2/7
Client 1: Processing batch 0
Average Precision= 0.4886, mean Time to accident= 4.3196
Recall@80%, Time to accident= 3.897
Client 4: Epoch 1 validation AP = 0.4886
Client 4: New best AP = 0.4886, saving checkpoint
Client 4: Starting epoch 2/7
Client 4: Processing batch 0
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 4: Processing batch 10
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 20
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 30
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 40
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 50
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 60
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 1: Processing batch 70
Client 4: Processing batch 70
Client 2: Processing batch 80
Client 3: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 80
Client 2: Processing batch 90
Client 3: Processing batch 90
Client 0: Processing batch 90
Client 1: Processing batch 90
Client 4: Processing batch 90
Client 2: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 100
Client 1: Processing batch 100
Client 4: Processing batch 100
Client 2: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 110
Client 1: Processing batch 110
Client 4: Processing batch 110
Client 2: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 120
Client 1: Processing batch 120
Client 4: Processing batch 120
Client 2: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 130
Client 2: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 140
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 4: Processing batch 150
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 160
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 170
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 180
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 190
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 4: Processing batch 200
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.6599, mean Time to accident= 4.0840
Recall@80%, Time to accident= 4.217
Client 2: Epoch 2 validation AP = 0.6599
Client 2: New best AP = 0.6599, saving checkpoint
Client 2: Starting epoch 3/7
Client 2: Processing batch 0
Average Precision= 0.6150, mean Time to accident= 4.2042
Recall@80%, Time to accident= 3.989
Client 0: Epoch 2 validation AP = 0.6150
Client 0: Starting epoch 3/7
Client 0: Processing batch 0
Average Precision= 0.4017, mean Time to accident= 3.8840
Recall@80%, Time to accident= 3.622
Client 3: Epoch 2 validation AP = 0.4017
Client 3: Starting epoch 3/7
Client 3: Processing batch 0
Average Precision= 0.5462, mean Time to accident= 4.3323
Recall@80%, Time to accident= 4.58
Client 1: Epoch 2 validation AP = 0.5462
Client 1: New best AP = 0.5462, saving checkpoint
Client 1: Starting epoch 3/7
Client 1: Processing batch 0
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Average Precision= 0.6017, mean Time to accident= 3.7901
Recall@80%, Time to accident= 4.115
Client 4: Epoch 2 validation AP = 0.6017
Client 4: New best AP = 0.6017, saving checkpoint
Client 4: Starting epoch 3/7
Client 1: Processing batch 10
Client 4: Processing batch 0
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 4: Processing batch 10
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 4: Processing batch 20
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 1: Processing batch 40
Client 4: Processing batch 30
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 40
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 4: Processing batch 50
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 4: Processing batch 60
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 70
Client 3: Processing batch 80
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 80
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 90
Client 1: Processing batch 100
Client 3: Processing batch 100
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 100
Client 1: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 110
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 4: Processing batch 120
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 130
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 140
Client 3: Processing batch 150
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 150
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 160
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 170
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 180
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 190
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 4: Processing batch 200
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.4816, mean Time to accident= 4.5074
Recall@80%, Time to accident= 4.97
Client 2: Epoch 3 validation AP = 0.4816
Client 2: Starting epoch 4/7
Client 2: Processing batch 0
Average Precision= 0.6702, mean Time to accident= 4.5746
Recall@80%, Time to accident= 4.528
Client 0: Epoch 3 validation AP = 0.6702
Client 0: New best AP = 0.6702, saving checkpoint
Client 0: Starting epoch 4/7
Client 0: Processing batch 0
Average Precision= 0.4959, mean Time to accident= 3.9813
Recall@80%, Time to accident= 4.549
Client 1: Epoch 3 validation AP = 0.4959
Client 1: Starting epoch 4/7
Average Precision= 0.4240, mean Time to accident= 3.4591
Recall@80%, Time to accident= 3.611
Client 3: Epoch 3 validation AP = 0.4240
Client 3: New best AP = 0.4240, saving checkpoint
Client 3: Starting epoch 4/7
Client 1: Processing batch 0
Client 3: Processing batch 0
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 20
Average Precision= 0.5461, mean Time to accident= 3.8678
Recall@80%, Time to accident= 3.816
Client 4: Epoch 3 validation AP = 0.5461
Client 4: Starting epoch 4/7
Client 4: Processing batch 0
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 30
Client 4: Processing batch 10
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 30
Client 2: Processing batch 40
Client 4: Processing batch 20
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 50
Client 4: Processing batch 30
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 2: Processing batch 60
Client 4: Processing batch 40
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 70
Client 4: Processing batch 50
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 60
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 70
Client 3: Processing batch 90
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 4: Processing batch 80
Client 3: Processing batch 100
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 4: Processing batch 90
Client 1: Processing batch 110
Client 3: Processing batch 110
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 4: Processing batch 100
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 130
Client 2: Processing batch 130
Client 4: Processing batch 110
Client 1: Processing batch 130
Client 3: Processing batch 130
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 4: Processing batch 120
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 4: Processing batch 130
Client 1: Processing batch 150
Client 3: Processing batch 150
Client 2: Processing batch 160
Client 4: Processing batch 140
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 4: Processing batch 150
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 4: Processing batch 160
Client 1: Processing batch 180
Client 3: Processing batch 180
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 4: Processing batch 170
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 4: Processing batch 180
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 4: Processing batch 190
Client 1: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 200
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.5830, mean Time to accident= 4.2606
Recall@80%, Time to accident= 4.788
Client 2: Epoch 4 validation AP = 0.5830
Client 2: Starting epoch 5/7
Client 2: Processing batch 0
Average Precision= 0.6660, mean Time to accident= 4.4194
Recall@80%, Time to accident= 4.606
Client 0: Epoch 4 validation AP = 0.6660
Client 0: Starting epoch 5/7
Client 0: Processing batch 0
Average Precision= 0.4935, mean Time to accident= 4.1801
Recall@80%, Time to accident= 3.951
Client 1: Epoch 4 validation AP = 0.4935
Client 1: Starting epoch 5/7
Average Precision= 0.4297, mean Time to accident= 3.8438
Recall@80%, Time to accident= 3.506
Client 3: Epoch 4 validation AP = 0.4297
Client 3: New best AP = 0.4297, saving checkpoint
Client 3: Starting epoch 5/7
Client 1: Processing batch 0
Client 3: Processing batch 0
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 1: Processing batch 10
Client 3: Processing batch 10
Client 2: Processing batch 20
Client 0: Processing batch 20
Average Precision= 0.5917, mean Time to accident= 3.8596
Recall@80%, Time to accident= 4.231
Client 4: Epoch 4 validation AP = 0.5917
Client 4: Starting epoch 5/7
Client 1: Processing batch 20
Client 3: Processing batch 20
Client 4: Processing batch 0
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 1: Processing batch 30
Client 3: Processing batch 30
Client 4: Processing batch 10
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 1: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 20
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 1: Processing batch 50
Client 4: Processing batch 30
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 1: Processing batch 60
Client 4: Processing batch 40
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 50
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 1: Processing batch 80
Client 4: Processing batch 60
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 70
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 80
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 1: Processing batch 110
Client 2: Processing batch 120
Client 4: Processing batch 90
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 1: Processing batch 120
Client 2: Processing batch 130
Client 4: Processing batch 100
Client 0: Processing batch 130
Client 3: Processing batch 130
Client 1: Processing batch 130
Client 4: Processing batch 110
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 140
Client 1: Processing batch 140
Client 4: Processing batch 120
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 130
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 1: Processing batch 160
Client 4: Processing batch 140
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 1: Processing batch 170
Client 4: Processing batch 150
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 1: Processing batch 180
Client 4: Processing batch 160
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 1: Processing batch 190
Client 4: Processing batch 170
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 4: Processing batch 180
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 1: Processing batch 210
Client 4: Processing batch 190
Client 4: Processing batch 200
Client 4: Processing batch 210
Client 4: Processing batch 220
Average Precision= 0.5796, mean Time to accident= 4.1722
Recall@80%, Time to accident= 4.662
Client 2: Epoch 5 validation AP = 0.5796
Client 2: Starting epoch 6/7
Client 2: Processing batch 0
Average Precision= 0.6545, mean Time to accident= 4.4633
Recall@80%, Time to accident= 4.367
Client 0: Epoch 5 validation AP = 0.6545
Client 0: Starting epoch 6/7
Client 0: Processing batch 0
Average Precision= 0.4097, mean Time to accident= 4.0748
Recall@80%, Time to accident= 4.022
Client 3: Epoch 5 validation AP = 0.4097
Client 3: Starting epoch 6/7
Client 3: Processing batch 0
Average Precision= 0.4390, mean Time to accident= 3.8483
Recall@80%, Time to accident= 3.704
Client 1: Epoch 5 validation AP = 0.4390
Client 1: Starting epoch 6/7
Client 1: Processing batch 0
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 3: Processing batch 20
Client 1: Processing batch 20
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Average Precision= 0.5620, mean Time to accident= 3.6899
Recall@80%, Time to accident= 3.611
Client 4: Epoch 5 validation AP = 0.5620
Client 4: Starting epoch 6/7
Client 4: Processing batch 0
Client 1: Processing batch 30
Client 2: Processing batch 40
Client 0: Processing batch 40
Client 3: Processing batch 40
Client 4: Processing batch 10
Client 1: Processing batch 40
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 3: Processing batch 50
Client 4: Processing batch 20
Client 1: Processing batch 50
Client 2: Processing batch 60
Client 0: Processing batch 60
Client 3: Processing batch 60
Client 4: Processing batch 30
Client 1: Processing batch 60
Client 2: Processing batch 70
Client 0: Processing batch 70
Client 3: Processing batch 70
Client 4: Processing batch 40
Client 1: Processing batch 70
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 3: Processing batch 80
Client 4: Processing batch 50
Client 1: Processing batch 80
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 60
Client 1: Processing batch 90
Client 2: Processing batch 100
Client 0: Processing batch 100
Client 3: Processing batch 100
Client 4: Processing batch 70
Client 1: Processing batch 100
Client 2: Processing batch 110
Client 0: Processing batch 110
Client 3: Processing batch 110
Client 4: Processing batch 80
Client 1: Processing batch 110
Client 2: Processing batch 120
Client 0: Processing batch 120
Client 3: Processing batch 120
Client 4: Processing batch 90
Client 1: Processing batch 120
Client 2: Processing batch 130
Client 0: Processing batch 130
Client 3: Processing batch 130
Client 4: Processing batch 100
Client 1: Processing batch 130
Client 2: Processing batch 140
Client 0: Processing batch 140
Client 3: Processing batch 140
Client 4: Processing batch 110
Client 1: Processing batch 140
Client 2: Processing batch 150
Client 0: Processing batch 150
Client 3: Processing batch 150
Client 4: Processing batch 120
Client 1: Processing batch 150
Client 2: Processing batch 160
Client 0: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 130
Client 1: Processing batch 160
Client 2: Processing batch 170
Client 0: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 140
Client 1: Processing batch 170
Client 2: Processing batch 180
Client 0: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 150
Client 1: Processing batch 180
Client 2: Processing batch 190
Client 0: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 160
Client 1: Processing batch 190
Client 2: Processing batch 200
Client 0: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 170
Client 1: Processing batch 200
Client 2: Processing batch 210
Client 0: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 180
Client 1: Processing batch 210
Client 4: Processing batch 190
Client 4: Processing batch 200
Client 4: Processing batch 210
Average Precision= 0.5620, mean Time to accident= 4.1690
Recall@80%, Time to accident= 4.687
Client 2: Epoch 6 validation AP = 0.5620
Client 2: Starting epoch 7/7
Client 2: Processing batch 0
Average Precision= 0.6856, mean Time to accident= 4.4865
Recall@80%, Time to accident= 4.206
Client 0: Epoch 6 validation AP = 0.6856
Client 0: New best AP = 0.6856, saving checkpoint
Client 0: Starting epoch 7/7
Client 4: Processing batch 220
Client 0: Processing batch 0
Average Precision= 0.4078, mean Time to accident= 4.0068
Recall@80%, Time to accident= 3.956
Client 3: Epoch 6 validation AP = 0.4078
Client 3: Starting epoch 7/7
Average Precision= 0.4680, mean Time to accident= 3.8885
Recall@80%, Time to accident= 4.068
Client 1: Epoch 6 validation AP = 0.4680
Client 1: Starting epoch 7/7
Client 3: Processing batch 0
Client 1: Processing batch 0
Client 2: Processing batch 10
Client 0: Processing batch 10
Client 3: Processing batch 10
Client 1: Processing batch 10
Client 2: Processing batch 20
Client 0: Processing batch 20
Client 1: Processing batch 20
Client 3: Processing batch 20
Client 2: Processing batch 30
Client 0: Processing batch 30
Client 3: Processing batch 30
Client 1: Processing batch 30
Client 2: Processing batch 40
Average Precision= 0.5455, mean Time to accident= 3.8239
Recall@80%, Time to accident= 3.936
Client 4: Epoch 6 validation AP = 0.5455
Client 4: Starting epoch 7/7
Client 0: Processing batch 40
Client 4: Processing batch 0
Client 1: Processing batch 40
Client 3: Processing batch 40
Client 2: Processing batch 50
Client 0: Processing batch 50
Client 4: Processing batch 10
Client 1: Processing batch 50
Client 3: Processing batch 50
Client 2: Processing batch 60
Client 4: Processing batch 20
Client 0: Processing batch 60
Client 1: Processing batch 60
Client 3: Processing batch 60
Client 2: Processing batch 70
Client 4: Processing batch 30
Client 0: Processing batch 70
Client 1: Processing batch 70
Client 3: Processing batch 70
Client 2: Processing batch 80
Client 0: Processing batch 80
Client 4: Processing batch 40
Client 1: Processing batch 80
Client 3: Processing batch 80
Client 2: Processing batch 90
Client 0: Processing batch 90
Client 4: Processing batch 50
Client 1: Processing batch 90
Client 3: Processing batch 90
Client 4: Processing batch 60
Client 0: Processing batch 100
Client 2: Processing batch 100
Client 1: Processing batch 100
Client 3: Processing batch 100
Client 0: Processing batch 110
Client 4: Processing batch 70
Client 2: Processing batch 110
Client 1: Processing batch 110
Client 3: Processing batch 110
Client 0: Processing batch 120
Client 4: Processing batch 80
Client 2: Processing batch 120
Client 1: Processing batch 120
Client 3: Processing batch 120
Client 0: Processing batch 130
Client 4: Processing batch 90
Client 2: Processing batch 130
Client 1: Processing batch 130
Client 3: Processing batch 130
Client 0: Processing batch 140
Client 4: Processing batch 100
Client 2: Processing batch 140
Client 1: Processing batch 140
Client 3: Processing batch 140
Client 0: Processing batch 150
Client 4: Processing batch 110
Client 2: Processing batch 150
Client 1: Processing batch 150
Client 3: Processing batch 150
Client 0: Processing batch 160
Client 4: Processing batch 120
Client 2: Processing batch 160
Client 1: Processing batch 160
Client 3: Processing batch 160
Client 4: Processing batch 130
Client 0: Processing batch 170
Client 2: Processing batch 170
Client 1: Processing batch 170
Client 3: Processing batch 170
Client 4: Processing batch 140
Client 0: Processing batch 180
Client 2: Processing batch 180
Client 1: Processing batch 180
Client 3: Processing batch 180
Client 4: Processing batch 150
Client 0: Processing batch 190
Client 2: Processing batch 190
Client 1: Processing batch 190
Client 3: Processing batch 190
Client 4: Processing batch 160
Client 0: Processing batch 200
Client 2: Processing batch 200
Client 1: Processing batch 200
Client 3: Processing batch 200
Client 4: Processing batch 170
Client 0: Processing batch 210
Client 2: Processing batch 210
Client 1: Processing batch 210
Client 3: Processing batch 210
Client 4: Processing batch 180
Client 4: Processing batch 190
Client 4: Processing batch 200
Client 4: Processing batch 210
Average Precision= 0.5618, mean Time to accident= 4.2027
Recall@80%, Time to accident= 4.677
Client 2: Epoch 7 validation AP = 0.5618
Client 2: Loaded best model checkpoint with AP = 0.6599
[92mINFO [0m:      Sent reply
Average Precision= 0.6793, mean Time to accident= 4.5342
Recall@80%, Time to accident= 4.211
Client 0: Epoch 7 validation AP = 0.6793
Client 0: Loaded best model checkpoint with AP = 0.6856
[92mINFO [0m:      Sent reply
Average Precision= 0.4453, mean Time to accident= 3.6908
Recall@80%, Time to accident= 4.062
Client 1: Epoch 7 validation AP = 0.4453
Client 1: Loaded best model checkpoint with AP = 0.5462
[92mINFO [0m:      Sent reply
Client 4: Processing batch 220
Average Precision= 0.4137, mean Time to accident= 3.8378
Recall@80%, Time to accident= 3.911
Client 3: Epoch 7 validation AP = 0.4137
Client 3: Loaded best model checkpoint with AP = 0.4297
[92mINFO [0m:      Sent reply
Average Precision= 0.5486, mean Time to accident= 3.8108
Recall@80%, Time to accident= 3.927
Client 4: Epoch 7 validation AP = 0.5486
Client 4: Loaded best model checkpoint with AP = 0.6017
[92mINFO [0m:      Sent reply
[92mINFO [0m:      aggregate_fit: received 5 results and 0 failures
Saved PR curve: results/federated/pr_curve_round_5.png
Batch 0: probs shape=torch.Size([100, 2]), pos_prob range=[0.0034, 0.9979]
Batch 0: pred_labels unique=[0 1], y unique=[0]
Batch 1: probs shape=torch.Size([100, 2]), pos_prob range=[0.0266, 0.9970]
Batch 1: pred_labels unique=[0 1], y unique=[1]
Batch 2: probs shape=torch.Size([100, 2]), pos_prob range=[0.4033, 0.9985]
Batch 2: pred_labels unique=[0 1], y unique=[1]
Average Precision= 0.5463, mean Time to accident= 4.0828
Recall@80%, Time to accident= 4.135

=== SERVER EVALUATION ROUND 6 ===
Confusion Matrix:
[[25349  4751]
 [ 9626  6274]]
Class-wise recall: [0.842 0.395]
==================================================
[92mINFO [0m:      fit progress: (6, 0.0, {'ap': 0.5462767458306378, 'mtta': 4.082828751663318, 'tta_r80': 4.13517060367454, 'recall_neg': 0.8421594684385382, 'recall_pos': 0.39459119496855344, 'pr_auc_frame': 0.5287363577676034}, 136684.40286210785)
[92mINFO [0m:      configure_evaluate: strategy sampled 5 clients (out of 5)
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message d2343922-48ef-4308-b00c-e60bb18b61e2
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 98ea7d2b-fd8a-4e15-9dab-5cb8cc022406
Client 2: Reset optimizer and scheduler state after loading server parameters
Client 4: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message 72fe6141-b82c-41fe-8b2a-5a384f398af2
Client 0: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message d27b8fde-3e3d-463d-afff-a2f8ae03316d
Client 3: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      
[92mINFO [0m:      Received: evaluate message a24b9490-ac04-4459-861e-f2dd6e2f3d79
Client 1: Reset optimizer and scheduler state after loading server parameters
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      Sent reply
[92mINFO [0m:      aggregate_evaluate: received 5 results and 0 failures
[92mINFO [0m:      
[92mINFO [0m:      [SUMMARY]
[92mINFO [0m:      Run finished 6 round(s) in 137169.22s
[92mINFO [0m:      	History (loss, distributed):
[92mINFO [0m:      		round 1: 0.699999988079071
[92mINFO [0m:      		round 2: 0.699999988079071
[92mINFO [0m:      		round 3: 0.699999988079071
[92mINFO [0m:      		round 4: 0.699999988079071
[92mINFO [0m:      		round 5: 0.699999988079071
[92mINFO [0m:      		round 6: 0.699999988079071
[92mINFO [0m:      	History (loss, centralized):
[92mINFO [0m:      		round 0: 0.0
[92mINFO [0m:      		round 1: 0.0
[92mINFO [0m:      		round 2: 0.0
[92mINFO [0m:      		round 3: 0.0
[92mINFO [0m:      		round 4: 0.0
[92mINFO [0m:      		round 5: 0.0
[92mINFO [0m:      		round 6: 0.0
[92mINFO [0m:      	History (metrics, centralized):
[92mINFO [0m:      	{'ap': [(0, 0.36197640827092026),
[92mINFO [0m:      	        (1, 0.4986479258169009),
[92mINFO [0m:      	        (2, 0.5160025402858185),
[92mINFO [0m:      	        (3, 0.5359883341373026),
[92mINFO [0m:      	        (4, 0.5219384656041219),
[92mINFO [0m:      	        (5, 0.5418047080449524),
[92mINFO [0m:      	        (6, 0.5462767458306378)],
[92mINFO [0m:      	 'mtta': [(0, 3.75990880936758),
[92mINFO [0m:      	          (1, 4.754242787396188),
[92mINFO [0m:      	          (2, 4.377877130856022),
[92mINFO [0m:      	          (3, 4.306993939372987),
[92mINFO [0m:      	          (4, 4.109657994122559),
[92mINFO [0m:      	          (5, 3.981771486394006),
[92mINFO [0m:      	          (6, 4.082828751663318)],
[92mINFO [0m:      	 'pr_auc_frame': [(0, 0.3513502704394707),
[92mINFO [0m:      	                  (1, 0.4312651460932098),
[92mINFO [0m:      	                  (2, 0.47427369856203416),
[92mINFO [0m:      	                  (3, 0.5018370172208271),
[92mINFO [0m:      	                  (4, 0.5083063750055745),
[92mINFO [0m:      	                  (5, 0.5211904240709979),
[92mINFO [0m:      	                  (6, 0.5287363577676034)],
[92mINFO [0m:      	 'recall_neg': [(0, 0.930531561461794),
[92mINFO [0m:      	                (1, 0.9438538205980066),
[92mINFO [0m:      	                (2, 0.8742857142857143),
[92mINFO [0m:      	                (3, 0.8435548172757475),
[92mINFO [0m:      	                (4, 0.8187707641196014),
[92mINFO [0m:      	                (5, 0.8298671096345515),
[92mINFO [0m:      	                (6, 0.8421594684385382)],
[92mINFO [0m:      	 'recall_pos': [(0, 0.07974842767295598),
[92mINFO [0m:      	                (1, 0.12823899371069183),
[92mINFO [0m:      	                (2, 0.2732075471698113),
[92mINFO [0m:      	                (3, 0.3474842767295597),
[92mINFO [0m:      	                (4, 0.3881132075471698),
[92mINFO [0m:      	                (5, 0.39553459119496853),
[92mINFO [0m:      	                (6, 0.39459119496855344)],
[92mINFO [0m:      	 'tta_r80': [(0, 3.46657986111111),
[92mINFO [0m:      	             (1, 4.52668416447944),
[92mINFO [0m:      	             (2, 4.228346456692913),
[92mINFO [0m:      	             (3, 4.357392825896763),
[92mINFO [0m:      	             (4, 4.269028871391076),
[92mINFO [0m:      	             (5, 4.1605424321959745),
[92mINFO [0m:      	             (6, 4.13517060367454)]}
[92mINFO [0m:      
[92mINFO [0m:      
[92mINFO [0m:      Received: reconnect message ae3b0d6a-90f6-43a5-bf01-dac907acee59
[92mINFO [0m:      
[92mINFO [0m:      Received: reconnect message 9582bd10-1566-442a-b8db-f1a4baaf7e4e
[92mINFO [0m:      
[92mINFO [0m:      Received: reconnect message d4fcf724-58e0-4ef7-92dc-3288306b8d61
[92mINFO [0m:      
[92mINFO [0m:      Received: reconnect message 2c4c7447-3a26-4baa-9d3e-d5f259fdc206
[92mINFO [0m:      
[92mINFO [0m:      Received: reconnect message 4b68d81e-c14a-4d36-8920-f877f96c66a9
[92mINFO [0m:      Disconnect and shut down
[92mINFO [0m:      Disconnect and shut down
[92mINFO [0m:      Disconnect and shut down
[92mINFO [0m:      Disconnect and shut down
[92mINFO [0m:      Disconnect and shut down
Average Precision= 0.7954, mean Time to accident= 4.1985
Recall@80%, Time to accident= 4.03
Average Precision= 0.6555, mean Time to accident= 4.1160
Recall@80%, Time to accident= 4.438
Average Precision= 0.4556, mean Time to accident= 4.5138
Recall@80%, Time to accident= 4.197
Average Precision= 0.4150, mean Time to accident= 4.2069
Recall@80%, Time to accident= 4.428
Average Precision= 0.6172, mean Time to accident= 4.5549
Recall@80%, Time to accident= 4.311
Saved PR curve: results/federated/pr_curve_round_6.png
Starting federated DAD training: 5 clients, 6 rounds
Starting server: python federated/server.py --rounds 6 --min-fit-clients 5 --min-available-clients 5 --server-address 127.0.0.1:8080 --local-epochs 7 --input-dim 4096 --embedding-dim 256 --img-feat-dim 2048 --num-classes 2
Starting client 0: python federated/client.py --cid 0 --num-clients 5 --server 127.0.0.1:8080
Starting client 1: python federated/client.py --cid 1 --num-clients 5 --server 127.0.0.1:8080
Starting client 2: python federated/client.py --cid 2 --num-clients 5 --server 127.0.0.1:8080
Starting client 3: python federated/client.py --cid 3 --num-clients 5 --server 127.0.0.1:8080
Starting client 4: python federated/client.py --cid 4 --num-clients 5 --server 127.0.0.1:8080
Federated training completed!
